"use strict";var t,e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0
THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.
See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */!function(t){!function(){var i="object"==typeof globalThis?globalThis:"object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:function(){try{return Function("return this;")()}catch(t){}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch(t){}}(),r=n(t);function n(t,e){return function(i,r){Object.defineProperty(t,i,{configurable:!0,writable:!0,value:r}),e&&e(i,r)}}void 0!==i.Reflect&&(r=n(i.Reflect,r)),function(t,e){var i=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,u=!s&&!a,c={create:s?function(){return lt(Object.create(null))}:a?function(){return lt({__proto__:null})}:function(){return lt({})},has:u?function(t,e){return i.call(t,e)}:function(t,e){return e in t},get:u?function(t,e){return i.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},h=Object.getPrototypeOf(Function),l="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:ut(),d="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:ct(),f="function"==typeof WeakMap?WeakMap:ht(),p=r?Symbol.for("@reflect-metadata:registry"):void 0,g=nt(),v=ot(g);function m(t,e,i,r){if(k(i)){if(!K(t))throw new TypeError;if(!z(e))throw new TypeError;return C(t,e)}if(!K(t))throw new TypeError;if(!W(e))throw new TypeError;if(!W(r)&&!k(r)&&!L(r))throw new TypeError;return L(r)&&(r=void 0),I(t,e,i=H(i),r)}function y(t,e){function i(i,r){if(!W(i))throw new TypeError;if(!k(r)&&!X(r))throw new TypeError;O(t,e,i,r)}return i}function E(t,e,i,r){if(!W(i))throw new TypeError;return k(r)||(r=H(r)),O(t,e,i,r)}function _(t,e,i){if(!W(e))throw new TypeError;return k(i)||(i=H(i)),M(t,e,i)}function b(t,e,i){if(!W(e))throw new TypeError;return k(i)||(i=H(i)),P(t,e,i)}function A(t,e,i){if(!W(e))throw new TypeError;return k(i)||(i=H(i)),N(t,e,i)}function S(t,e,i){if(!W(e))throw new TypeError;return k(i)||(i=H(i)),B(t,e,i)}function w(t,e){if(!W(t))throw new TypeError;return k(e)||(e=H(e)),D(t,e)}function R(t,e){if(!W(t))throw new TypeError;return k(e)||(e=H(e)),x(t,e)}function T(t,e,i){if(!W(e))throw new TypeError;if(k(i)||(i=H(i)),!W(e))throw new TypeError;k(i)||(i=H(i));var r=at(e,i,!1);return!k(r)&&r.OrdinaryDeleteMetadata(t,e,i)}function C(t,e){for(var i=t.length-1;i>=0;--i){var r=(0,t[i])(e);if(!k(r)&&!L(r)){if(!z(r))throw new TypeError;e=r}}return e}function I(t,e,i,r){for(var n=t.length-1;n>=0;--n){var o=(0,t[n])(e,i,r);if(!k(o)&&!L(o)){if(!W(o))throw new TypeError;r=o}}return r}function M(t,e,i){if(P(t,e,i))return!0;var r=it(e);return!L(r)&&M(t,r,i)}function P(t,e,i){var r=at(e,i,!1);return!k(r)&&j(r.OrdinaryHasOwnMetadata(t,e,i))}function N(t,e,i){if(P(t,e,i))return B(t,e,i);var r=it(e);return L(r)?void 0:N(t,r,i)}function B(t,e,i){var r=at(e,i,!1);if(!k(r))return r.OrdinaryGetOwnMetadata(t,e,i)}function O(t,e,i,r){at(i,r,!0).OrdinaryDefineOwnMetadata(t,e,i,r)}function D(t,e){var i=x(t,e),r=it(t);if(null===r)return i;var n=D(r,e);if(n.length<=0)return i;if(i.length<=0)return n;for(var o=new d,s=[],a=0,u=i;a<u.length;a++){var c=u[a];o.has(c)||(o.add(c),s.push(c))}for(var h=0,l=n;h<l.length;h++){c=l[h];o.has(c)||(o.add(c),s.push(c))}return s}function x(t,e){var i=at(t,e,!1);return i?i.OrdinaryOwnMetadataKeys(t,e):[]}function F(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function k(t){return void 0===t}function L(t){return null===t}function G(t){return"symbol"==typeof t}function W(t){return"object"==typeof t?null!==t:"function"==typeof t}function V(t,e){switch(F(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var i="string",r=Z(t,n);if(void 0!==r){var o=r.call(t,i);if(W(o))throw new TypeError;return o}return U(t)}function U(t,e){var i,r,n=t.toString;if(Y(n)&&!W(r=n.call(t)))return r;if(Y(i=t.valueOf)&&!W(r=i.call(t)))return r;throw new TypeError}function j(t){return!!t}function q(t){return""+t}function H(t){var e=V(t);return G(e)?e:q(e)}function K(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function Y(t){return"function"==typeof t}function z(t){return"function"==typeof t}function X(t){switch(F(t)){case 3:case 4:return!0;default:return!1}}function Q(t,e){return t===e||t!=t&&e!=e}function Z(t,e){var i=t[e];if(null!=i){if(!Y(i))throw new TypeError;return i}}function $(t){var e=Z(t,o);if(!Y(e))throw new TypeError;var i=e.call(t);if(!W(i))throw new TypeError;return i}function J(t){return t.value}function tt(t){var e=t.next();return!e.done&&e}function et(t){var e=t.return;e&&e.call(t)}function it(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===h)return e;if(e!==h)return e;var i=t.prototype,r=i&&Object.getPrototypeOf(i);if(null==r||r===Object.prototype)return e;var n=r.constructor;return"function"!=typeof n||n===t?e:n}function rt(){var t,i,r,n;k(p)||void 0===e.Reflect||p in e.Reflect||"function"!=typeof e.Reflect.defineMetadata||(t=st(e.Reflect));var o=new f,s={registerProvider:a,getProvider:c,setProvider:g};return s;function a(e){if(!Object.isExtensible(s))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===e:break;case k(i):i=e;break;case i===e:break;case k(r):r=e;break;case r===e:break;default:void 0===n&&(n=new d),n.add(e)}}function u(e,o){if(!k(i)){if(i.isProviderFor(e,o))return i;if(!k(r)){if(r.isProviderFor(e,o))return i;if(!k(n))for(var s=$(n);;){var a=tt(s);if(!a)return;var u=J(a);if(u.isProviderFor(e,o))return et(s),u}}}if(!k(t)&&t.isProviderFor(e,o))return t}function c(t,e){var i,r=o.get(t);return k(r)||(i=r.get(e)),k(i)?(k(i=u(t,e))||(k(r)&&(r=new l,o.set(t,r)),r.set(e,i)),i):i}function h(t){if(k(t))throw new TypeError;return i===t||r===t||!k(n)&&n.has(t)}function g(t,e,i){if(!h(i))throw new Error("Metadata provider not registered.");var r=c(t,e);if(r!==i){if(!k(r))return!1;var n=o.get(t);k(n)&&(n=new l,o.set(t,n)),n.set(e,i)}return!0}}function nt(){var t;return!k(p)&&W(e.Reflect)&&Object.isExtensible(e.Reflect)&&(t=e.Reflect[p]),k(t)&&(t=rt()),!k(p)&&W(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,p,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}function ot(t){var e=new f,i={isProviderFor:function(t,i){var r=e.get(t);return!k(r)&&r.has(i)},OrdinaryDefineOwnMetadata:s,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:o,OrdinaryOwnMetadataKeys:a,OrdinaryDeleteMetadata:u};return g.registerProvider(i),i;function r(r,n,o){var s=e.get(r),a=!1;if(k(s)){if(!o)return;s=new l,e.set(r,s),a=!0}var u=s.get(n);if(k(u)){if(!o)return;if(u=new l,s.set(n,u),!t.setProvider(r,n,i))throw s.delete(n),a&&e.delete(r),new Error("Wrong provider for target.")}return u}function n(t,e,i){var n=r(e,i,!1);return!k(n)&&j(n.has(t))}function o(t,e,i){var n=r(e,i,!1);if(!k(n))return n.get(t)}function s(t,e,i,n){r(i,n,!0).set(t,e)}function a(t,e){var i=[],n=r(t,e,!1);if(k(n))return i;for(var o=$(n.keys()),s=0;;){var a=tt(o);if(!a)return i.length=s,i;var u=J(a);try{i[s]=u}catch(t){try{et(o)}finally{throw t}}s++}}function u(t,i,n){var o=r(i,n,!1);if(k(o))return!1;if(!o.delete(t))return!1;if(0===o.size){var s=e.get(i);k(s)||(s.delete(n),0===s.size&&e.delete(s))}return!0}}function st(t){var e=t.defineMetadata,i=t.hasOwnMetadata,r=t.getOwnMetadata,n=t.getOwnMetadataKeys,o=t.deleteMetadata,s=new f;return{isProviderFor:function(t,e){var i=s.get(t);return!(k(i)||!i.has(e))||!!n(t,e).length&&(k(i)&&(i=new d,s.set(t,i)),i.add(e),!0)},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:r,OrdinaryOwnMetadataKeys:n,OrdinaryDeleteMetadata:o}}function at(t,e,i){var r=g.getProvider(t,e);if(!k(r))return r;if(i){if(g.setProvider(t,e,v))return v;throw new Error("Illegal state.")}}function ut(){var t={},e=[],i=function(){function t(t,e,i){this._index=0,this._keys=t,this._values=e,this._selector=i}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var i=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var i=this._find(t,!0);return this._values[i]=e,this},e.prototype.delete=function(e){var i=this._find(e,!1);if(i>=0){for(var r=this._keys.length,n=i+1;n<r;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,Q(e,this._cacheKey)&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new i(this._keys,this._values,r)},e.prototype.values=function(){return new i(this._keys,this._values,n)},e.prototype.entries=function(){return new i(this._keys,this._values,s)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){if(!Q(this._cacheKey,t)){this._cacheIndex=-1;for(var i=0;i<this._keys.length;i++)if(Q(this._keys[i],t)){this._cacheIndex=i;break}}return this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function n(t,e){return e}function s(t,e){return[t,e]}}function ct(){return function(){function t(){this._map=new l}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}()}function ht(){var t=16,e=c.create(),r=n();return function(){function t(){this._key=n()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=n()},t}();function n(){var t;do{t="@@WeakMap@@"+u()}while(c.has(e,t));return e[t]=!0,t}function o(t,e){if(!i.call(t,r)){if(!e)return;Object.defineProperty(t,r,{value:c.create()})}return t[r]}function s(t,e){for(var i=0;i<e;++i)t[i]=255*Math.random()|0;return t}function a(t){if("function"==typeof Uint8Array){var e=new Uint8Array(t);return"undefined"!=typeof crypto?crypto.getRandomValues(e):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(e):s(e,t),e}return s(new Array(t),t)}function u(){var e=a(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var i="",r=0;r<t;++r){var n=e[r];4!==r&&6!==r&&8!==r||(i+="-"),n<16&&(i+="0"),i+=n.toString(16).toLowerCase()}return i}}function lt(t){return t.__=void 0,delete t.__,t}t("decorate",m),t("metadata",y),t("defineMetadata",E),t("hasMetadata",_),t("hasOwnMetadata",b),t("getMetadata",A),t("getOwnMetadata",S),t("getMetadataKeys",w),t("getOwnMetadataKeys",R),t("deleteMetadata",T)}(r,i),void 0===i.Reflect&&(i.Reflect=t)}()}(t||(t={}));var i="named",r="name",n="unmanaged",o="optional",s="inject",a="multi_inject",u="inversify:tagged",c="inversify:tagged_props",h="inversify:paramtypes",l="post_construct",d="pre_destroy";var f=[s,a,r,n,i,o],p={Request:"Request",Singleton:"Singleton",Transient:"Transient"},g={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},v={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},m=0;function y(){return m++}var E=function(){function t(t,e){this.id=y(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=g.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===p.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},t}(),_="Metadata key was used more than once in a parameter:",b="NULL argument",A="Key Not Found",S="Ambiguous match found for serviceIdentifier:",w="No matching bindings found for serviceIdentifier:",R="Missing required @injectable annotation in:",T="Missing required @inject or @multiInject annotation in:",C="Circular dependency found:",I="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",M=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},P=function(t,e){return"@postConstruct error in class "+t+": "+e},N=function(t,e){return"@preDestroy error in class "+t+": "+e},B=function(t,e){return"onDeactivation() error in class "+t+": "+e},O="Maximum call stack size exceeded",D=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(h,t),userGeneratedMetadata:Reflect.getMetadata(u,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(c,t)||[]},t}(),x={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function F(t){return t instanceof RangeError||t.message===O}function k(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function L(t,e,i){var r="",n=i(t,e);return 0!==n.length&&(r="\nRegistered bindings:",n.forEach((function(t){var e="Object";null!==t.implementationType&&(e=V(t.implementationType)),r=r+"\n "+e,t.constraint.metaData&&(r=r+" - "+t.constraint.metaData)}))),r}function G(t,e){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===e||G(t.parentRequest,e))}function W(t){t.childRequests.forEach((function(t){if(G(t,t.serviceIdentifier)){var e=function(t){var e=function t(e,i){void 0===i&&(i=[]);var r=k(e.serviceIdentifier);return i.push(r),null!==e.parentRequest?t(e.parentRequest,i):i}(t);return e.reverse().join(" --\x3e ")}(t);throw new Error(C+" "+e)}W(t)}))}function V(t){if(t.name)return t.name;var e=t.toString(),i=e.match(/^function\s*([^\s(]+)/);return i?i[1]:"Anonymous function: "+e}var U=function(){function t(t){this.id=y(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}(),j=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===i?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},t}(),q=function(t,e){this.parentContext=t,this.rootRequest=e},H=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}(),K=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e,i=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},i)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}(),Y=function(){function t(t,e,r,n){this.id=y(),this.type=t,this.serviceIdentifier=r;var o="symbol"==typeof e?e.toString().slice(7,-1):e;this.name=new K(o||""),this.identifier=e,this.metadata=new Array;var s=null;"string"==typeof n?s=new j(i,n):n instanceof j&&(s=n),null!==s&&this.metadata.push(s)}return t.prototype.hasTag=function(t){for(var e=0,i=this.metadata;e<i.length;e++){if(i[e].key===t)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(a)},t.prototype.matchesArray=function(t){return this.matchesTag(a)(t)},t.prototype.isNamed=function(){return this.hasTag(i)},t.prototype.isTagged=function(){return this.metadata.some((function(t){return f.every((function(e){return t.key!==e}))}))},t.prototype.isOptional=function(){return this.matchesTag(o)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(t){return t.key===i}))[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(t){return f.every((function(e){return t.key!==e}))})):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(i)(t)},t.prototype.matchesTag=function(t){var e=this;return function(i){for(var r=0,n=e.metadata;r<n.length;r++){var o=n[r];if(o.key===t&&o.value===i)return!0}return!1}},t}(),z=function(t,e,i){if(i||2===arguments.length)for(var r,n=0,o=e.length;n<o;n++)!r&&n in e||(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};function X(t,e,i,r){var n=t.getConstructorMetadata(i),o=n.compilerGeneratedMetadata;if(void 0===o)throw new Error(R+" "+e+".");var s=n.userGeneratedMetadata,a=Object.keys(s),u=0===i.length&&a.length>0,c=a.length>i.length,h=function(t,e,i,r,n){for(var o=[],s=0;s<n;s++){var a=Q(s,t,e,i,r);null!==a&&o.push(a)}return o}(r,e,o,s,u||c?a.length:i.length),l=$(t,i,e);return z(z([],h,!0),l,!0)}function Q(t,e,i,r,n){var o=n[t.toString()]||[],s=tt(o),a=!0!==s.unmanaged,u=r[t],c=s.inject||s.multiInject;if((u=c||u)instanceof H&&(u=u.unwrap()),a){if(!e&&(u===Object||u===Function||void 0===u))throw new Error(T+" argument "+t+" in class "+i+".");var h=new Y(v.ConstructorArgument,s.targetName,u);return h.metadata=o,h}return null}function Z(t,e,i,r){var n=t||e;if(void 0===n){var o=R+" for property "+String(i)+" in class "+r+".";throw new Error(o)}return n}function $(t,e,i){for(var r=t.getPropertiesMetadata(e),n=[],o=Object.getOwnPropertySymbols(r),s=0,a=Object.keys(r).concat(o);s<a.length;s++){var u=a[s],c=r[u],h=tt(c),l=h.targetName||u,d=Z(h.inject,h.multiInject,u,i),f=new Y(v.ClassProperty,l,d);f.metadata=c,n.push(f)}var p=Object.getPrototypeOf(e.prototype).constructor;if(p!==Object){var g=$(t,p,i);n=z(z([],n,!0),g,!0)}return n}function J(t,e){var i=Object.getPrototypeOf(e.prototype).constructor;if(i!==Object){var r=X(t,V(i),i,!0),o=r.map((function(t){return t.metadata.filter((function(t){return t.key===n}))})),s=[].concat.apply([],o).length,a=r.length-s;return a>0?a:J(t,i)}return 0}function tt(t){var e={};return t.forEach((function(t){e[t.key.toString()]=t.value})),{inject:e[s],multiInject:e[a],targetName:e[r],unmanaged:e[n]}}var et=function(){function t(t,e,i,r,n){this.id=y(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=i,this.target=n,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===i?new Map:null}return t.prototype.addChildRequest=function(e,i,r){var n=new t(e,this.parentContext,this,i,r);return this.childRequests.push(n),n},t}();function it(t){return t._bindingDictionary}function rt(t,e,i,r,n){var o=ot(i.container,n.serviceIdentifier),s=[];return o.length===x.NoBindingsAvailable&&i.container.options.autoBindInjectable&&"function"==typeof n.serviceIdentifier&&t.getConstructorMetadata(n.serviceIdentifier).compilerGeneratedMetadata&&(i.container.bind(n.serviceIdentifier).toSelf(),o=ot(i.container,n.serviceIdentifier)),s=e?o:o.filter((function(t){var e=new et(t.serviceIdentifier,i,r,t,n);return t.constraint(e)})),function(t,e,i,r){switch(e.length){case x.NoBindingsAvailable:if(i.isOptional())return e;var n=k(t),o=w;throw o+=function(t,e){if(e.isTagged()||e.isNamed()){var i="",r=e.getNamedTag(),n=e.getCustomTags();return null!==r&&(i+=r.toString()+"\n"),null!==n&&n.forEach((function(t){i+=t.toString()+"\n"}))," "+t+"\n "+t+" - "+i}return" "+t}(n,i),o+=L(r,n,ot),new Error(o);case x.OnlyOneBindingAvailable:return e;case x.MultipleBindingsAvailable:default:if(i.isArray())return e;n=k(t),o=S+" "+n;throw o+=L(r,n,ot),new Error(o)}}(n.serviceIdentifier,s,n,i.container),s}function nt(t,e,i,r,n,o){var s,a;if(null===n){s=rt(t,e,r,null,o),a=new et(i,r,null,s,o);var u=new q(r,a);r.addPlan(u)}else s=rt(t,e,r,n,o),a=n.addChildRequest(o.serviceIdentifier,s,o);s.forEach((function(e){var i=null;if(o.isArray())i=a.addChildRequest(e.serviceIdentifier,e,o);else{if(e.cache)return;i=a}if(e.type===g.Instance&&null!==e.implementationType){var n=function(t,e){return X(t,V(e),e,!1)}(t,e.implementationType);if(!r.container.options.skipBaseClassChecks){var s=J(t,e.implementationType);if(n.length<s){var u=M(V(e.implementationType));throw new Error(u)}}n.forEach((function(e){nt(t,!1,e.serviceIdentifier,r,i,e)}))}}))}function ot(t,e){var i=[],r=it(t);return r.hasKey(e)?i=r.get(e):null!==t.parent&&(i=ot(t.parent,e)),i}function st(t,e,i,r,n,o,u,c){void 0===c&&(c=!1);var h=new U(e),l=function(t,e,i,r,n,o){var u=new j(t?a:s,i),c=new Y(e,r,i,u);if(void 0!==n){var h=new j(n,o);c.metadata.push(h)}return c}(i,r,n,"",o,u);try{return nt(t,c,n,h,null,l),h}catch(t){throw F(t)&&W(h.plan.rootRequest),t}}function at(t){return("object"==typeof t&&null!==t||"function"==typeof t)&&"function"==typeof t.then}function ut(t){return!!at(t)||Array.isArray(t)&&t.some(at)}var ct,ht=function(t,e,i,r){return new(i||(i=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},lt=function(t,e){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},dt=function(t,e,i){t.has(e.id)||t.set(e.id,i)},ft=function(t,e){t.cache=e,t.activated=!0,at(e)&&pt(t,e)},pt=function(t,e){return ht(void 0,void 0,void 0,(function(){var i,r;return lt(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e];case 1:return i=n.sent(),t.cache=i,[3,3];case 2:throw r=n.sent(),t.cache=null,t.activated=!1,r;case 3:return[2]}}))}))};!function(t){t.DynamicValue="toDynamicValue",t.Factory="toFactory",t.Provider="toProvider"}(ct||(ct={}));var gt=function(){return gt=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},gt.apply(this,arguments)},vt=function(t,e,i,r){return new(i||(i=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},mt=function(t,e){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},yt=function(t,e,i){if(i||2===arguments.length)for(var r,n=0,o=e.length;n<o;n++)!r&&n in e||(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};function Et(t,e,i){var r;if(e.length>0){var n=function(t,e){return t.reduce((function(t,i){var r=e(i);return i.target.type===v.ConstructorArgument?t.constructorInjections.push(r):(t.propertyRequests.push(i),t.propertyInjections.push(r)),t.isAsync||(t.isAsync=ut(r)),t}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(e,i),o=gt(gt({},n),{constr:t});r=n.isAsync?function(t){return vt(this,void 0,void 0,(function(){var e,i;return mt(this,(function(r){switch(r.label){case 0:return[4,bt(t.constructorInjections)];case 1:return e=r.sent(),[4,bt(t.propertyInjections)];case 2:return i=r.sent(),[2,_t(gt(gt({},t),{constructorInjections:e,propertyInjections:i}))]}}))}))}(o):_t(o)}else r=new t;return r}function _t(t){var e,i=new((e=t.constr).bind.apply(e,yt([void 0],t.constructorInjections,!1)));return t.propertyRequests.forEach((function(e,r){var n=e.target.identifier,o=t.propertyInjections[r];e.target.isOptional()&&void 0===o||(i[n]=o)})),i}function bt(t){return vt(this,void 0,void 0,(function(){var e,i,r,n;return mt(this,(function(o){for(e=[],i=0,r=t;i<r.length;i++)n=r[i],Array.isArray(n)?e.push(Promise.all(n)):e.push(n);return[2,Promise.all(e)]}))}))}function At(t,e){var i=function(t,e){var i,r;if(Reflect.hasMetadata(l,t)){var n=Reflect.getMetadata(l,t);try{return null===(r=(i=e)[n.value])||void 0===r?void 0:r.call(i)}catch(e){if(e instanceof Error)throw new Error(P(t.name,e.message))}}}(t,e);return at(i)?i.then((function(){return e})):e}function St(t,e){t.scope!==p.Singleton&&function(t,e){var i="Class cannot be instantiated in "+(t.scope===p.Request?"request":"transient")+" scope.";if("function"==typeof t.onDeactivation)throw new Error(B(e.name,i));if(Reflect.hasMetadata(d,e))throw new Error(N(e.name,i))}(t,e)}var wt=function(t,e,i,r){return new(i||(i=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Rt=function(t,e){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Tt=function(t){return function(e){e.parentContext.setCurrentRequest(e);var i=e.bindings,r=e.childRequests,n=e.target&&e.target.isArray(),o=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(n&&o)return r.map((function(e){return Tt(t)(e)}));if(!e.target.isOptional()||0!==i.length){var s=i[0];return Pt(t,e,s)}}},Ct=function(t,e){var i=function(t){switch(t.type){case g.Factory:return{factory:t.factory,factoryType:ct.Factory};case g.Provider:return{factory:t.provider,factoryType:ct.Provider};case g.DynamicValue:return{factory:t.dynamicValue,factoryType:ct.DynamicValue};default:throw new Error("Unexpected factory type "+t.type)}}(t);return function(t,e){try{return t()}catch(t){throw F(t)&&(t=e()),t}}((function(){return i.factory.bind(t)(e)}),(function(){return new Error((t=i.factoryType,r=e.currentRequest.serviceIdentifier.toString(),"It looks like there is a circular dependency in one of the '"+t+"' bindings. Please investigate bindings with service identifier '"+r+"'."));var t,r}))},It=function(t,e,i){var r,n=e.childRequests;switch(function(t){var e=null;switch(t.type){case g.ConstantValue:case g.Function:e=t.cache;break;case g.Constructor:case g.Instance:e=t.implementationType;break;case g.DynamicValue:e=t.dynamicValue;break;case g.Provider:e=t.provider;break;case g.Factory:e=t.factory}if(null===e){var i=k(t.serviceIdentifier);throw new Error("Invalid binding type: "+i)}}(i),i.type){case g.ConstantValue:case g.Function:r=i.cache;break;case g.Constructor:r=i.implementationType;break;case g.Instance:r=function(t,e,i,r){St(t,e);var n=Et(e,i,r);return at(n)?n.then((function(t){return At(e,t)})):At(e,n)}(i,i.implementationType,n,Tt(t));break;default:r=Ct(i,e.parentContext)}return r},Mt=function(t,e,i){var r=function(t,e){return e.scope===p.Singleton&&e.activated?e.cache:e.scope===p.Request&&t.has(e.id)?t.get(e.id):null}(t,e);return null!==r||function(t,e,i){e.scope===p.Singleton&&ft(e,i),e.scope===p.Request&&dt(t,e,i)}(t,e,r=i()),r},Pt=function(t,e,i){return Mt(t,i,(function(){var r=It(t,e,i);return r=at(r)?r.then((function(t){return Nt(e,i,t)})):Nt(e,i,r)}))};function Nt(t,e,i){var r,n=Bt(t.parentContext,e,i),o=Ft(t.parentContext.container),s=o.next();do{r=s.value;var a=t.parentContext,u=t.serviceIdentifier,c=xt(r,u);n=at(n)?Dt(c,a,n):Ot(c,a,n),s=o.next()}while(!0!==s.done&&!it(r).hasKey(t.serviceIdentifier));return n}var Bt=function(t,e,i){return"function"==typeof e.onActivation?e.onActivation(t,i):i},Ot=function(t,e,i){for(var r=t.next();!r.done;){if(at(i=r.value(e,i)))return Dt(t,e,i);r=t.next()}return i},Dt=function(t,e,i){return wt(void 0,void 0,void 0,(function(){var r,n;return Rt(this,(function(o){switch(o.label){case 0:return[4,i];case 1:r=o.sent(),n=t.next(),o.label=2;case 2:return n.done?[3,4]:[4,n.value(e,r)];case 3:return r=o.sent(),n=t.next(),[3,2];case 4:return[2,r]}}))}))},xt=function(t,e){var i=t._activations;return i.hasKey(e)?i.get(e).values():[].values()},Ft=function(t){for(var e=[t],i=t.parent;null!==i;)e.push(i),i=i.parent;return{next:function(){var t=e.pop();return void 0!==t?{done:!1,value:t}:{done:!0,value:void 0}}}};var kt=function(t,e){var i=t.parentRequest;return null!==i&&(!!e(i)||kt(i,e))},Lt=function(t){return function(e){var i=function(i){return null!==i&&null!==i.target&&i.target.matchesTag(t)(e)};return i.metaData=new j(t,e),i}},Gt=Lt(i),Wt=function(t){return function(e){var i=null;if(null!==e){if(i=e.bindings[0],"string"==typeof t)return i.serviceIdentifier===t;var r=e.bindings[0].implementationType;return t===r}return!1}},Vt=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new Ut(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=Gt(t),new Ut(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t&&(null!==t.target&&!t.target.isNamed()&&!t.target.isTagged())},new Ut(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=Lt(t)(e),new Ut(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return null!==e&&Wt(t)(e.parentRequest)},new Ut(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return null!==e&&Gt(t)(e.parentRequest)},new Ut(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(i){return null!==i&&Lt(t)(e)(i.parentRequest)},new Ut(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return null!==e&&kt(e,Wt(t))},new Ut(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return null!==e&&!kt(e,Wt(t))},new Ut(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return null!==e&&kt(e,Gt(t))},new Ut(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return null!==e&&!kt(e,Gt(t))},new Ut(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(i){return null!==i&&kt(i,Lt(t)(e))},new Ut(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(i){return null!==i&&!kt(i,Lt(t)(e))},new Ut(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return null!==e&&kt(e,t)},new Ut(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return null!==e&&!kt(e,t)},new Ut(this._binding)},t}(),Ut=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new Vt(this._binding)},t.prototype.onDeactivation=function(t){return this._binding.onDeactivation=t,new Vt(this._binding)},t}(),jt=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new Vt(this._binding),this._bindingOnSyntax=new Ut(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t.prototype.onDeactivation=function(t){return this._bindingOnSyntax.onDeactivation(t)},t}(),qt=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=p.Request,new jt(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=p.Singleton,new jt(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=p.Transient,new jt(this._binding)},t}(),Ht=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new Vt(this._binding),this._bindingOnSyntax=new Ut(this._binding),this._bindingInSyntax=new qt(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t.prototype.onDeactivation=function(t){return this._bindingOnSyntax.onDeactivation(t)},t}(),Kt=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=g.Instance,this._binding.implementationType=t,new Ht(this._binding)},t.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=g.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=p.Singleton,new jt(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=g.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Ht(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=g.Constructor,this._binding.implementationType=t,this._binding.scope=p.Singleton,new jt(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=g.Factory,this._binding.factory=t,this._binding.scope=p.Singleton,new jt(this._binding)},t.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error("Value provided to function binding must be a function!");var e=this.toConstantValue(t);return this._binding.type=g.Function,this._binding.scope=p.Singleton,e},t.prototype.toAutoFactory=function(t){return this._binding.type=g.Factory,this._binding.factory=function(e){return function(){return e.container.get(t)}},this._binding.scope=p.Singleton,new jt(this._binding)},t.prototype.toAutoNamedFactory=function(t){return this._binding.type=g.Factory,this._binding.factory=function(e){return function(i){return e.container.getNamed(t,i)}},new jt(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=g.Provider,this._binding.provider=t,this._binding.scope=p.Singleton,new jt(this._binding)},t.prototype.toService=function(t){this.toDynamicValue((function(e){return e.container.get(t)}))},t}(),Yt=function(){function t(){}return t.of=function(e,i,r,n,o){var s=new t;return s.bindings=e,s.middleware=i,s.deactivations=n,s.activations=r,s.moduleActivationStore=o,s},t}();var zt=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null==t)throw new Error(b);if(null==e)throw new Error(b);var i=this._map.get(t);void 0!==i?i.push(e):this._map.set(t,[e])},t.prototype.get=function(t){if(null==t)throw new Error(b);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(A)},t.prototype.remove=function(t){if(null==t)throw new Error(b);if(!this._map.delete(t))throw new Error(A)},t.prototype.removeIntersection=function(t){var e=this;this.traverse((function(i,r){var n=t.hasKey(i)?t.get(i):void 0;if(void 0!==n){var o=r.filter((function(t){return!n.some((function(e){return t===e}))}));e._setValue(i,o)}}))},t.prototype.removeByCondition=function(t){var e=this,i=[];return this._map.forEach((function(r,n){for(var o=[],s=0,a=r;s<a.length;s++){var u=a[s];t(u)?i.push(u):o.push(u)}e._setValue(n,o)})),i},t.prototype.hasKey=function(t){if(null==t)throw new Error(b);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach((function(t,i){t.forEach((function(t){return e.add(i,"object"==typeof(r=t)&&null!==r&&"clone"in r&&"function"==typeof r.clone?t.clone():t);var r}))})),e},t.prototype.traverse=function(t){this._map.forEach((function(e,i){t(i,e)}))},t.prototype._setValue=function(t,e){e.length>0?this._map.set(t,e):this._map.delete(t)},t}(),Xt=function(){function t(){this._map=new Map}return t.prototype.remove=function(t){if(this._map.has(t)){var e=this._map.get(t);return this._map.delete(t),e}return this._getEmptyHandlersStore()},t.prototype.addDeactivation=function(t,e,i){this._getModuleActivationHandlers(t).onDeactivations.add(e,i)},t.prototype.addActivation=function(t,e,i){this._getModuleActivationHandlers(t).onActivations.add(e,i)},t.prototype.clone=function(){var e=new t;return this._map.forEach((function(t,i){e._map.set(i,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})})),e},t.prototype._getModuleActivationHandlers=function(t){var e=this._map.get(t);return void 0===e&&(e=this._getEmptyHandlersStore(),this._map.set(t,e)),e},t.prototype._getEmptyHandlersStore=function(){return{onActivations:new zt,onDeactivations:new zt}},t}(),Qt=function(){return Qt=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Qt.apply(this,arguments)},Zt=function(t,e,i,r){return new(i||(i=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},$t=function(t,e){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Jt=function(t,e,i){if(i||2===arguments.length)for(var r,n=0,o=e.length;n<o;n++)!r&&n in e||(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},te=function(){function t(t){var e=t||{};if("object"!=typeof e)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===e.defaultScope)e.defaultScope=p.Transient;else if(e.defaultScope!==p.Singleton&&e.defaultScope!==p.Transient&&e.defaultScope!==p.Request)throw new Error('Invalid Container option. Default scope must be a string ("singleton" or "transient").');if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!=typeof e.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!=typeof e.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=y(),this._bindingDictionary=new zt,this._snapshots=[],this._middleware=null,this._activations=new zt,this._deactivations=new zt,this.parent=null,this._metadataReader=new D,this._moduleActivationStore=new Xt}return t.merge=function(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=new t,s=Jt([e,i],r,!0).map((function(t){return it(t)})),a=it(o);return s.forEach((function(t){var e;e=a,t.traverse((function(t,i){i.forEach((function(t){e.add(t.serviceIdentifier,t.clone())}))}))})),o},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this._getContainerModuleHelpersFactory(),r=0,n=t;r<n.length;r++){var o=n[r],s=i(o.id);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction,s.unbindAsyncFunction,s.onActivationFunction,s.onDeactivationFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Zt(this,void 0,void 0,(function(){var e,i,r,n,o;return $t(this,(function(s){switch(s.label){case 0:e=this._getContainerModuleHelpersFactory(),i=0,r=t,s.label=1;case 1:return i<r.length?(n=r[i],o=e(n.id),[4,n.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:s.sent(),s.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},t.prototype.unload=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];e.forEach((function(e){var i=t._removeModuleBindings(e.id);t._deactivateSingletons(i),t._removeModuleHandlers(e.id)}))},t.prototype.unloadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Zt(this,void 0,void 0,(function(){var e,i,r,n;return $t(this,(function(o){switch(o.label){case 0:e=0,i=t,o.label=1;case 1:return e<i.length?(r=i[e],n=this._removeModuleBindings(r.id),[4,this._deactivateSingletonsAsync(n)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(r.id),o.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},t.prototype.bind=function(t){var e=this.options.defaultScope||p.Transient,i=new E(t,e);return this._bindingDictionary.add(t,i),new Kt(i)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.rebindAsync=function(t){return Zt(this,void 0,void 0,(function(){return $t(this,(function(e){switch(e.label){case 0:return[4,this.unbindAsync(t)];case 1:return e.sent(),[2,this.bind(t)]}}))}))},t.prototype.unbind=function(t){if(this._bindingDictionary.hasKey(t)){var e=this._bindingDictionary.get(t);this._deactivateSingletons(e)}this._removeServiceFromDictionary(t)},t.prototype.unbindAsync=function(t){return Zt(this,void 0,void 0,(function(){var e;return $t(this,(function(i){switch(i.label){case 0:return this._bindingDictionary.hasKey(t)?(e=this._bindingDictionary.get(t),[4,this._deactivateSingletonsAsync(e)]):[3,2];case 1:i.sent(),i.label=2;case 2:return this._removeServiceFromDictionary(t),[2]}}))}))},t.prototype.unbindAll=function(){var t=this;this._bindingDictionary.traverse((function(e,i){t._deactivateSingletons(i)})),this._bindingDictionary=new zt},t.prototype.unbindAllAsync=function(){return Zt(this,void 0,void 0,(function(){var t,e=this;return $t(this,(function(i){switch(i.label){case 0:return t=[],this._bindingDictionary.traverse((function(i,r){t.push(e._deactivateSingletonsAsync(r))})),[4,Promise.all(t)];case 1:return i.sent(),this._bindingDictionary=new zt,[2]}}))}))},t.prototype.onActivation=function(t,e){this._activations.add(t,e)},t.prototype.onDeactivation=function(t,e){this._deactivations.add(t,e)},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isCurrentBound=function(t){return this._bindingDictionary.hasKey(t)},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,i,e)},t.prototype.isBoundTagged=function(t,e,i){var r=!1;if(this._bindingDictionary.hasKey(t)){var n=this._bindingDictionary.get(t),o=function(t,e,i,r){var n=new Y(v.Variable,"",e,new j(i,r)),o=new U(t);return new et(e,o,null,[],n)}(this,t,e,i);r=n.some((function(t){return t.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,e,i)),r},t.prototype.snapshot=function(){this._snapshots.push(Yt.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error("No snapshot available to restore.");this._bindingDictionary=t.bindings,this._activations=t.activations,this._deactivations=t.deactivations,this._middleware=t.middleware,this._moduleActivationStore=t.moduleActivationStore},t.prototype.createChild=function(e){var i=new t(e||this.options);return i.parent=this,i},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce((function(t,e){return e(t)}),i)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){var e=this._getNotAllArgs(t,!1);return this._getButThrowIfAsync(e)},t.prototype.getAsync=function(t){return Zt(this,void 0,void 0,(function(){var e;return $t(this,(function(i){return e=this._getNotAllArgs(t,!1),[2,this._get(e)]}))}))},t.prototype.getTagged=function(t,e,i){var r=this._getNotAllArgs(t,!1,e,i);return this._getButThrowIfAsync(r)},t.prototype.getTaggedAsync=function(t,e,i){return Zt(this,void 0,void 0,(function(){var r;return $t(this,(function(n){return r=this._getNotAllArgs(t,!1,e,i),[2,this._get(r)]}))}))},t.prototype.getNamed=function(t,e){return this.getTagged(t,i,e)},t.prototype.getNamedAsync=function(t,e){return this.getTaggedAsync(t,i,e)},t.prototype.getAll=function(t){var e=this._getAllArgs(t);return this._getButThrowIfAsync(e)},t.prototype.getAllAsync=function(t){var e=this._getAllArgs(t);return this._getAll(e)},t.prototype.getAllTagged=function(t,e,i){var r=this._getNotAllArgs(t,!0,e,i);return this._getButThrowIfAsync(r)},t.prototype.getAllTaggedAsync=function(t,e,i){var r=this._getNotAllArgs(t,!0,e,i);return this._getAll(r)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,i,e)},t.prototype.getAllNamedAsync=function(t,e){return this.getAllTaggedAsync(t,i,e)},t.prototype.resolve=function(t){var e=this.isBound(t);e||this.bind(t).toSelf();var i=this.get(t);return e||this.unbind(t),i},t.prototype._preDestroy=function(t,e){var i,r;if(Reflect.hasMetadata(d,t))return null===(r=(i=e)[Reflect.getMetadata(d,t).value])||void 0===r?void 0:r.call(i)},t.prototype._removeModuleHandlers=function(t){var e=this._moduleActivationStore.remove(t);this._activations.removeIntersection(e.onActivations),this._deactivations.removeIntersection(e.onDeactivations)},t.prototype._removeModuleBindings=function(t){return this._bindingDictionary.removeByCondition((function(e){return e.moduleId===t}))},t.prototype._deactivate=function(t,e){var i=this,r=Object.getPrototypeOf(e).constructor;try{if(this._deactivations.hasKey(t.serviceIdentifier)){var n=this._deactivateContainer(e,this._deactivations.get(t.serviceIdentifier).values());if(at(n))return this._handleDeactivationError(n.then((function(){return i._propagateContainerDeactivationThenBindingAndPreDestroyAsync(t,e,r)})),r)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(t,e,r);if(at(o))return this._handleDeactivationError(o,r)}catch(t){if(t instanceof Error)throw new Error(B(r.name,t.message))}},t.prototype._handleDeactivationError=function(t,e){return Zt(this,void 0,void 0,(function(){var i;return $t(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return r.sent(),[3,3];case 2:if((i=r.sent())instanceof Error)throw new Error(B(e.name,i.message));return[3,3];case 3:return[2]}}))}))},t.prototype._deactivateContainer=function(t,e){for(var i=this,r=e.next();r.value;){var n=r.value(t);if(at(n))return n.then((function(){return i._deactivateContainerAsync(t,e)}));r=e.next()}},t.prototype._deactivateContainerAsync=function(t,e){return Zt(this,void 0,void 0,(function(){var i;return $t(this,(function(r){switch(r.label){case 0:i=e.next(),r.label=1;case 1:return i.value?[4,i.value(t)]:[3,3];case 2:return r.sent(),i=e.next(),[3,1];case 3:return[2]}}))}))},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},i=function(i){return function(r){var n=t.rebind(r);return e(n,i),n}},r=function(e){return function(i,r){t._moduleActivationStore.addActivation(e,i,r),t.onActivation(i,r)}},n=function(e){return function(i,r){t._moduleActivationStore.addDeactivation(e,i,r),t.onDeactivation(i,r)}};return function(o){return{bindFunction:(s=o,function(i){var r=t.bind(i);return e(r,s),r}),isboundFunction:function(e){return t.isBound(e)},onActivationFunction:r(o),onDeactivationFunction:n(o),rebindFunction:i(o),unbindFunction:function(e){return t.unbind(e)},unbindAsyncFunction:function(e){return t.unbindAsync(e)}};var s}},t.prototype._getAll=function(t){return Promise.all(this._get(t))},t.prototype._get=function(t){var e=Qt(Qt({},t),{contextInterceptor:function(t){return t},targetType:v.Variable});if(this._middleware){var i=this._middleware(e);if(null==i)throw new Error("Invalid return type in middleware. Middleware must return!");return i}return this._planAndResolve()(e)},t.prototype._getButThrowIfAsync=function(t){var e=this._get(t);if(ut(e))throw new Error("You are attempting to construct '"+t.serviceIdentifier+"' in a synchronous way\n but it has asynchronous dependencies.");return e},t.prototype._getAllArgs=function(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}},t.prototype._getNotAllArgs=function(t,e,i,r){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:r}},t.prototype._planAndResolve=function(){var t=this;return function(e){var i=st(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return function(t){return Tt(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}(i=e.contextInterceptor(i))}},t.prototype._deactivateIfSingleton=function(t){var e=this;if(t.activated)return at(t.cache)?t.cache.then((function(i){return e._deactivate(t,i)})):this._deactivate(t,t.cache)},t.prototype._deactivateSingletons=function(t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(at(this._deactivateIfSingleton(r)))throw new Error("Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)")}},t.prototype._deactivateSingletonsAsync=function(t){return Zt(this,void 0,void 0,(function(){var e=this;return $t(this,(function(i){switch(i.label){case 0:return[4,Promise.all(t.map((function(t){return e._deactivateIfSingleton(t)})))];case 1:return i.sent(),[2]}}))}))},t.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(t,e,i){return this.parent?this._deactivate.bind(this.parent)(t,e):this._bindingDeactivationAndPreDestroy(t,e,i)},t.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(t,e,i){return Zt(this,void 0,void 0,(function(){return $t(this,(function(r){switch(r.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(t,e)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(t,e,i)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},t.prototype._removeServiceFromDictionary=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error("Could not unbind serviceIdentifier: "+k(t))}},t.prototype._bindingDeactivationAndPreDestroy=function(t,e,i){var r=this;if("function"==typeof t.onDeactivation){var n=t.onDeactivation(e);if(at(n))return n.then((function(){return r._preDestroy(i,e)}))}return this._preDestroy(i,e)},t.prototype._bindingDeactivationAndPreDestroyAsync=function(t,e,i){return Zt(this,void 0,void 0,(function(){return $t(this,(function(r){switch(r.label){case 0:return"function"!=typeof t.onDeactivation?[3,2]:[4,t.onDeactivation(e)];case 1:r.sent(),r.label=2;case 2:return[4,this._preDestroy(i,e)];case 3:return r.sent(),[2]}}))}))},t}();function ee(t,e,i,r){!function(t){if(void 0!==t)throw new Error(I)}(e),re(u,t,i.toString(),r)}function ie(t){var e=[];if(Array.isArray(t)){var i=function(t){for(var e=new Set,i=0,r=t;i<r.length;i++){var n=r[i];if(e.has(n))return n;e.add(n)}}((e=t).map((function(t){return t.key})));if(void 0!==i)throw new Error(_+" "+i.toString())}else e=[t];return e}function re(t,e,i,r){var n=ie(r),o={};Reflect.hasOwnMetadata(t,e)&&(o=Reflect.getMetadata(t,e));var s=o[i];if(void 0===s)s=[];else for(var a=function(t){if(n.some((function(e){return e.key===t.key})))throw new Error(_+" "+t.key.toString())},u=0,c=s;u<c.length;u++){a(c[u])}s.push.apply(s,n),o[i]=s,Reflect.defineMetadata(t,o,e)}function ne(t){return function(e,i,r){"number"==typeof r?ee(e,i,r,t):function(t,e,i){if(void 0!==t.prototype)throw new Error(I);re(c,t.constructor,e,i)}(e,i,t)}}function oe(){return function(t){if(Reflect.hasOwnMetadata(h,t))throw new Error("Cannot apply @injectable decorator multiple times.");var e=Reflect.getMetadata("design:paramtypes",t)||[];return Reflect.defineMetadata(h,e,t),t}}function se(t){return function(e){return function(i,r,n){if(void 0===e){var o="function"==typeof i?i.name:i.constructor.name;throw new Error("@inject called with undefined this could mean that the class "+o+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation.")}return ne(new j(t,e))(i,r,n)}}}var ae=se(s),ue=se(a);const ce={AudioContextManager:Symbol.for("AudioContextManager"),AudioEditor:Symbol.for("AudioEditor"),AudioProcessor:Symbol.for("AudioProcessor"),BufferManager:Symbol.for("BufferManager"),FilterManager:Symbol.for("FilterManager"),RendererManager:Symbol.for("RendererManager"),SaveBufferManager:Symbol.for("SaveBufferManager"),ConfigService:Symbol.for("ConfigService"),EventEmitter:Symbol.for("EventEmitter"),BufferPlayer:Symbol.for("BufferPlayer"),BufferDecoderService:Symbol.for("BufferDecoderService"),BufferFetcherService:Symbol.for("BufferFetcherService"),AudioBuffersToFetch:Symbol.for("AudioBuffersToFetch"),Renderers:Symbol.for("Renderers"),Filters:Symbol.for("Filters"),EntryPointFilter:Symbol.for("EntryPointFilter"),VoiceRecorder:Symbol.for("VoiceRecorder")};function he(t,e,i,r){var n,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s}function le(t,e){return function(i,r){e(i,r,t)}}function de(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function fe(t,e,i,r){return new(i||(i=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}var pe;"function"==typeof SuppressedError&&SuppressedError,exports.EventType=void 0,(pe=exports.EventType||(exports.EventType={})).LOADING_BUFFERS="loadingBuffers",pe.LOADING_BUFFERS_ERROR="loadingBuffersError",pe.FETCHING_BUFFERS="fetchingBuffers",pe.FETCHING_BUFFERS_ERROR="fetchingBuffersError",pe.FINISHED_FETCHING_BUFFERS="finishedFetchingBuffers",pe.LOADED_BUFFERS="loadedBuffers",pe.COMPATIBILITY_MODE_AUTO_ENABLED="compatibilityModeAutoEnabled",pe.STARTED_RENDERING_AUDIO="renderingAudio",pe.RENDERING_AUDIO_PROBLEM_DETECTED="renderingAudioProblemDetected",pe.AUDIO_RENDERING_FINISHED="audioRenderingFinished",pe.AUDIO_RENDERING_EXCEPTION_THROWN="audioRenderingExceptionThrown",pe.OFFLINE_AUDIO_RENDERING_FINISHED="offlineAudioRenderingFinished",pe.PLAYING_STOPPED="playingStopped",pe.PLAYING_STARTED="playingStarted",pe.PLAYING_FINISHED="playingFinished",pe.PLAYING_UPDATE="playingUpdate",pe.RECORDER_INIT="recorderInit",pe.RECORDER_SUCCESS="recorderSuccess",pe.RECORDER_ERROR="recorderError",pe.RECORDER_UPDATE_CONSTRAINTS="recorderUpdateConstraints",pe.RECORDER_RECORDING="recorderRecording",pe.RECORDER_STOPPED="recorderStopped",pe.RECORDER_PAUSED="recorderPaused",pe.RECORDER_RESETED="recorderReseted",pe.RECORDER_COUNT_UPDATE="recorderCountUpdate",pe.SAMPLE_RATE_CHANGED="sampleRateChanged",pe.DECODING_AUDIO_FILE="decodingAudioFile",pe.DECODED_AUDIO_FILE="decodedAudioFile",pe.ERROR_DECODING_AUDIO_FILE="errorDecodingAudioFile",pe.RECORDER_NOT_FOUND_ERROR="recorderNotFoundError",pe.RECORDER_UNKNOWN_ERROR="recorderUnknownError",pe.UPDATE_AUDIO_TREATMENT_PERCENT="updateAudioTreatmentPercent",pe.UPDATE_REMAINING_TIME_ESTIMATED="updateRemainingTimeEstimated",pe.CANCELLED_AND_LOADED_INITIAL_AUDIO="cancelledAndLoadedInitialAudio",pe.CANCELLING_AUDIO_PROCESSING="cancellingAudioProcessing",pe.PLAYING_FINISHED_LOOP_ALL="playingFinishedLoopAll",pe.LOADED_AUDIO_FILE_FROM_LIST="loadedAudioFileFromList";const ge={AUDIO_EDITOR:"audioEditor",VOICE_RECORDER:"voiceRecorder",BUFFER_PLAYER:"bufferPlayer",AUDIO_CONTEXT_MANAGER:"audioContextManager",AUDIO_PROCESSOR:"audioProcessor",BUFFER_MANAGER:"bufferManager",FILTER_MANAGER:"filterManager",RENDERER_MANAGER:"rendererManager",SAVE_BUFFER_MANAGER:"saveBufferManager",EXPORT_WAV_COMMAND:"exportWAV",EXPORT_MP3_COMMAND:"exportMP3",AUDIO_WAV:"audio/wav",AUDIO_MP3:"audio/mp3",RECORD_COMMAND:"record",INIT_COMMAND:"init",FILTERS_NAMES:{REVERB:"reverb",ECHO:"echo",BASS_BOOST:"bassboost",BITCRUSHER:"bitcrusher",HIGH_PASS:"highpass",LIMITER:"limiter",LOW_PASS:"lowpass",PASSTHROUGH:"passthroughfilter",RETURN_AUDIO:"returnAudio",SOUNDTOUCH:"soundtouch",TELEPHONIZER:"telephonizer",VOCODER:"vocoder"},WORKLET_PATHS:{BITCRUSHER:"BitCrusher.worklet.js",LIMITER:"Limiter.worklet.js",SOUNDTOUCH:"Soundtouch.worklet.js",RECORDER_WORKLET:"RecorderWorklet.js",PASSTHROUGH:"Passthrough.worklet.js"},WORKLET_NAMES:{BITCRUSHER:"bitcrusher-processor",LIMITER:"limiter-processor",SOUNDTOUCH:"soundtouch-worklet",RECORDER_WORKLET:"recorder-worklet",PASSTHROUGH:"passthrough"},PREFERENCES_KEYS:{COMPATIBILITY_MODE_ENABLED:"compatibility-mode-enabled",COMPATIBILITY_MODE_CHECKED:"compatibility-mode-checked",ENABLE_AUDIO_WORKLET:"enable-audio-worklet",ENABLE_SOUNDTOUCH_AUDIO_WORKLET:"enable-soundtouch-audio-worklet",BUFFER_SIZE:"buffer-size",SAMPLE_RATE:"sample-rate",DISABLE_INITIAL_RENDERING:"disable-initial-rendering",BITRATE_MP3:"bitrate-mp3"},ENABLE_SOUNDTOUCH_AUDIO_WORKLET:!0,ENABLE_AUDIO_WORKLET:!0,ENABLE_RECORDER_AUDIO_WORKLET:!0,SOUNDTOUCH_PITCH_SHIFTER_BUFFER_SIZE:16384,DEFAULT_REVERB_ENVIRONMENT:{name:"Medium Damping Cave E002 M2S",url:"impulse_response.wav",size:1350278,addDuration:4,link:"http://www.cksde.com/p_6_250.htm"},VOCODER_MODULATOR:"modulator.mp3",DEFAULT_BUFFER_SIZE:0,VALID_BUFFER_SIZE:[0,256,512,1024,2048,4096,8192,16384],VALID_MP3_BITRATES:[32,64,96,128,160,256,320],DEFAULT_SAMPLE_RATE:0,VALID_SAMPLE_RATES:[0,8e3,11025,16e3,22050,32e3,44100,48e3,88200,96e3,176400,192e3],TREATMENT_TIME_COUNTING_THROTTLE_INTERVAL:100,TREATMENT_TIME_COUNTING_SMOOTHING_FACTOR:.9,DISABLE_INITIAL_RENDERING:!0,DEFAULT_SAVE_FORMAT:"wav",DEFAULT_MP3_BITRATE:320};let ve=class{constructor(){this.listeners={},this.listeners={}}on(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}emit(t,e){this.listeners[t]&&this.listeners[t].forEach((t=>{t(e)}))}off(t,e){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter((t=>t!==e)))}};ve=he([oe(),de("design:paramtypes",[])],ve);var me=ve;let ye=class{constructor(t,e){this.previousSampleRate=ge.DEFAULT_SAMPLE_RATE,this.eventEmitter=t||new me,this.configService=e,this.setup()}setup(){this.configService&&(this.previousSampleRate=this.configService.getSampleRate(),this.eventEmitter&&this.eventEmitter.emit(exports.EventType.SAMPLE_RATE_CHANGED,this.previousSampleRate)),this.currentContext||this.createNewContext(this.previousSampleRate)}createNewContextIfNeeded(t){if(this.configService&&this.configService.isCompatibilityModeEnabled()&&t){if(this.currentSampleRate!=t.sampleRate)return this.createNewContext(t.sampleRate),!0}else{let t=ge.DEFAULT_SAMPLE_RATE;if(this.configService&&(t=this.configService.getSampleRate()),t!=this.previousSampleRate)return this.createNewContext(t),!0}return!1}createNewContext(t){this._currentContext&&(this.oldAudioContext=this._currentContext,this.destroyOldContext());const e={latencyHint:"interactive"};0!=t&&(e.sampleRate=t),this._currentContext=new AudioContext(e),this.eventEmitter&&this.eventEmitter.emit(exports.EventType.SAMPLE_RATE_CHANGED,this.currentSampleRate),this.previousSampleRate=t}destroyOldContext(){this.oldAudioContext&&(this.oldAudioContext.close(),this.oldAudioContext=null)}get currentSampleRate(){return this.currentContext?this.currentContext.sampleRate:0}get currentContext(){return this._currentContext}};ye=he([oe(),le(0,ae(ce.EventEmitter)),le(1,ae(ce.ConfigService)),de("design:paramtypes",[Object,Object])],ye);var Ee=ye;let _e=class{constructor(){this.enabled=!1,this.defaultEnabled=!1,this.bufferFetcherService=null,this.bufferDecoderService=null,this.configService=null,this.eventEmitter=null}isEnabled(){return this.enabled}isDefaultEnabled(){return this.defaultEnabled}setDefaultEnabled(t){this.defaultEnabled=t,t?this.enable():this.disable()}setEnabled(t){this.enabled=t}enable(){this.setEnabled(!0)}disable(){this.setEnabled(!1)}toggle(){this.setEnabled(!this.isEnabled())}injectDependencies(t,e,i,r){t&&(this.bufferFetcherService=t),e&&(this.bufferDecoderService=e),i&&(this.configService=i),r&&(this.eventEmitter=r)}};he([ae(ce.BufferFetcherService),de("design:type",Object)],_e.prototype,"bufferFetcherService",void 0),he([ae(ce.BufferDecoderService),de("design:type",Object)],_e.prototype,"bufferDecoderService",void 0),he([ae(ce.ConfigService),de("design:type",Object)],_e.prototype,"configService",void 0),he([ae(ce.EventEmitter),de("design:type",Object)],_e.prototype,"eventEmitter",void 0),_e=he([oe()],_e);var be=_e;const Ae={calcAudioDuration:(t,e)=>{if(t){let i=t.duration+1;return e&&(i/=e),i}return 0},loadAudioBuffer:(t,e)=>fe(void 0,void 0,void 0,(function*(){const i=yield Ae.readAsArrayBufferPromisified(e),r=yield t.decodeAudioData(i);return Ae.decodeBuffer(t,r)})),readAsArrayBufferPromisified:t=>new Promise(((e,i)=>{const r=new FileReader;r.onload=t=>{var r;const n=null===(r=null==t?void 0:t.target)||void 0===r?void 0:r.result;n instanceof ArrayBuffer?e(n):i()},t&&r.readAsArrayBuffer(t)})),decodeBuffer:(t,e)=>{if(1==e.numberOfChannels){t.resume();const i=e.duration,r=t.sampleRate,n=t.createBuffer(2,r*i+2*r,r),o=e.getChannelData(0),s=n.getChannelData(0),a=n.getChannelData(1);for(let t=0;t<o.length;t++)s[t]=o[t],a[t]=o[t];return n}return e},convertAudioBufferToFloat32Array:t=>{const e=[];for(let i=0;i<t.numberOfChannels;i++)e.push(t.getChannelData(i));return e},convertAudioParamToFloat32Array:(t,e)=>{const i=new Float32Array(e);for(let r=0;r<e;r++)i.set([t.value],r);return i},sumAudioBufferChannel:(t,e)=>t.getChannelData(e).reduce(((t,e)=>t+e),0),sumAudioBuffer(t){let e=0;for(let i=0;i<t.numberOfChannels;i++)e+=this.sumAudioBufferChannel(t,i);return e},isAudioWorkletCompatible:t=>void 0!==t&&void 0!==t.audioWorklet,isSettingValueValid:t=>!(void 0===t||isNaN(Number(t))||"string"==typeof t&&""===t.trim()),calculateAudioDuration(t,e,i){if(t&&e){return this.calcAudioDuration(t,i)+e.getAddingTime()}return 0},resetAudioRenderingProgress(t){t&&(t.emit(exports.EventType.UPDATE_AUDIO_TREATMENT_PERCENT,0),t.emit(exports.EventType.UPDATE_REMAINING_TIME_ESTIMATED,-1))},forceDownload(t,e){const i=window.document.createElement("a"),r=URL.createObjectURL(t);window.document.body.appendChild(i),i.href=r,i.download=e||"output.wav",i.click(),URL.revokeObjectURL(r)}};let Se=class extends be{constructor(t,e,i,r,n,o,s){super(),this.principalBuffer=null,this.fileList=null,this.fileListCurrIndex=0,this.loadingAudio=!1,this.renderingAudio=!1,this.filterManager=t,this.rendererManager=e,this.contextManager=i,this.saveBufferManager=r,this.audioProcessor=n,this.bufferManager=o,this.bufferPlayer=s,this.setup()}setup(){this.bufferPlayer&&(this.bufferPlayer.onBeforePlaying((()=>fe(this,void 0,void 0,(function*(){this.bufferPlayer&&this.bufferPlayer.compatibilityMode&&this.contextManager&&this.contextManager.currentContext&&this.audioProcessor&&(yield this.audioProcessor.setupOutput(this.principalBuffer,this.contextManager.currentContext))})))),this.bufferPlayer.on(exports.EventType.PLAYING_FINISHED,(()=>{this.bufferPlayer&&this.bufferPlayer.loop&&this.bufferPlayer.start()})),this.bufferPlayer.on(exports.EventType.PLAYING_FINISHED_LOOP_ALL,(()=>fe(this,void 0,void 0,(function*(){this.bufferPlayer&&this.bufferPlayer.loopAll&&!this.renderingAudio&&!this.loadingAudio&&(yield this.loadNextAudio(!0),this.bufferPlayer.start())})))))}addFilters(...t){this.filterManager&&this.filterManager.addFilters(...t)}addRenderers(...t){this.rendererManager&&this.rendererManager.addRenderers(...t)}get currentSampleRate(){return this.contextManager?this.contextManager.currentSampleRate:0}get defaultDeviceSampleRate(){const t=new AudioContext;let e=0;return t&&(e=t.sampleRate,t.close()),e}loadBufferFromFile(t){return fe(this,void 0,void 0,(function*(){if(this.principalBuffer=null,this.loadingAudio=!0,this.audioProcessor&&(yield this.audioProcessor.prepareContext(this.principalBuffer)),!(this.contextManager&&this.contextManager.currentContext&&this.bufferDecoderService&&this.audioProcessor))throw this.loadingAudio=!1,new Error("Audio Context is not ready!");if(this.principalBuffer=yield this.bufferDecoderService.decodeBufferFromFile(t),this.audioProcessor.initialRenderingDone=!1,!this.principalBuffer)throw this.loadingAudio=!1,new Error("Error decoding audio file");this.audioProcessor.sumInputBuffer=Ae.sumAudioBuffer(this.principalBuffer),Ae.resetAudioRenderingProgress(this.eventEmitter),this.bufferPlayer&&this.bufferPlayer.loopAll&&this.totalFileList<=1&&this.bufferPlayer.toggleLoop(),this.loadingAudio=!1}))}loadFileList(t){return fe(this,void 0,void 0,(function*(){this.fileList=t,yield this.loadBufferFromFileListIndex(0)}))}loadBufferFromFileListIndex(t){return fe(this,void 0,void 0,(function*(){if(this.fileList){this.fileListCurrIndex=t;const e=this.fileList.item(this.fileListCurrIndex);this.eventEmitter&&this.eventEmitter.emit(exports.EventType.LOADED_AUDIO_FILE_FROM_LIST,t),e&&(yield this.loadBufferFromFile(e))}}))}loadPreviousAudio(t){return fe(this,void 0,void 0,(function*(){const e=this.currentIndexFileList,i=this.totalFileList,r=e-1;r!=e&&(r<0?yield this.loadBufferFromFileListIndex(i-1):yield this.loadBufferFromFileListIndex(r),yield this.renderAudio(t))}))}loadNextAudio(t){return fe(this,void 0,void 0,(function*(){const e=this.currentIndexFileList,i=this.totalFileList,r=e+1;r!=e&&(r>=i?yield this.loadBufferFromFileListIndex(0):yield this.loadBufferFromFileListIndex(r),yield this.renderAudio(t))}))}getCurrentFileList(){if(this.fileList){const t=new Map;for(let e=0;e<this.fileList.length;e++){const i=this.fileList.item(e);i&&t.set(i.name,this.currentIndexFileList===e)}return t}return new Map}get currentIndexFileList(){return this.fileListCurrIndex}get totalFileList(){return this.fileList?this.fileList.length:0}loadBuffer(t){this.principalBuffer=t,this.audioProcessor&&(this.audioProcessor.sumInputBuffer=Ae.sumAudioBuffer(this.principalBuffer),this.audioProcessor.initialRenderingDone=!1)}getOutputBuffer(){return this.audioProcessor?this.audioProcessor.renderedBuffer:null}renderAudio(t){return fe(this,void 0,void 0,(function*(){if(this.audioProcessor)try{this.renderingAudio=!0,this.eventEmitter&&this.eventEmitter.emit(exports.EventType.STARTED_RENDERING_AUDIO);const e=yield this.audioProcessor.renderAudio(this.principalBuffer,t);return this.eventEmitter&&this.eventEmitter.emit(exports.EventType.AUDIO_RENDERING_FINISHED),this.renderingAudio=!1,e}catch(t){this.eventEmitter&&(this.eventEmitter.emit(exports.EventType.AUDIO_RENDERING_FINISHED),this.eventEmitter.emit(exports.EventType.AUDIO_RENDERING_EXCEPTION_THROWN,t)),this.renderingAudio=!1}return!1}))}isAudioWorkletAvailable(){return!(!this.contextManager||!this.contextManager.currentContext)&&Ae.isAudioWorkletCompatible(this.contextManager.currentContext)}getFiltersState(){return this.filterManager&&this.rendererManager?Object.assign(Object.assign({},this.filterManager.getFiltersState()),this.rendererManager.getRenderersState()):{}}getFiltersSettings(){return this.filterManager?this.filterManager.getFiltersSettings():new Map}reconnectNodesIfNeeded(){return fe(this,void 0,void 0,(function*(){if(this.contextManager&&this.bufferPlayer&&this.bufferPlayer.compatibilityMode&&this.contextManager.currentContext&&this.principalBuffer&&this.filterManager&&this.filterManager.entrypointFilter){yield this.filterManager.connectNodes(this.contextManager.currentContext,this.principalBuffer,!0,this.bufferPlayer.compatibilityMode);const t=this.filterManager.entrypointFilter.getSpeed();this.bufferPlayer.speedAudio=t,this.bufferPlayer.duration=Ae.calculateAudioDuration(this.principalBuffer,this.filterManager,t)*t}}))}toggleFilter(t){this.rendererManager&&this.rendererManager.toggleRenderer(t),this.filterManager&&(this.filterManager.toggleFilter(t),this.reconnectNodesIfNeeded())}changeFilterSettings(t,e){return fe(this,void 0,void 0,(function*(){this.filterManager&&(yield this.filterManager.changeFilterSettings(t,e),yield this.reconnectNodesIfNeeded())}))}resetFilterSettings(t){return fe(this,void 0,void 0,(function*(){this.filterManager&&(yield this.filterManager.resetFilterSettings(t),yield this.reconnectNodesIfNeeded())}))}resetAllFiltersState(){this.rendererManager&&this.rendererManager.resetAllRenderersState(),this.filterManager&&(this.filterManager.resetAllFiltersState(),this.reconnectNodesIfNeeded())}exit(){this.bufferPlayer&&(this.bufferPlayer.stop(),this.bufferPlayer.reset()),this.cancelAudioRendering(),this.principalBuffer=null,this.fileList=null,this.fileListCurrIndex=0}cancelAudioRendering(){this.audioProcessor&&this.audioProcessor.cancelAudioRendering()}on(t,e){this.eventEmitter&&this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter&&this.eventEmitter.off(t,e)}saveBuffer(t){return fe(this,void 0,void 0,(function*(){var e;return!(!this.saveBufferManager||!this.audioProcessor)&&(yield null===(e=this.saveBufferManager)||void 0===e?void 0:e.saveBuffer(this.audioProcessor.renderedBuffer,t))}))}set downloadingInitialData(t){this.bufferManager&&(this.bufferManager.downloadingInitialData=t)}get downloadingInitialData(){return!!this.bufferManager&&this.bufferManager.downloadingInitialData}get order(){return-1}get id(){return ge.AUDIO_EDITOR}};Se=he([oe(),le(0,ae(ce.FilterManager)),le(1,ae(ce.RendererManager)),le(2,ae(ce.AudioContextManager)),le(3,ae(ce.SaveBufferManager)),le(4,ae(ce.AudioProcessor)),le(5,ae(ce.BufferManager)),le(6,ae(ce.BufferPlayer)),de("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],Se);var we=Se;let Re=class extends be{constructor(t,e,i,r,n){super(),this._renderedBuffer=null,this.audioRenderingLastCanceled=!1,this.initialRenderingDone=!1,this.sumInputBuffer=0,this.contextManager=i,this.bufferPlayer=r,this.filterManager=t,this.rendererManager=e,this.bufferManager=n}prepareContext(t){return fe(this,void 0,void 0,(function*(){if(this.contextManager){this.contextManager.createNewContextIfNeeded(t)&&this.bufferManager&&(yield this.bufferManager.resetBufferFetcher()),this.contextManager.currentContext&&this.contextManager.currentContext.resume()}}))}renderAudio(t,e){return fe(this,void 0,void 0,(function*(){if(yield this.prepareContext(t),!this.contextManager||!this.contextManager.currentContext)throw new Error("AudioContext is not yet available");if(!this.filterManager)throw new Error("Filter manager is not available");if(!this.rendererManager)throw new Error("Renderer manager is not available");if(!this.filterManager.entrypointFilter)throw new Error("Entrypoint filter is not available");if(!t)throw new Error("No principal buffer available");if(!this.initialRenderingDone&&this.configService&&this.configService.isInitialRenderingDisabled()&&!this.configService.isCompatibilityModeEnabled()&&!e)return this.loadInitialBuffer(t),this.initialRenderingDone=!0,!0;this.configService&&this.bufferPlayer&&!this.configService.isCompatibilityModeEnabled()&&this.bufferPlayer.compatibilityMode&&this.bufferPlayer.stop();const i=this.filterManager.entrypointFilter.getSpeed(),r=Ae.calculateAudioDuration(t,this.filterManager,i),n=new OfflineAudioContext(2,this.contextManager.currentContext.sampleRate*r,this.contextManager.currentContext.sampleRate),o=this.configService&&this.configService.isCompatibilityModeEnabled()?this.contextManager.currentContext:n;return this._renderedBuffer=yield this.rendererManager.executeAudioRenderers(t,o),this.currentOfflineContext=null,this.audioRenderingLastCanceled=!1,Ae.resetAudioRenderingProgress(this.eventEmitter),this.filterManager.setupTotalSamples(r,this.contextManager.currentContext),yield this.setupOutput(t,o,r,n)}))}setupPlayerSpeed(t){if(this.filterManager&&this.filterManager.entrypointFilter){const e=this.filterManager.entrypointFilter.getSpeed();t.speedAudio=e}}setupOutput(t,e,i,r){return fe(this,void 0,void 0,(function*(){if(this._renderedBuffer&&this.configService&&this.eventEmitter&&this.bufferPlayer&&this.filterManager){if(yield this.filterManager.initializeWorklets(e),yield this.filterManager.connectNodes(e,this._renderedBuffer,!1,this.configService.isCompatibilityModeEnabled()),this.setupPlayerSpeed(this.bufferPlayer),!this.configService.isCompatibilityModeEnabled()&&r&&this.filterManager.currentNodes){this.currentOfflineContext=r,this.filterManager.currentNodes.output.connect(e.destination);const n=yield r.startRendering();if(this.contextManager&&!this.loadRenderedAudio(t,n))return yield this.setupOutput(t,this.contextManager.currentContext,i);if(this.audioRenderingLastCanceled)return!1;this.eventEmitter.emit(exports.EventType.OFFLINE_AUDIO_RENDERING_FINISHED)}else this.filterManager.currentNodes&&(this.bufferPlayer.setCompatibilityMode(this.filterManager.currentNodes.output,i),this.initialRenderingDone=!0);return this.eventEmitter&&this.eventEmitter.emit(exports.EventType.AUDIO_RENDERING_FINISHED),!0}return!1}))}loadRenderedAudio(t,e){if(this.eventEmitter&&this.bufferPlayer){if(this.audioRenderingLastCanceled)this.initialRenderingDone||(this.loadInitialBuffer(t),this.eventEmitter.emit(exports.EventType.CANCELLED_AND_LOADED_INITIAL_AUDIO));else{if(0==Ae.sumAudioBuffer(e)&&0!==this.sumInputBuffer){if(this.configService&&!this.configService.isCompatibilityModeChecked())return this.setCompatibilityModeChecked(!0),this.configService.enableCompatibilityMode(),this.eventEmitter.emit(exports.EventType.COMPATIBILITY_MODE_AUTO_ENABLED),!1;this.eventEmitter.emit(exports.EventType.RENDERING_AUDIO_PROBLEM_DETECTED)}this._renderedBuffer=e,this.bufferPlayer.loadBuffer(this._renderedBuffer)}this.initialRenderingDone=!0}return!0}loadInitialBuffer(t){this.bufferPlayer&&(this._renderedBuffer=t,this.bufferPlayer.loadBuffer(t))}cancelAudioRendering(){this.currentOfflineContext&&!this.audioRenderingLastCanceled&&this.filterManager&&(this.audioRenderingLastCanceled=!0,this.filterManager.disconnectOldNodes(!1),this.eventEmitter&&this.eventEmitter.emit(exports.EventType.CANCELLING_AUDIO_PROCESSING))}setCompatibilityModeChecked(t){this.configService&&this.configService.setConfig(ge.PREFERENCES_KEYS.COMPATIBILITY_MODE_CHECKED,""+t)}get renderedBuffer(){return this._renderedBuffer}get order(){return-1}get id(){return ge.AUDIO_PROCESSOR}};Re=he([oe(),le(0,ae(ce.FilterManager)),le(1,ae(ce.RendererManager)),le(2,ae(ce.AudioContextManager)),le(3,ae(ce.BufferPlayer)),le(4,ae(ce.BufferManager)),de("design:paramtypes",[Object,Object,Object,Object,Object])],Re);var Te=Re;let Ce=class extends be{constructor(t,e,i,r){super(),this.downloadingInitialData=!1,this.audioBuffersToFetch=[],this.bufferFetcherService=e,this.eventEmitter=i,this.filterManager=t,this.filterManager=t,this.audioBuffersToFetch=r,this.setup()}setup(){this.audioBuffersToFetch.length>0&&this.fetchBuffers(!1)}fetchBuffers(t){return fe(this,void 0,void 0,(function*(){if(!this.downloadingInitialData&&this.bufferFetcherService){this.downloadingInitialData=!0,this.eventEmitter&&!t&&this.eventEmitter.emit(exports.EventType.LOADING_BUFFERS);try{this.bufferFetcherService.fetchAllBuffers(this.audioBuffersToFetch),this.downloadingInitialData=!1,this.eventEmitter&&!t&&this.eventEmitter.emit(exports.EventType.LOADED_BUFFERS)}catch(e){this.eventEmitter&&!t&&this.eventEmitter.emit(exports.EventType.LOADING_BUFFERS_ERROR)}}}))}resetBufferFetcher(){return fe(this,void 0,void 0,(function*(){this.bufferFetcherService&&(this.bufferFetcherService.reset(),yield this.fetchBuffers(!0),this.filterManager&&(yield this.filterManager.resetFilterBuffers()))}))}get order(){return-1}get id(){return ge.BUFFER_MANAGER}};Ce=he([oe(),le(0,ae(ce.FilterManager)),le(1,ae(ce.BufferFetcherService)),le(2,ae(ce.EventEmitter)),le(3,ae(ce.AudioBuffersToFetch)),de("design:paramtypes",[Object,Object,Object,Array])],Ce);var Ie=Ce;let Me=class extends be{constructor(t,e){super(),this.filters=[],this._entryPointFilter=null,this._currentNodes=null,this.filters=t,this._entryPointFilter=e,this.setup()}setup(){for(const t of this.filters)t.initializeDefaultSettings()}addFilters(...t){for(const e of t)e.initializeDefaultSettings(),e.injectDependencies(this.bufferFetcherService,this.bufferDecoderService,this.configService,this.eventEmitter);this.filters.push(...t)}getFiltersState(){const t={};return this.filters.forEach((e=>{t[e.id]=e.isEnabled()})),t}getFiltersSettings(){const t=new Map;for(const e of this.filters)t.set(e.id,e.getSettings());return t}toggleFilter(t){const e=this.filters.find((e=>e.id===t));e&&e.toggle()}changeFilterSettings(t,e){return fe(this,void 0,void 0,(function*(){const i=this.filters.find((e=>e.id===t));if(i)for(const t of Object.keys(e))yield i.setSetting(t,e[t])}))}resetFilterSettings(t){return fe(this,void 0,void 0,(function*(){const e=this.filters.find((e=>e.id===t));e&&(yield e.resetSettings())}))}resetAllFiltersState(){this.filters.forEach((t=>{t.isDefaultEnabled()?t.enable():t.disable()}))}connectNodes(t,e,i,r){return fe(this,void 0,void 0,(function*(){if(!this._entryPointFilter)return;let n=null;if(i&&this._currentNodes)n=this._currentNodes.input;else{const i=yield this._entryPointFilter.getEntrypointNode(t,e,!r);n=i.input}const o=[];let s=n;this.disconnectOldNodes(i);const a=this.filters.sort(((t,e)=>t.order-e.order)).filter(((t,e)=>t!==this._entryPointFilter&&(t.isEnabled()||e>=this.filters.length-1)));for(const e of a){const i=e.getNode(t);s&&s.connect(i.input),s=i.output,o.push(i)}this._entryPointFilter&&this._entryPointFilter.updateState(),this._currentNodes={input:n,output:s,intermediateNodes:o.filter((t=>t.input!=s&&t.output!=s&&t.input!=n&&t.output!=n))}}))}disconnectOldNodes(t){if(this._currentNodes&&(this._currentNodes.input.disconnect(),t||this._currentNodes.output.disconnect(),this._currentNodes.intermediateNodes))for(const t of this._currentNodes.intermediateNodes)t.input.disconnect(),t.output.disconnect()}initializeWorklets(t){return fe(this,void 0,void 0,(function*(){for(const e of this.filters)e.isWorklet()&&(yield e.initializeWorklet(t))}))}getAddingTime(){let t=0;for(const e of this.filters)e.isEnabled()&&(t+=e.getAddingTime());return t}setupTotalSamples(t,e){if(e){const i=t*e.sampleRate;for(const t of this.filters)t.totalSamples=i}}resetFilterBuffers(){return fe(this,void 0,void 0,(function*(){for(const t of this.filters)yield t.bufferFetcherReseted()}))}get entrypointFilter(){return this._entryPointFilter}get currentNodes(){return this._currentNodes}get order(){return-1}get id(){return ge.FILTER_MANAGER}};Me=he([oe(),le(0,ue(ce.Filters)),le(1,ae(ce.EntryPointFilter)),de("design:paramtypes",[Array,Object])],Me);var Pe=Me;let Ne=class extends be{constructor(t=[]){super(),this.renderers=[],this.renderers=t}addRenderers(...t){for(const e of t)e.injectDependencies(this.bufferFetcherService,this.bufferDecoderService,this.configService,this.eventEmitter);this.renderers.push(...t)}getRenderersState(){const t={};return this.renderers.forEach((e=>{t[e.id]=e.isEnabled()})),t}toggleRenderer(t){const e=this.renderers.find((e=>e.id===t));e&&e.toggle()}resetAllRenderersState(){this.renderers.forEach((t=>{t.isDefaultEnabled()?t.enable():t.disable()}))}executeAudioRenderers(t,e){return fe(this,void 0,void 0,(function*(){let i=t;for(const t of this.renderers.sort(((t,e)=>t.order-e.order)))t.isEnabled()&&(i=yield t.renderAudio(e,i));return i}))}get order(){return-1}get id(){return ge.RENDERER_MANAGER}};Ne=he([oe(),le(0,ue(ce.Renderers)),de("design:paramtypes",[Array])],Ne);var Be=Ne;function Oe(t){return new Worker((t||"")+"RecorderWorker.js")}let De=class{constructor(t){this.worker=null,this.node=null,this.context=null,this.config={bufferLen:4096,sampleRate:44100,numChannels:2,mimeType:"audio/wav",workletBasePath:"worklets/",workerBasePath:"workers/",bitrate:ge.DEFAULT_MP3_BITRATE,callback:()=>{}},this.callbacks={getBuffer:[],exportWAV:[],exportMP3:[]},this.recording=!1,Object.assign(this.config,t)}setup(t){return fe(this,void 0,void 0,(function*(){this.node&&(this.node instanceof AudioWorkletNode&&this.node.port.postMessage("stop"),this.node.disconnect()),t&&(this.context=t.context,yield this.createRecorderNode(),this.node&&this.context&&(t.connect(this.node),this.node.connect(this.context.destination))),this.context&&!this.worker&&(this.worker=Oe(this.config.workerBasePath),this.worker&&(this.worker.postMessage({command:"init",config:{sampleRate:this.context.sampleRate,numChannels:this.config.numChannels,bitrate:this.config.bitrate}}),this.worker.onmessage=t=>{let e=null;switch(t.data.command){case"getBuffer":e=this.callbacks.getBuffer;break;case ge.EXPORT_WAV_COMMAND:e=this.callbacks.exportWAV;break;case ge.EXPORT_MP3_COMMAND:e=this.callbacks.exportMP3}if(e){const i=e.pop();"function"==typeof i&&i(t.data.data)}}))}))}createRecorderNode(){return fe(this,void 0,void 0,(function*(){if(this.context)if(Ae.isAudioWorkletCompatible(this.context)&&ge.ENABLE_RECORDER_AUDIO_WORKLET)try{yield this.createRecorderWorklet()}catch(t){this.createRecorderScriptProcessorNode()}else this.createRecorderScriptProcessorNode()}))}createRecorderWorklet(){return fe(this,void 0,void 0,(function*(){if(this.context&&(yield this.context.audioWorklet.addModule(this.config.workletBasePath+ge.WORKLET_PATHS.RECORDER_WORKLET),this.node=new AudioWorkletNode(this.context,ge.WORKLET_NAMES.RECORDER_WORKLET),this.node&&this.node.port)){const t=this.node.parameters.get("numChannels");t&&(t.value=this.config.numChannels,t.setValueAtTime(this.config.numChannels,0)),this.node.port.onmessage=t=>{this.worker&&"record"==t.data.command&&t.data.buffer.length>0&&this.worker.postMessage({command:"record",buffer:t.data.buffer})}}}))}createRecorderScriptProcessorNode(){this.context&&(this.node=this.context.createScriptProcessor.call(this.context,this.config.bufferLen,this.config.numChannels,this.config.numChannels),this.node.onaudioprocess=t=>{if(!this.recording)return;const e=[];for(let i=0;i<this.config.numChannels;i++)e.push(t.inputBuffer.getChannelData(i));this.worker&&this.worker.postMessage({command:"record",buffer:e})})}record(){this.recording=!0,this.node instanceof AudioWorkletNode&&this.node.port.postMessage("record")}stop(){this.recording=!1,this.node instanceof AudioWorkletNode&&this.node.port.postMessage("stop")}clear(){this.worker&&this.worker.postMessage({command:"clear"})}kill(){this.clear(),this.stop(),this.worker&&this.worker.terminate()}getBuffer(t){if(!(t=t||this.config.callback))throw new Error("Callback not set");this.callbacks.getBuffer.push(t),this.worker&&this.worker.postMessage({command:"getBuffer"})}exportWAV(t,e){if(e=e||this.config.mimeType,!(t=t||this.config.callback))throw new Error("Callback not set");this.callbacks.exportWAV.push(t),this.worker&&this.worker.postMessage({command:ge.EXPORT_WAV_COMMAND,type:e})}exportMP3(t,e){if(e=e||this.config.mimeType,!(t=t||this.config.callback))throw new Error("Callback not set");this.callbacks.exportMP3.push(t),this.worker&&this.worker.postMessage({command:ge.EXPORT_MP3_COMMAND,type:e})}};De=he([oe(),de("design:paramtypes",[Object])],De);var xe=De;let Fe=class extends be{constructor(t,e,i){super(),this._savingBuffer=!1,this.playingStoppedCallback=null,this.contextManager=e,this.bufferPlayer=i,this.filterManager=t,this.setup()}setup(){this.bufferPlayer&&this.bufferPlayer.on(exports.EventType.PLAYING_FINISHED,(()=>{this._savingBuffer&&this.playingStoppedCallback&&this.eventEmitter&&this.eventEmitter.off(exports.EventType.PLAYING_STOPPED,this.playingStoppedCallback)}))}saveBuffer(t,e,i){return fe(this,void 0,void 0,(function*(){if(this._savingBuffer)throw new Error("The buffer is currently saving");if(!this.bufferPlayer)throw new Error("No buffer player was found");this._savingBuffer=!0;let r=!1;return r=this.bufferPlayer.compatibilityMode?yield this.saveBufferCompatibilityMode(e,i):yield this.saveBufferDirect(t,e),this._savingBuffer=!1,r}))}saveBufferDirect(t,e){return new Promise(((i,r)=>{var n;if(!t||this.contextManager&&!this.contextManager.currentContext)return r("No rendered buffer or AudioContext not initialized");const o=Oe(null===(n=this.configService)||void 0===n?void 0:n.getWorkerBasePath());if(o){const r=[];for(let e=0;e<t.numberOfChannels;e++)r.push(t.getChannelData(e));o.onmessage=t=>{t.data.command!=ge.EXPORT_WAV_COMMAND&&t.data.command!=ge.EXPORT_MP3_COMMAND||this.downloadAudioBlob(t.data.data,e),o.terminate(),this._savingBuffer=!1,i(!0)},o.postMessage({command:ge.INIT_COMMAND,config:{sampleRate:t.sampleRate,numChannels:2,bitrate:(null==e?void 0:e.bitrate)||ge.DEFAULT_MP3_BITRATE}}),o.postMessage({command:ge.RECORD_COMMAND,buffer:r}),o.postMessage({command:"mp3"===(null==e?void 0:e.format)||"mp3"===ge.DEFAULT_SAVE_FORMAT?ge.EXPORT_MP3_COMMAND:ge.EXPORT_WAV_COMMAND,type:ge.AUDIO_WAV})}}))}saveBufferCompatibilityMode(t,e){return new Promise(((i,r)=>{if(!this.bufferPlayer)return r("No buffer player found");this.bufferPlayer.start().then((()=>{if(!this.configService)return r("No config service found");if(!this.filterManager)return r("No filter manager found");if(!this.filterManager.currentNodes)return r("No current nodes found");const n=e||new De({bufferLen:this.configService.getBufferSize(),sampleRate:this.configService.getSampleRate(),numChannels:2,workletBasePath:this.configService.getWorkletBasePath(),workerBasePath:this.configService.getWorkerBasePath(),mimeType:"mp3"==(null==t?void 0:t.format)?ge.AUDIO_MP3:ge.AUDIO_WAV,bitrate:(null==t?void 0:t.bitrate)||ge.DEFAULT_MP3_BITRATE});n.setup(this.filterManager.currentNodes.output).then((()=>{n.record(),this.playingStoppedCallback=()=>{n.kill(),this._savingBuffer=!1,this.eventEmitter&&(this.eventEmitter.off(exports.EventType.PLAYING_FINISHED,e),this.playingStoppedCallback&&this.eventEmitter.off(exports.EventType.PLAYING_STOPPED,this.playingStoppedCallback)),i(!0)};const e=()=>{this.playingStoppedCallback&&this.eventEmitter&&this.eventEmitter.off(exports.EventType.PLAYING_STOPPED,this.playingStoppedCallback),n.stop();const r=r=>{this.downloadAudioBlob(r,t),this._savingBuffer=!1,this.eventEmitter&&this.eventEmitter.off(exports.EventType.PLAYING_FINISHED,e),n.kill(),i(!0)};"mp3"===(null==t?void 0:t.format)||"mp3"===ge.DEFAULT_SAVE_FORMAT?n.exportMP3(r):n.exportWAV(r)};this.eventEmitter&&(this.eventEmitter.on(exports.EventType.PLAYING_FINISHED,e),this.eventEmitter.on(exports.EventType.PLAYING_STOPPED,this.playingStoppedCallback))}))}))}))}downloadAudioBlob(t,e){Ae.forceDownload(t,"audio-"+(new Date).toISOString()+"."+((null==e?void 0:e.format)||ge.DEFAULT_SAVE_FORMAT))}get savingBuffer(){return this._savingBuffer}get order(){return-1}get id(){return ge.SAVE_BUFFER_MANAGER}};Fe=he([oe(),le(0,ae(ce.FilterManager)),le(1,ae(ce.AudioContextManager)),le(2,ae(ce.BufferPlayer)),de("design:paramtypes",[Object,Object,Object])],Fe);var ke=Fe;let Le=class extends be{constructor(t){super(),this.buffer=null,this.source=null,this.currentTime=0,this.displayTime=0,this.duration=0,this.intervals=[],this.playing=!1,this.loop=!1,this.loopAll=!1,this.speedAudio=1,this.onBeforePlayingCallback=()=>fe(this,void 0,void 0,(function*(){})),this.compatibilityMode=!1,this.currentNode=null,this._contextManager=t}init(t){this.playing=!1,this._contextManager&&this._contextManager.currentContext&&(this._contextManager.currentContext.resume(),!this.compatibilityMode&&this.buffer&&(null==this.source||t||this.source.disconnect(),this.source=this._contextManager.currentContext.createBufferSource(),this.source.buffer=this.buffer,this.duration=this.buffer.duration*this.speedAudio,this.source.connect(this._contextManager.currentContext.destination))),this.updateInfos()}loadBuffer(t){this.compatibilityMode=!1,this.reset(),this.buffer=t,this.init()}setCompatibilityMode(t,e){this.compatibilityMode=!0,this.reset(),this.init(),null!=e&&(this.duration=e*this.speedAudio),this.currentNode=t,this.updateInfos()}reset(t){this.clearIntervals(),this.currentTime=0,this.displayTime=0,t||this.stop()}stop(){var t;this.clearIntervals(),null!=this.source&&null!=this.source&&this.playing&&(this.source.stop(0),this.playing=!1),this.currentNode&&(this.currentNode.disconnect(),this.compatibilityMode&&(this.currentTime=0,this.displayTime=0)),null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.PLAYING_STOPPED),this.updateInfos()}clearIntervals(){for(const t of this.intervals)clearInterval(t);this.intervals=[]}start(t){return fe(this,void 0,void 0,(function*(){var e;if(this.source||this.compatibilityMode){if(t||this.stop(),this.init(t),yield this.onBeforePlayingCallback(),null===(e=this.eventEmitter)||void 0===e||e.emit(exports.EventType.PLAYING_STARTED),this.compatibilityMode){if(!(this.currentNode&&this._contextManager&&this._contextManager.currentContext))return;this.currentNode.connect(this._contextManager.currentContext.destination)}else{if(!this.source)return;this.source.start(0,t?0:this.currentTime/this.speedAudio),this.playing=!0}let i=performance.now();this.intervals.push(window.setInterval((()=>{var e,r,n;const o=performance.now(),s=o-i;i=o,this.currentTime+=s/1e3*this.speedAudio,this.displayTime=this.currentTime,this.currentTime>this.duration?this.loop?this.compatibilityMode?null===(e=this.eventEmitter)||void 0===e||e.emit(exports.EventType.PLAYING_FINISHED):(this.reset(t),this.start()):(null===(r=this.eventEmitter)||void 0===r||r.emit(exports.EventType.PLAYING_FINISHED),this.reset(t),this.loopAll&&(null===(n=this.eventEmitter)||void 0===n||n.emit(exports.EventType.PLAYING_FINISHED_LOOP_ALL))):this.updateInfos()}),100))}}))}playDirect(){return fe(this,void 0,void 0,(function*(){this.compatibilityMode?this.start(!1):this.start(!0)}))}pause(){this.stop()}updateInfos(){var t;null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.PLAYING_UPDATE)}setTimePercent(t){this.compatibilityMode||(this.currentTime=Math.round(this.duration*(t/100)),this.displayTime=this.currentTime,this.playing?(this.pause(),this.start()):this.updateInfos())}setTime(t){this.compatibilityMode||(this.currentTime=t,this.displayTime=this.currentTime,this.playing?(this.pause(),this.start()):this.updateInfos())}onBeforePlaying(t){this.onBeforePlayingCallback=t}toggleLoop(){this.loopAll=!1,this.loop=!this.loop}toggleLoopAll(){this.loop=!1,this.loopAll=!this.loopAll}on(t,e){this.eventEmitter&&this.eventEmitter.on(t,e)}get currentTimeDisplay(){return("0"+Math.trunc(this.displayTime/60)).slice(-2)+":"+("0"+Math.trunc(this.displayTime%60)).slice(-2)}get maxTimeDisplay(){return("0"+Math.trunc(this.duration/60)).slice(-2)+":"+("0"+Math.trunc(this.duration%60)).slice(-2)}get percent(){return 100-Math.round((this.duration-this.displayTime)/this.duration*100)}get remainingTimeDisplay(){return("0"+Math.trunc((this.duration-this.displayTime)/60)).slice(-2)+":"+("0"+Math.trunc((this.duration-this.displayTime)%60)).slice(-2)}get order(){return-1}get id(){return ge.BUFFER_PLAYER}};Le=he([oe(),le(0,ae(ce.AudioContextManager)),de("design:paramtypes",[Object])],Le);var Ge=Le;let We=class{constructor(t,e,i){this.buffers=new Map,this.bufferErrors=[],this.configService=null,this.contextManager=t,this.eventEmitter=i||new me,this.configService=e}fetchBuffer(t,e){return fe(this,void 0,void 0,(function*(){var i,r,n,o;const s=(this.configService?this.configService.getSoundBasePath():"")+t;if(null==this.buffers.get(this.getKeyFromLocation(s))||e){null===(i=this.eventEmitter)||void 0===i||i.emit(exports.EventType.FETCHING_BUFFERS,s);try{const t=yield fetch(s);if(!t.ok)throw this.bufferErrors.push(s),null===(r=this.eventEmitter)||void 0===r||r.emit(exports.EventType.FETCHING_BUFFERS_ERROR,s),exports.EventType.FETCHING_BUFFERS_ERROR;{const e=yield t.arrayBuffer();if(this.contextManager&&this.contextManager.currentContext){const t=yield this.contextManager.currentContext.decodeAudioData(e);this.buffers.set(this.getKeyFromLocation(s),Ae.decodeBuffer(this.contextManager.currentContext,t))}}null===(n=this.eventEmitter)||void 0===n||n.emit(exports.EventType.FINISHED_FETCHING_BUFFERS,s)}catch(t){throw this.bufferErrors.push(s),null===(o=this.eventEmitter)||void 0===o||o.emit(exports.EventType.FETCHING_BUFFERS_ERROR,s),exports.EventType.FETCHING_BUFFERS_ERROR}}}))}fetchAllBuffers(t){return fe(this,void 0,void 0,(function*(){for(const e of t)yield this.fetchBuffer(e)}))}getAudioBuffer(t){return this.buffers.get(this.getKeyFromLocation(t))}getOrFetchAudioBuffer(t){return fe(this,void 0,void 0,(function*(){return null==this.getAudioBuffer(t)&&(yield this.fetchBuffer(t)),this.getAudioBuffer(t)}))}getDownloadedBuffersList(){return Array.from(this.buffers.keys())}getKeyFromLocation(t){return t.substring(t.lastIndexOf("/")+1)}reset(){this.buffers.clear()}};We=he([oe(),le(0,ae(ce.AudioContextManager)),le(1,ae(ce.ConfigService)),le(2,ae(ce.EventEmitter)),de("design:paramtypes",[Object,Object,Object])],We);var Ve=We;let Ue=class{constructor(t,e){this.contextManager=t,this.eventEmitter=e||new me}decodeBufferFromFile(t){return fe(this,void 0,void 0,(function*(){this.eventEmitter&&this.eventEmitter.emit(exports.EventType.DECODING_AUDIO_FILE);try{if(this.contextManager&&this.contextManager.currentContext){const e=yield Ae.loadAudioBuffer(this.contextManager.currentContext,t);return this.eventEmitter&&this.eventEmitter.emit(exports.EventType.DECODED_AUDIO_FILE),e}}catch(t){console.error(t),this.eventEmitter&&(this.eventEmitter.emit(exports.EventType.DECODED_AUDIO_FILE),this.eventEmitter.emit(exports.EventType.ERROR_DECODING_AUDIO_FILE))}return null}))}};Ue=he([oe(),le(0,ae(ce.AudioContextManager)),le(1,ae(ce.EventEmitter)),de("design:paramtypes",[Object,Object])],Ue);var je=Ue;class qe extends be{}class He extends be{constructor(){super(...arguments),this.defaultSettings=null,this._totalSamples=0}getAddingTime(){return 0}initializeDefaultSettings(){this.defaultSettings=this.getSettings()}getDefaultSettings(){return this.defaultSettings}resetSettings(){return fe(this,void 0,void 0,(function*(){if(this.defaultSettings)for(const t in this.defaultSettings)this.defaultSettings&&void 0!==this.defaultSettings[t]&&(yield this.setSetting(t,this.defaultSettings[t]))}))}isWorklet(){return!1}bufferFetcherReseted(){return fe(this,void 0,void 0,(function*(){return!1}))}set totalSamples(t){this._totalSamples=t}}class Ke{constructor(t,e){this._value=0,this._minValue=0,this._maxValue=Number.MAX_SAFE_INTEGER,this._defaultValue=0,this.context=null,this.automationRate="a-rate",this._defaultValue=void 0!==e?e:0,this._value=this._defaultValue,this.context=t}get value(){return this._value}set value(t){this._value=Math.max(this._minValue,Math.min(this._maxValue,t))}get minValue(){return this._minValue}get maxValue(){return this._maxValue}get defaultValue(){return this._defaultValue}setValueAtTime(t,e){return console.warn("setValueAtTime used with AudioParamPolyfill, is not fully compatible with standard AudioParam"),this.value=t,new Ke(this.context,t)}linearRampToValueAtTime(t,e){return console.warn("linearRampToValueAtTime used with AudioParamPolyfill, is not fully compatible with standard AudioParam"),this.value=t,new Ke(this.context,t)}exponentialRampToValueAtTime(t,e){return console.warn("exponentialRampToValueAtTime used with AudioParamPolyfill, is not fully compatible with standard AudioParam"),this.value=t,new Ke(this.context,t)}cancelAndHoldAtTime(t){throw new Error("Method not implemented.")}cancelScheduledValues(t){throw new Error("Method not implemented.")}setTargetAtTime(t,e,i){throw new Error("Method not implemented.")}setValueCurveAtTime(t,e,i){throw new Error("Method not implemented.")}}class Ye{constructor(t,e,i){this._parameters=new Map,this._port=null,this.currentContext=null,this.workletProcessor=e,this.currentContext=t,this._scriptProcessorNode=t.createScriptProcessor(i,2,2),this.setupPort(),this.setupProcessor(),this.setupWorkletScope(t)}setupPort(){const t=new MessageChannel;t.port1.onmessage=t=>{this.workletProcessor&&this.workletProcessor.port2&&this.workletProcessor.port2.postMessage(t.data)},this.workletProcessor&&this.workletProcessor.port2&&(this.workletProcessor.port2.onmessage=e=>{t.port1.postMessage(e.data)}),this._port=t.port2}setupProcessor(){if(!this._scriptProcessorNode)return;this._scriptProcessorNode.onaudioprocess=t=>{if(this.workletProcessor){const e=[Ae.convertAudioBufferToFloat32Array(t.inputBuffer)],i=[Ae.convertAudioBufferToFloat32Array(t.outputBuffer)],r=[];for(const[t,e]of this._parameters.entries())r.push([t,Ae.convertAudioParamToFloat32Array(e,1)]);const n=Object.fromEntries(r);this.workletProcessor.process(e,i,n)}};const t=this.workletProcessor.defaultParameterDescriptors;t&&t.forEach((t=>{this.currentContext&&this._parameters.set(t.name,new Ke(this.currentContext,t.defaultValue))}))}setupWorkletScope(t){"undefined"!=typeof window&&(window.sampleRate=t.sampleRate)}get port(){return this._port}get parameters(){return this._parameters}get node(){return this._scriptProcessorNode}get context(){var t;return null===(t=this._scriptProcessorNode)||void 0===t?void 0:t.context}}class ze{static registerProcessor(t,e){ze.processorsMap.set(t,e)}static getProcessor(t){const e=ze.processorsMap.get(t);return e?new e:null}}ze.processorsMap=new Map;class Xe{constructor(){this.messageChannel=null,this.messageChannel=new MessageChannel}process(t,e,i){return!0}get port(){return this.messageChannel&&this.messageChannel.port1}get port2(){return this.messageChannel&&this.messageChannel.port2}get parameters(){throw new Error("Method not implemented.")}get parameterDescriptors(){throw new Error("Method not implemented.")}get defaultParameterDescriptors(){return[]}}"undefined"==typeof window||"AudioWorkletProcessor"in window||(window.AudioWorkletProcessor=Xe,window.registerProcessor=ze.registerProcessor),"undefined"==typeof global||"AudioWorkletProcessor"in global||(global.AudioWorkletProcessor=Xe,global.registerProcessor=ze.registerProcessor);class Qe extends He{constructor(){super(...arguments),this.currentWorkletNode=null,this.fallbackToScriptProcessor=!1,this.keepCurrentNodeIfPossible=!1}initializeWorklet(t){return fe(this,void 0,void 0,(function*(){if(this.stop(),!Ae.isAudioWorkletCompatible(t))return console.error("Audio Worklets not supported on this browser. Fallback to ScriptProcessor"),void(this.fallbackToScriptProcessor=!0);const e=(this.configService?this.configService.getWorkletBasePath():"")+this.workletPath;yield t.audioWorklet.addModule(e).catch((t=>{console.error(`Error when loading Worklet (${e}) for filter ${this.id}. Fallback to ScriptProcessor. Exception:`,t),this.fallbackToScriptProcessor=!0}))}))}isAudioWorkletEnabled(){return this.configService?this.configService.isAudioWorkletEnabled():ge.ENABLE_AUDIO_WORKLET}initializeNode(t,e){if(this.isAudioWorkletEnabled()&&!this.fallbackToScriptProcessor)this.currentWorkletNode=new AudioWorkletNode(t,e);else{const i=ze.getProcessor(e);if(!i)throw new Error(`No processor registered with name ${e} for filter ${this.id} to use the fallback/polyfill for AudioWorklet. Make sure you have created the class.`);this.currentWorkletNode=new Ye(t,i,this.configService.getBufferSize())}this.currentWorkletNode&&this.currentWorkletNode.port&&(this.currentWorkletNode.port.onmessage=t=>this.receiveEvent(t))}applyCurrentSettingsToWorklet(){if(this.currentWorkletNode&&this.currentWorkletNode.parameters){const t=this.getSettings();for(const e of Object.keys(t)){const i=this.currentWorkletNode.parameters.get(e);i&&(i.value=t[e],i.setValueAtTime(t[e],0))}}}getNode(t){if(this.keepCurrentNodeIfPossible&&this.currentWorkletNode&&this.currentWorkletNode.context==t||(this.stop(),this.initializeNode(t,this.workletName)),this.applyCurrentSettingsToWorklet(),this.setEnabled(this.isEnabled()),this.currentWorkletNode)return this.currentWorkletNode instanceof Ye?{input:this.currentWorkletNode.node,output:this.currentWorkletNode.node}:{input:this.currentWorkletNode,output:this.currentWorkletNode};throw new Error("Worklet node has not yet been created")}stop(){this.currentWorkletNode&&this.currentWorkletNode.port&&(this.currentWorkletNode.port.postMessage("stop"),this.currentWorkletNode.port.onmessage=null),this.currentWorkletNode=null}setEnabled(t){this.currentWorkletNode&&this.currentWorkletNode.port&&this.currentWorkletNode.port.postMessage(t?"enable":"disable"),super.setEnabled(t)}isWorklet(){return!0}}class Ze extends AudioWorkletProcessor{constructor(){super(),this.stopped=!1,this.phaser=null,this.last=null,this.port.onmessage=t=>{"stop"==t.data&&this.stop()}}static get parameterDescriptors(){return[{name:"bits",defaultValue:16},{name:"normFreq",defaultValue:.9}]}get defaultParameterDescriptors(){return Ze.parameterDescriptors}process(t,e,i){if(this.stopped)return!1;const r=t[0],n=e[0],o=2*Math.pow(.5,i.bits[0]),s=(1-i.normFreq[0])/(sampleRate/48e3);if(null==this.last&&(this.last=new Array(r.length).fill(0)),null==this.phaser&&(this.phaser=new Array(r.length).fill(0)),r&&r[0]){const t=r[0].length;for(let e=0;e<r.length;e++){const i=r[e],a=n[e];if(i&&a)for(let r=0;r<t;r++)this.phaser[e]+=s,this.phaser[e]>=1&&(this.phaser[e]-=1,this.last[e]=o*Math.floor(i[r]*(1/o)+.5)),a[r]=this.last[e]}}return!0}stop(){this.stopped=!0,this.phaser=null,this.last=null}}registerProcessor(ge.WORKLET_NAMES.BITCRUSHER,Ze);class $e{constructor(t){this._array=new Float32Array,this.n=0,this.length=0,this.readPointer=0,this.writePointer=0,this.n=Math.floor(t),this.init()}init(){this._array=new Float32Array(2*this.n),this.length=this._array.length,this.readPointer=0,this.writePointer=this.n-1,this._array.fill(0)}read(){const t=this._array[this.readPointer%this.length];return this.readPointer=(this.readPointer+1)%this.length,t}push(t){this._array[this.writePointer%this.length]=t,this.writePointer=(this.writePointer+1)%this.length}reset(){this.init()}clear(){this._array=new Float32Array,this.length=0,this.readPointer=0,this.writePointer=0}sum(){return this._array.reduce(((t,e)=>t+e),0)}}class Je extends AudioWorkletProcessor{constructor(){super(),this.delayBuffer=[],this.envelopeSample=0,this.stopped=!1,this.disabled=!1,this.port.onmessage=t=>{"reset"==t.data?this.reset():"stop"==t.data?this.stop():"disable"==t.data?this.disabled=!0:"enable"==t.data&&(this.disabled=!1)}}static get parameterDescriptors(){return[{name:"preGain",defaultValue:0},{name:"postGain",defaultValue:0},{name:"attackTime",defaultValue:0},{name:"releaseTime",defaultValue:3},{name:"threshold",defaultValue:-.05},{name:"lookAheadTime",defaultValue:0}]}get defaultParameterDescriptors(){return Je.parameterDescriptors}getEnvelope(t,e,i,r){const n=Math.exp(-1/(r*e)),o=Math.exp(-1/(r*i)),s=new Float32Array(t.length);for(let e=0;e<t.length;e++){const i=Math.abs(t[e]);this.envelopeSample<i?this.envelopeSample=i+n*(this.envelopeSample-i):this.envelopeSample=i+o*(this.envelopeSample-i),s[e]=this.envelopeSample}return s}getMaxEnvelope(t,e,i){let r=t[0][i];for(let n=0;n<e;n++)t[n][i]>r&&(r=t[n][i]);return r}ampToDB(t){return 20*Math.log10(t)}dBToAmp(t){return Math.pow(10,t/20)}process(t,e,i){if(this.stopped)return!1;const r=t[0],n=e[0],o=[],s=this.dBToAmp(i.postGain[0]),a=this.dBToAmp(i.preGain[0]);for(let t=0;t<n.length;t++){const e=r[t],s=n[t];if(null==this.delayBuffer[t]&&(this.delayBuffer[t]=new $e(i.lookAheadTime[0]*sampleRate)),e&&s)for(let t=0;t<e.length;++t)this.disabled?s[t]=e[t]:s[t]=a*e[t];!this.disabled&&s&&(o[t]=this.getEnvelope(s,i.attackTime[0],i.releaseTime[0],sampleRate))}for(let t=0;t<n.length;t++){const e=r[t],a=n[t];if(i.lookAheadTime[0]>0&&a)for(let e=0;e<a.length;e++)this.delayBuffer[t].push(a[e]),a[e]=this.delayBuffer[t].read();if(this.disabled)continue;const u=1;if(e&&a)for(let t=0;t<e.length;t++){let e=u*(i.threshold[0]-this.ampToDB(this.getMaxEnvelope(o,n.length,t)));e=Math.min(0,e);const r=this.dBToAmp(e);a[t]*=r*s}}return!0}reset(){for(let t=0;t<this.delayBuffer.length;t++)null!=this.delayBuffer[t]&&this.delayBuffer[t].reset();this.envelopeSample=0}stop(){for(let t=0;t<this.delayBuffer.length;t++)null!=this.delayBuffer[t]&&this.delayBuffer[t].clear();this.delayBuffer=[],this.envelopeSample=0,this.stopped=!0}}registerProcessor(ge.WORKLET_NAMES.LIMITER,Je);class ti{constructor(){this._vector=new Float32Array,this._position=0,this._frameCount=0}get vector(){return this._vector}get position(){return this._position}get startIndex(){return 2*this._position}get frameCount(){return this._frameCount}get endIndex(){return 2*(this._position+this._frameCount)}clear(){this.receive(this._frameCount),this.rewind()}put(t){this._frameCount+=t}putSamples(t,e,i=0){const r=2*(e=e||0);i>=0||(i=(t.length-r)/2);const n=2*i;this.ensureCapacity(i+this._frameCount);const o=this.endIndex;this.vector.set(t.subarray(r,r+n),o),this._frameCount+=i}putBuffer(t,e,i=0){e=e||0,i>=0||(i=t.frameCount-e),this.putSamples(t.vector,t.position+e,i)}receive(t){t>=0&&!(t>this._frameCount)||(t=this.frameCount),this._frameCount-=t,this._position+=t}receiveSamples(t,e=0){const i=2*e,r=this.startIndex;t.set(this._vector.subarray(r,r+i)),this.receive(e)}extract(t,e=0,i=0){const r=this.startIndex+2*e,n=2*i;t.set(this._vector.subarray(r,r+n))}ensureCapacity(t=0){const e=parseInt(2*t);if(this._vector.length<e){const t=new Float32Array(e);t.set(this._vector.subarray(this.startIndex,this.endIndex)),this._vector=t,this._position=0}else this.rewind()}ensureAdditionalCapacity(t=0){this.ensureCapacity(this._frameCount+t)}rewind(){this._position>0&&(this._vector.set(this._vector.subarray(this.startIndex,this.endIndex)),this._position=0)}}class ei{constructor(t){t?(this._inputBuffer=new ti,this._outputBuffer=new ti):this._inputBuffer=this._outputBuffer=null}get inputBuffer(){return this._inputBuffer}set inputBuffer(t){this._inputBuffer=t}get outputBuffer(){return this._outputBuffer}set outputBuffer(t){this._outputBuffer=t}clear(){this._inputBuffer.clear(),this._outputBuffer.clear()}}class ii extends ei{constructor(t){super(t),this.reset(),this._rate=1}set rate(t){this._rate=t}reset(){this.slopeCount=0,this.prevSampleL=0,this.prevSampleR=0}clone(){const t=new ii;return t.rate=this._rate,t}process(){const t=this._inputBuffer.frameCount;this._outputBuffer.ensureAdditionalCapacity(t/this._rate+1);const e=this.transpose(t);this._inputBuffer.receive(),this._outputBuffer.put(e)}transpose(t=0){if(0===t)return 0;const e=this._inputBuffer.vector,i=this._inputBuffer.startIndex,r=this._outputBuffer.vector,n=this._outputBuffer.endIndex;let o=0,s=0;for(;this.slopeCount<1;)r[n+2*s]=(1-this.slopeCount)*this.prevSampleL+this.slopeCount*e[i],r[n+2*s+1]=(1-this.slopeCount)*this.prevSampleR+this.slopeCount*e[i+1],s+=1,this.slopeCount+=this._rate;if(this.slopeCount-=1,1!==t)t:for(;;){for(;this.slopeCount>1;)if(this.slopeCount-=1,o+=1,o>=t-1)break t;const a=i+2*o;r[n+2*s]=(1-this.slopeCount)*e[a]+this.slopeCount*e[a+2],r[n+2*s+1]=(1-this.slopeCount)*e[a+1]+this.slopeCount*e[a+3],s+=1,this.slopeCount+=this._rate}return this.prevSampleL=e[i+2*t-2],this.prevSampleR=e[i+2*t-1],s}}class ri{constructor(t){this._pipe=t}get pipe(){return this._pipe}get inputBuffer(){return this._pipe.inputBuffer}get outputBuffer(){return this._pipe.outputBuffer}fillInputBuffer(){throw new Error("fillInputBuffer() not overridden")}fillOutputBuffer(t=0){for(;this.outputBuffer.frameCount<t;){const t=16384-this.inputBuffer.frameCount;if(this.fillInputBuffer(t),this.inputBuffer.frameCount<16384)break;this._pipe.process()}}clear(){this._pipe.clear()}}const ni=function(){};class oi extends ri{constructor(t,e,i=ni){super(e),this.callback=i,this.sourceSound=t,this.historyBufferSize=22050,this._sourcePosition=0,this.outputBufferPosition=0,this._position=0}get position(){return this._position}set position(t){if(t>this._position)throw new RangeError("New position may not be greater than current position");const e=this.outputBufferPosition-(this._position-t);if(e<0)throw new RangeError("New position falls outside of history buffer");this.outputBufferPosition=e,this._position=t}get sourcePosition(){return this._sourcePosition}set sourcePosition(t){this.clear(),this._sourcePosition=t}onEnd(){this.callback()}fillInputBuffer(t=0){const e=new Float32Array(2*t),i=this.sourceSound.extract(e,t,this._sourcePosition);this._sourcePosition+=i,this.inputBuffer.putSamples(e,0,i)}extract(t,e=0){this.fillOutputBuffer(this.outputBufferPosition+e);const i=Math.min(e,this.outputBuffer.frameCount-this.outputBufferPosition);this.outputBuffer.extract(t,this.outputBufferPosition,i);const r=this.outputBufferPosition+i;return this.outputBufferPosition=Math.min(this.historyBufferSize,r),this.outputBuffer.receive(Math.max(r-this.historyBufferSize,0)),this._position+=i,i}handleSampleData(t){this.extract(t.data,4096)}clear(){super.clear(),this.outputBufferPosition=0}}const si=[[124,186,248,310,372,434,496,558,620,682,744,806,868,930,992,1054,1116,1178,1240,1302,1364,1426,1488,0],[-100,-75,-50,-25,25,50,75,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-20,-15,-10,-5,5,10,15,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-4,-3,-2,-1,1,2,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],ai=-10/1.5;class ui extends ei{constructor(t){super(t),this._quickSeek=!0,this.midBufferDirty=!1,this.midBuffer=null,this.overlapLength=0,this.autoSeqSetting=!0,this.autoSeekSetting=!0,this._tempo=1,this.setParameters(44100,0,0,8)}clear(){super.clear(),this.clearMidBuffer()}clearMidBuffer(){this.midBufferDirty&&(this.midBufferDirty=!1,this.midBuffer=null)}setParameters(t,e,i,r){t>0&&(this.sampleRate=t),r>0&&(this.overlapMs=r),e>0?(this.sequenceMs=e,this.autoSeqSetting=!1):this.autoSeqSetting=!0,i>0?(this.seekWindowMs=i,this.autoSeekSetting=!1):this.autoSeekSetting=!0,this.calculateSequenceParameters(),this.calculateOverlapLength(this.overlapMs),this.tempo=this._tempo}set tempo(t){let e;this._tempo=t,this.calculateSequenceParameters(),this.nominalSkip=this._tempo*(this.seekWindowLength-this.overlapLength),this.skipFract=0,e=Math.floor(this.nominalSkip+.5),this.sampleReq=Math.max(e+this.overlapLength,this.seekWindowLength)+this.seekLength}get tempo(){return this._tempo}get inputChunkSize(){return this.sampleReq}get outputChunkSize(){return this.overlapLength+Math.max(0,this.seekWindowLength-2*this.overlapLength)}calculateOverlapLength(t=0){let e;e=this.sampleRate*t/1e3,e=e<16?16:e,e-=e%8,this.overlapLength=e,this.refMidBuffer=new Float32Array(2*this.overlapLength),this.midBuffer=new Float32Array(2*this.overlapLength)}checkLimits(t,e,i){return t<e?e:t>i?i:t}calculateSequenceParameters(){let t,e;this.autoSeqSetting&&(t=150+-50*this._tempo,t=this.checkLimits(t,50,125),this.sequenceMs=Math.floor(t+.5)),this.autoSeekSetting&&(e=28.333333333333332+ai*this._tempo,e=this.checkLimits(e,15,25),this.seekWindowMs=Math.floor(e+.5)),this.seekWindowLength=Math.floor(this.sampleRate*this.sequenceMs/1e3),this.seekLength=Math.floor(this.sampleRate*this.seekWindowMs/1e3)}set quickSeek(t){this._quickSeek=t}clone(){const t=new ui;return t.tempo=this._tempo,t.setParameters(this.sampleRate,this.sequenceMs,this.seekWindowMs,this.overlapMs),t}seekBestOverlapPosition(){return this._quickSeek?this.seekBestOverlapPositionStereoQuick():this.seekBestOverlapPositionStereo()}seekBestOverlapPositionStereo(){let t,e,i,r=0;for(this.preCalculateCorrelationReferenceStereo(),t=0,e=Number.MIN_VALUE;r<this.seekLength;r+=1)i=this.calculateCrossCorrelationStereo(2*r,this.refMidBuffer),i>e&&(e=i,t=r);return t}seekBestOverlapPositionStereoQuick(){let t,e,i,r,n,o=0;for(this.preCalculateCorrelationReferenceStereo(),e=Number.MIN_VALUE,t=0,r=0,n=0;o<4;o+=1){let s=0;for(;si[o][s]&&(n=r+si[o][s],!(n>=this.seekLength));)i=this.calculateCrossCorrelationStereo(2*n,this.refMidBuffer),i>e&&(e=i,t=n),s+=1;r=t}return t}preCalculateCorrelationReferenceStereo(){let t,e,i=0;for(;i<this.overlapLength;i+=1)e=i*(this.overlapLength-i),t=2*i,this.refMidBuffer[t]=this.midBuffer[t]*e,this.refMidBuffer[t+1]=this.midBuffer[t+1]*e}calculateCrossCorrelationStereo(t,e){const i=this._inputBuffer.vector;t+=this._inputBuffer.startIndex;let r=0,n=2;const o=2*this.overlapLength;let s;for(;n<o;n+=2)s=n+t,r+=i[s]*e[n]+i[s+1]*e[n+1];return r}overlap(t){this.overlapStereo(2*t)}overlapStereo(t){const e=this._inputBuffer.vector;t+=this._inputBuffer.startIndex;const i=this._outputBuffer.vector,r=this._outputBuffer.endIndex;let n,o,s=0;const a=1/this.overlapLength;let u,c,h;for(;s<this.overlapLength;s+=1)o=(this.overlapLength-s)*a,u=s*a,n=2*s,c=n+t,h=n+r,i[h+0]=e[c+0]*u+this.midBuffer[n+0]*o,i[h+1]=e[c+1]*u+this.midBuffer[n+1]*o}process(){let t,e,i;if(null===this.midBuffer){if(this._inputBuffer.frameCount<this.overlapLength)return;this.midBuffer=new Float32Array(2*this.overlapLength),this._inputBuffer.receiveSamples(this.midBuffer,this.overlapLength)}for(;this._inputBuffer.frameCount>=this.sampleReq;){t=this.seekBestOverlapPosition(),this._outputBuffer.ensureAdditionalCapacity(this.overlapLength),this.overlap(Math.floor(t)),this._outputBuffer.put(this.overlapLength),e=this.seekWindowLength-2*this.overlapLength,e>0&&this._outputBuffer.putBuffer(this._inputBuffer,t+this.overlapLength,e);const r=this._inputBuffer.startIndex+2*(t+this.seekWindowLength-this.overlapLength);this.midBuffer.set(this._inputBuffer.vector.subarray(r,r+2*this.overlapLength)),this.skipFract+=this.nominalSkip,i=Math.floor(this.skipFract),this.skipFract-=i,this._inputBuffer.receive(i)}}}const ci=function(t,e){return(t>e?t-e:e-t)>1e-10};class hi{constructor(){this.transposer=new ii(!1),this.stretch=new ui(!1),this._inputBuffer=new ti,this._intermediateBuffer=new ti,this._outputBuffer=new ti,this._rate=0,this._tempo=0,this.virtualPitch=1,this.virtualRate=1,this.virtualTempo=1,this.calculateEffectiveRateAndTempo()}clear(){this.transposer.clear(),this.stretch.clear()}clone(){const t=new hi;return t.rate=this.rate,t.tempo=this.tempo,t}get rate(){return this._rate}set rate(t){this.virtualRate=t,this.calculateEffectiveRateAndTempo()}set rateChange(t){this._rate=1+.01*t}get tempo(){return this._tempo}set tempo(t){this.virtualTempo=t,this.calculateEffectiveRateAndTempo()}set tempoChange(t){this.tempo=1+.01*t}set pitch(t){this.virtualPitch=t,this.calculateEffectiveRateAndTempo()}set pitchOctaves(t){this.pitch=Math.exp(.69314718056*t),this.calculateEffectiveRateAndTempo()}set pitchSemitones(t){this.pitchOctaves=t/12}get inputBuffer(){return this._inputBuffer}get outputBuffer(){return this._outputBuffer}calculateEffectiveRateAndTempo(){const t=this._tempo,e=this._rate;this._tempo=this.virtualTempo/this.virtualPitch,this._rate=this.virtualRate*this.virtualPitch,ci(this._tempo,t)&&(this.stretch.tempo=this._tempo),ci(this._rate,e)&&(this.transposer.rate=this._rate),this._rate>1?this._outputBuffer!=this.transposer.outputBuffer&&(this.stretch.inputBuffer=this._inputBuffer,this.stretch.outputBuffer=this._intermediateBuffer,this.transposer.inputBuffer=this._intermediateBuffer,this.transposer.outputBuffer=this._outputBuffer):this._outputBuffer!=this.stretch.outputBuffer&&(this.transposer.inputBuffer=this._inputBuffer,this.transposer.outputBuffer=this._intermediateBuffer,this.stretch.inputBuffer=this._intermediateBuffer,this.stretch.outputBuffer=this._outputBuffer)}process(){this._rate>1?(this.stretch.process(),this.transposer.process()):(this.transposer.process(),this.stretch.process())}}class li{constructor(t){this.buffer=t,this._position=0}get dualChannel(){return this.buffer.numberOfChannels>1}get position(){return this._position}set position(t){this._position=t}extract(t,e=0,i=0){this.position=i;let r=this.buffer.getChannelData(0),n=this.dualChannel?this.buffer.getChannelData(1):this.buffer.getChannelData(0),o=0;for(;o<e;o++)t[2*o]=r[o+i],t[2*o+1]=n[o+i];return Math.min(e,r.length-i)}}const di=function(t){const e=Math.floor(t/60);return`${e}:${i=parseInt(t-60*e),r=2,n=n||"0",(i+="").length>=r?i:new Array(r-i.length+1).join(n)+i}`;var i,r,n},fi=function(t){const e=this.timePlayed,i=this.sampleRate;if(this.sourcePosition=t,this.timePlayed=t/i,e!==this.timePlayed){const t=new CustomEvent("play",{detail:{timePlayed:this.timePlayed,formattedTimePlayed:this.formattedTimePlayed,percentagePlayed:this.percentagePlayed}});this._node.dispatchEvent(t)}};class pi{constructor(t,e,i,r=ni){this._soundtouch=new hi;const n=new li(e);this.timePlayed=0,this.sourcePosition=0,this._filter=new oi(n,this._soundtouch,r),this._node=function(t,e,i=ni,r=4096){const n=t.createScriptProcessor(r,2,2),o=new Float32Array(2*r);return n.onaudioprocess=t=>{let n=t.outputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(1),a=e.extract(o,r);i(e.sourcePosition),0===a&&e.onEnd();let u=0;for(;u<a;u++)n[u]=o[2*u],s[u]=o[2*u+1]},n}(t,this._filter,(t=>fi.call(this,t)),i),this.tempo=1,this.rate=1,this.duration=e.duration,this.sampleRate=t.sampleRate,this.listeners=[]}get formattedDuration(){return di(this.duration)}get formattedTimePlayed(){return di(this.timePlayed)}get percentagePlayed(){return 100*this._filter.sourcePosition/(this.duration*this.sampleRate)}set percentagePlayed(t){this._filter.sourcePosition=parseInt(t*this.duration*this.sampleRate),this.sourcePosition=this._filter.sourcePosition,this.timePlayed=this.sourcePosition/this.sampleRate}get node(){return this._node}set pitch(t){this._soundtouch.pitch=t}set pitchSemitones(t){this._soundtouch.pitchSemitones=t}set rate(t){this._soundtouch.rate=t}set tempo(t){this._soundtouch.tempo=t}connect(t){this._node.connect(t)}disconnect(){this._node.disconnect()}on(t,e){this.listeners.push({name:t,cb:e}),this._node.addEventListener(t,(t=>e(t.detail)))}off(t=null){let e=this.listeners;t&&(e=e.filter((e=>e.name===t))),e.forEach((t=>{this._node.removeEventListener(t.name,(e=>t.cb(e.detail)))}))}}let gi;"undefined"!=typeof window&&void 0!==window.AudioWorkletNode&&(gi=class extends AudioWorkletNode{constructor(t,e,i){super(t,e,i),this.name="",this.running=!1,this._tempo=1,this._pitch=1,this.name=this.constructor.name,this.running=!0,this.updateInterval=i.processorOptions.updateInterval}setup(t,e){return fe(this,void 0,void 0,(function*(){return new Promise((i=>{this.port&&(this.port.onmessage=t=>{t&&t.data&&"OK"===t.data.status&&"setup"===t.data.args[0]&&(this.port.onmessage=this.messageProcessor.bind(this),i())},this.port.postMessage({command:"setup",args:[t,e]}),this._tempo=t,this._pitch=e)}))}))}set updateInterval(t){this.port.postMessage({command:"updateInterval",args:[t]})}get node(){return this}set tempo(t){this.port.postMessage({command:"setTempo",args:[t]})}set pitch(t){this.port.postMessage({command:"setPitch",args:[t]})}get tempo(){return this.port.postMessage({command:"getTempo",args:[]}),this._tempo}get pitch(){return this.port.postMessage({command:"getPitch",args:[]}),this._pitch}stop(){return fe(this,void 0,void 0,(function*(){this.running&&(this.port.postMessage({command:"stop",args:[]}),this.disconnect(),this.running=!1)}))}messageProcessor(t){if(t.data.command){const{command:e}=t.data;if("End"===e)this.stop();if(t.data.status){const e=t.data.args[1];switch(t.data.args[0]){case"getTempo":this._tempo=e;break;case"getPitch":this._pitch=e}return}}}});var vi=gi;class mi{constructor(t,e,i){this.FILTER_QUALITY=6,this.FOURIER_SIZE=4096,this.WAVETABLEBOOST=40,this.SAWTOOTHBOOST=.4,this.oscillatorType=4,this.oscillatorDetuneValue=0,this.audioContext=null,this.carrierBuffer=null,this.modulatorNode=null,this.vocoding=!1,this.modulatorInput=null,this.carrierInput=null,this.modulatorGain=null,this.modulatorGainValue=1,this.noiseBuffer=null,this.noiseNode=null,this.noiseGain=null,this.noiseGainValue=.2,this.carrierSampleNode=null,this.carrierSampleGain=null,this.carrierSampleGainValue=0,this.oscillatorNode=null,this.oscillatorGain=null,this.oscillatorGainValue=1,this.wavetable=null,this.wavetableSignalGain=null,this.modFilterBands=null,this.modFilterPostGains=null,this.heterodynes=null,this.powers=null,this.lpFilters=null,this.lpFilterPostGains=null,this.carrierBands=null,this.carrierFilterPostGains=null,this.carrierBandGains=null,this.vocoderBands=null,this.numVocoderBands=0,this.hpFilterGain=null,this.outputGain=null,this.audioContext=t,this.carrierBuffer=e,this.modulatorBuffer=i}init(){this.generateVocoderBands(55,7040,28),this.setupVocoderGraph(),this.vocode()}getNodes(){return{modulatorNode:this.modulatorNode,modulatorGain:this.modulatorGain,synthLevel:this.oscillatorGain,noiseNode:this.noiseGain,oscillatorNode:this.oscillatorNode,hpFilterGain:this.hpFilterGain,outputGain:this.outputGain}}shutOffCarrier(){this.oscillatorNode&&this.noiseNode&&this.carrierSampleNode&&(this.oscillatorNode.stop(0),this.oscillatorNode=null,this.noiseNode.stop(0),this.noiseNode=null,this.carrierSampleNode.stop(0),this.carrierSampleNode=null)}selectSawtooth(){this.wavetableSignalGain&&(this.wavetableSignalGain.gain.value=this.SAWTOOTHBOOST),this.oscillatorNode&&(this.oscillatorNode.type="sawtooth")}selectWavetable(){this.wavetableSignalGain&&(this.wavetableSignalGain.gain.value=this.WAVETABLEBOOST),this.oscillatorNode&&this.wavetable&&this.oscillatorNode.setPeriodicWave(this.wavetable),this.wavetableSignalGain&&(this.wavetableSignalGain.gain.value=this.WAVETABLEBOOST)}updateModGain(t){this.modulatorGainValue=t,this.modulatorGain&&(this.modulatorGain.gain.value=t)}updateSampleLevel(t){this.carrierSampleGainValue=t,this.carrierSampleGain&&(this.carrierSampleGain.gain.value=t)}updateSynthLevel(t){this.oscillatorGainValue=t,this.oscillatorGain&&(this.oscillatorGain.gain.value=t)}updateNoiseLevel(t){this.noiseGainValue=t,this.noiseGain&&(this.noiseGain.gain.value=t)}updateDetuneValue(t){this.oscillatorDetuneValue=t,this.oscillatorNode&&(this.oscillatorNode.detune.value=t)}generateVocoderBands(t,e,i){const r=1200*Math.log(e/t)/Math.LN2/i,n=Math.pow(2,r/1200);this.vocoderBands=[];let o=t;for(let t=0;t<i;t++)this.vocoderBands[t]={frequency:o},o*=n;this.numVocoderBands=i}loadNoiseBuffer(){if(!this.audioContext)return;const t=5*this.audioContext.sampleRate;this.noiseBuffer=this.audioContext.createBuffer(1,t,this.audioContext.sampleRate);const e=this.noiseBuffer.getChannelData(0);for(let i=0;i<t;++i)e[i]=2*Math.random()-1}initBandpassFilters(){if(!this.audioContext)return;this.modulatorInput=this.audioContext.createGain(),this.carrierInput=this.audioContext.createGain(),null==this.modFilterBands&&(this.modFilterBands=[]),null==this.modFilterPostGains&&(this.modFilterPostGains=[]),null==this.heterodynes&&(this.heterodynes=[]),null==this.powers&&(this.powers=[]),null==this.lpFilters&&(this.lpFilters=[]),null==this.lpFilterPostGains&&(this.lpFilterPostGains=[]),null==this.carrierBands&&(this.carrierBands=[]),null==this.carrierFilterPostGains&&(this.carrierFilterPostGains=[]),null==this.carrierBandGains&&(this.carrierBandGains=[]);const t=new Float32Array(65536),e=32768;let i;for(let r=0;r<e;++r)i=r/e,t[e+r]=i,t[e-r-1]=i;const r=this.audioContext.createBiquadFilter();r.type="highpass",r.frequency.value=8e3,r.Q.value=1,this.modulatorInput.connect(r),this.hpFilterGain=this.audioContext.createGain(),this.hpFilterGain.gain.value=0,r.connect(this.hpFilterGain),this.modulatorBuffer&&this.hpFilterGain.connect(this.audioContext.destination),this.modFilterBands.length=0,this.modFilterPostGains.length=0,this.heterodynes.length=0,this.powers.length=0,this.lpFilters.length=0,this.lpFilterPostGains.length=0,this.carrierBands.length=0,this.carrierFilterPostGains.length=0,this.carrierBandGains.length=0,this.outputGain=this.audioContext.createGain(),this.modulatorBuffer&&this.outputGain.connect(this.audioContext.destination);const n=new Float32Array(65536);for(let t=-32768;t<32768;t++)n[t+32768]=(t>0?t:-t)/32768;for(let e=0;e<this.numVocoderBands;e++){const i=this.audioContext.createBiquadFilter();i.type="bandpass",this.vocoderBands&&(i.frequency.value=this.vocoderBands[e].frequency),i.Q.value=this.FILTER_QUALITY,this.modulatorInput.connect(i),this.modFilterBands.push(i);const r=this.audioContext.createBiquadFilter();r.type="bandpass",this.vocoderBands&&(r.frequency.value=this.vocoderBands[e].frequency),r.Q.value=this.FILTER_QUALITY,i.connect(r);const o=this.audioContext.createGain();o.gain.value=6,r.connect(o),this.modFilterPostGains.push(o);const s=this.audioContext.createOscillator();this.vocoderBands&&(s.frequency.value=this.vocoderBands[e].frequency),s.start(0);const a=this.audioContext.createGain();o.connect(a),a.gain.value=0,s.connect(a.gain);const u=this.audioContext.createGain();u.gain.value=2,a.connect(u),this.heterodynes.push(u);const c=this.audioContext.createWaveShaper();c.curve=n,u.connect(c);const h=this.audioContext.createBiquadFilter();h.type="lowpass",h.frequency.value=5,h.Q.value=1,this.lpFilters.push(h),c.connect(h);const l=this.audioContext.createGain();l.gain.value=1,h.connect(l),this.lpFilterPostGains.push(l);const d=this.audioContext.createWaveShaper();d.curve=t,l.connect(d);const f=this.audioContext.createBiquadFilter();f.type="bandpass",this.vocoderBands&&(f.frequency.value=this.vocoderBands[e].frequency),f.Q.value=this.FILTER_QUALITY,this.carrierBands.push(f),this.carrierInput.connect(f);const p=this.audioContext.createBiquadFilter();p.type="bandpass",this.vocoderBands&&(p.frequency.value=this.vocoderBands[e].frequency),p.Q.value=this.FILTER_QUALITY,f.connect(p);const g=this.audioContext.createGain();g.gain.value=10,p.connect(g),this.carrierFilterPostGains.push(g);const v=this.audioContext.createGain();this.carrierBandGains.push(v),g.connect(v),v.gain.value=0,d.connect(v.gain),v.connect(this.outputGain)}const o=new Float32Array(this.FOURIER_SIZE),s=new Float32Array(this.FOURIER_SIZE);o[0]=0,s[0]=0;for(let t=1;t<this.FOURIER_SIZE;t++)o[t]=1,s[t]=1;this.wavetable=this.audioContext.createPeriodicWave(o,s),this.loadNoiseBuffer()}setupVocoderGraph(){this.initBandpassFilters()}createCarriersAndPlay(t){this.audioContext&&t&&(this.carrierSampleNode=this.audioContext.createBufferSource(),this.carrierSampleNode.buffer=this.carrierBuffer,this.carrierSampleNode.loop=!0,this.carrierSampleGain=this.audioContext.createGain(),this.carrierSampleGain.gain.value=this.carrierSampleGainValue,this.carrierSampleNode.connect(this.carrierSampleGain),this.carrierSampleGain.connect(t),this.wavetableSignalGain=this.audioContext.createGain(),this.oscillatorNode=this.audioContext.createOscillator(),4==this.oscillatorType&&this.wavetable?(this.oscillatorNode.setPeriodicWave(this.wavetable),this.wavetableSignalGain.gain.value=this.WAVETABLEBOOST):this.wavetableSignalGain.gain.value=this.SAWTOOTHBOOST,this.oscillatorNode.frequency.value=110,this.oscillatorNode.detune.value=this.oscillatorDetuneValue,this.oscillatorNode.connect(this.wavetableSignalGain),this.oscillatorGain=this.audioContext.createGain(),this.oscillatorGain.gain.value=this.oscillatorGainValue,this.wavetableSignalGain.connect(this.oscillatorGain),this.oscillatorGain.connect(t),this.noiseNode=this.audioContext.createBufferSource(),this.noiseNode.buffer=this.noiseBuffer,this.noiseNode.loop=!0,this.noiseGain=this.audioContext.createGain(),this.noiseGain.gain.value=this.noiseGainValue,this.noiseNode.connect(this.noiseGain),this.noiseGain.connect(t),this.oscillatorNode.start(0),this.noiseNode.start(0),this.carrierSampleNode.start(0))}vocode(){if(this.audioContext){if(this.vocoding)return this.modulatorNode&&this.modulatorNode.stop(0),this.shutOffCarrier(),void(this.vocoding=!1);this.createCarriersAndPlay(this.carrierInput),this.vocoding=!0,this.modulatorGain=this.audioContext.createGain(),this.modulatorGain.gain.value=this.modulatorGainValue,this.modulatorBuffer&&(this.modulatorNode=this.audioContext.createBufferSource(),this.modulatorNode.buffer=this.modulatorBuffer,this.modulatorNode.connect(this.modulatorGain),this.modulatorNode.start(0)),this.modulatorInput&&this.modulatorGain.connect(this.modulatorInput)}}}class yi extends AudioWorkletProcessor{constructor(){super(),this.stopped=!1,this.samplesCount=0,this.port.onmessage=t=>{"stop"==t.data&&this.stop()}}static get parameterDescriptors(){return[]}get defaultParameterDescriptors(){return yi.parameterDescriptors}process(t,e){if(this.stopped)return!1;const i=t[0],r=e[0];if(i&&i[0]&&(this.samplesCount+=i[0].length),r){for(let t=0;t<r.length;t++){const e=i[t],n=r[t];if(e)for(let t=0;t<e.length;t++)n[t]=e[t]}this.port.postMessage({command:"update",samplesCount:this.samplesCount})}return!0}stop(){this.stopped=!0}}registerProcessor(ge.WORKLET_NAMES.PASSTHROUGH,yi);class Ei{constructor(t,e){this.seconds=0,this.initialSeconds=0,this.interval=null,this.incr=1,this.countCallback=()=>{},this.seconds=t,this.initialSeconds=t,this.interval,this.incr=e}start(){this.interval=window.setInterval((()=>this.count()),1e3)}stop(){clearInterval(this.interval)}count(){this.seconds+=this.incr,this.seconds<=0&&this.stop(),this.countCallback&&this.countCallback()}onCount(t){this.countCallback=t}}let _i=class extends be{constructor(t,e){super(),this.recorder=null,this.input=null,this.stream=null,this.alreadyInit=!1,this.timer=null,this.enableAudioFeedback=!1,this.recording=!1,this.deviceList=[],this.constraints={audio:{noiseSuppression:!0,echoCancellation:!0,autoGainControl:!0,sampleRate:{ideal:44100}}},this.sampleRateConfigNotSupported=!1,this.contextManager=t,this.configService=e}init(){return fe(this,void 0,void 0,(function*(){var t;if(this.isRecordingAvailable()){this.sampleRateConfigNotSupported=!navigator.mediaDevices.getSupportedConstraints().sampleRate,this.contextManager&&(this.sampleRateConfigNotSupported?this.contextManager.createNewContext(0):this.contextManager.createNewContextIfNeeded()),null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_INIT);try{const t=yield navigator.mediaDevices.getUserMedia(this.constraints);this.contextManager&&this.contextManager.currentContext&&this.contextManager.currentContext.resume(),yield this.setup(t,!1,!1),this.alreadyInit=!0,this.timer=new Ei(0,1),this.timer.onCount((()=>{var t;null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_COUNT_UPDATE)})),this.successCallback()}catch(t){console.error(t);if(t)switch(t.name){case"SecurityError":case"NotAllowedError":this.errorCallback();break;case"NotFoundError":this.notFoundErrorCallback();break;case"NotSupportedError":this.sampleRateConfigNotSupported||(this.sampleRateConfigNotSupported=!0,this.init());break;default:this.unknownErrorCallback()}}navigator.mediaDevices.ondevicechange=()=>this.updateInputList()}}))}successCallback(){var t;null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_SUCCESS)}errorCallback(){var t;null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_ERROR)}notFoundErrorCallback(){var t;null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_NOT_FOUND_ERROR)}unknownErrorCallback(){var t;null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_UNKNOWN_ERROR)}audioFeedback(t){var e;this.contextManager&&this.contextManager.currentContext&&(t?(this.input&&this.input.connect(this.contextManager.currentContext.destination),this.enableAudioFeedback=!0):(this.input&&this.input.connect(this.contextManager.currentContext.destination)&&this.input.disconnect(this.contextManager.currentContext.destination),this.enableAudioFeedback=!1),null===(e=this.eventEmitter)||void 0===e||e.emit(exports.EventType.RECORDER_UPDATE_CONSTRAINTS))}getConstraints(){if(this.stream){const t=this.stream.getTracks();if(t&&t.length>0)return t[0].getSettings()}return null}updateConstraints(){var t;const e=this.getConstraints();e&&(this.constraints.audio=Object.assign(this.constraints.audio,e),null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_UPDATE_CONSTRAINTS))}resetConstraints(t){return fe(this,void 0,void 0,(function*(){if(this.stream){const e=this.enableAudioFeedback,i=this.recording,r=this.stream.getTracks();if(t&&(this.updateConstraints(),this.constraints.audio=Object.assign(this.constraints.audio,t.audio)),r&&r.length>0)try{yield r[0].applyConstraints(this.constraints.audio);const n=this.getConstraints(),o=t?Object.keys(t.audio)[0]:"";if(this.audioFeedback(!1),this.pause(),!t||n&&n[o]!=t.audio[o]){this.stopStream();const t=yield navigator.mediaDevices.getUserMedia(this.constraints);yield this.setup(t,i,e)}else yield this.setup(null,i,e)}catch(t){this.errorCallback()}}}))}setup(t,e,i){return fe(this,void 0,void 0,(function*(){t&&this.contextManager&&this.contextManager.currentContext&&(this.input=this.contextManager.currentContext.createMediaStreamSource(t),this.stream=t),this.recorder&&this.input&&(yield this.recorder.setup(this.input),e&&(yield this.record())),this.audioFeedback(i),this.updateConstraints(),yield this.updateInputList()}))}setNoiseSuppression(t){this.resetConstraints({audio:{noiseSuppression:t}})}setAutoGain(t){this.resetConstraints({audio:{autoGainControl:t}})}setEchoCancellation(t){this.resetConstraints({audio:{echoCancellation:t}})}updateInputList(){return fe(this,void 0,void 0,(function*(){if(this.deviceList){const t=yield navigator.mediaDevices.enumerateDevices();this.deviceList=[],t.forEach((t=>{"audioinput"==t.kind&&this.deviceList.push(t)}))}}))}changeInput(t,e){e&&(this.constraints.audio.deviceId=t,this.constraints.audio.groupId=e,this.resetConstraints())}record(){return fe(this,void 0,void 0,(function*(){this.alreadyInit&&this.configService&&this.input&&(this.recorder||(this.recorder=new xe({bufferLen:this.configService.getBufferSize(),sampleRate:this.configService.getSampleRate(),numChannels:2,workletBasePath:this.configService.getWorkletBasePath(),workerBasePath:this.configService.getWorkerBasePath(),mimeType:"audio/wav"}),yield this.recorder.setup(this.input)),this.recorder&&this.recorder.record(),this.timer&&this.timer.start(),this.recording=!0,this.eventEmitter&&this.eventEmitter.emit(exports.EventType.RECORDER_RECORDING))}))}stop(){return fe(this,void 0,void 0,(function*(){this.alreadyInit&&this.recorder&&(this.recorder.stop(),this.timer&&this.timer.stop(),this.recording=!1,this.recorder.getBuffer((t=>{var e;if(this.contextManager&&this.contextManager.currentContext){this.contextManager.currentContext.resume();const i=this.contextManager.currentContext.createBuffer(2,t[0].length,this.contextManager.currentContext.sampleRate);i.getChannelData(0).set(t[0]),i.getChannelData(1).set(t[1]),null===(e=this.eventEmitter)||void 0===e||e.emit(exports.EventType.RECORDER_STOPPED,i),this.reset()}})))}))}pause(){var t;this.alreadyInit&&(this.recorder&&this.recorder.stop(),this.timer&&this.timer.stop(),this.recording=!1,null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_PAUSED))}stopStream(){if(this.stream){const t=this.stream.getTracks();for(let e=0,i=t.length;e<i;e++)t[e].stop()}}reset(){var t;this.recorder&&this.recorder.kill(),this.timer&&this.timer.stop(),this.audioFeedback(!1),this.stopStream(),this.input=null,this.recorder=null,this.stream=null,this.alreadyInit=!1,this.timer=null,null===(t=this.eventEmitter)||void 0===t||t.emit(exports.EventType.RECORDER_RESETED)}get currentTimeDisplay(){var t,e,i;return(null===(t=this.timer)||void 0===t?void 0:t.seconds)?("0"+Math.trunc((null===(e=this.timer)||void 0===e?void 0:e.seconds)/60)).slice(-2)+":"+("0"+Math.trunc((null===(i=this.timer)||void 0===i?void 0:i.seconds)%60)).slice(-2):"00:00"}get currentTime(){return this.timer?this.timer.seconds:0}getSettings(){return{deviceList:this.deviceList,audioFeedback:this.enableAudioFeedback,constraints:this.constraints.audio}}on(t,e){var i;null===(i=this.eventEmitter)||void 0===i||i.on(t,e)}isRecordingAvailable(){return void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getUserMedia}get order(){return-1}get id(){return ge.VOICE_RECORDER}};_i=he([oe(),le(0,ae(ce.AudioContextManager)),le(1,ae(ce.ConfigService)),de("design:paramtypes",[Object,Object])],_i);var bi=_i;const Ai=new te({defaultScope:"Singleton"});Ai.bind(ce.EntryPointFilter).to(class extends Qe{constructor(){super(),this.speedAudio=1,this.frequencyAudio=1,this.currentSpeedAudio=1,this.isOfflineMode=!1,this.setDefaultEnabled(!0)}initializeWorklet(){return fe(this,void 0,void 0,(function*(){}))}receiveEvent(t){}get workletPath(){return ge.WORKLET_PATHS.SOUNDTOUCH}constructAudioWorkletProcessor(){throw new Error("Method not implemented.")}get workletName(){return ge.WORKLET_NAMES.SOUNDTOUCH}getEntrypointNode(t,e,i){return fe(this,void 0,void 0,(function*(){if(this.isOfflineMode=i,this.cleanUpOldNodes(),i){if(!this.isEnabled()||1==this.speedAudio&&1==this.frequencyAudio){const i=t.createBufferSource();return i.buffer=e,i.start(),{input:i,output:i}}return this.isAudioWorkletEnabled()&&Ae.isAudioWorkletCompatible(t)&&1==this.speedAudio?this.renderWithWorklet(e,t):this.renderWithScriptProcessorNode(e,t)}return this.currentPitchShifter=this.getSoundtouchScriptProcessorNode(e,t),this.updateState(),{input:this.currentPitchShifter,output:this.currentPitchShifter}}))}cleanUpOldNodes(){this.currentPitchShifterWorklet&&(this.currentPitchShifterWorklet.stop(),this.currentPitchShifterWorklet.disconnect()),this.currentPitchShifter&&(this.currentPitchShifter.disconnect(),this.currentPitchShifter._filter=null)}getSoundtouchScriptProcessorNode(t,e){return new pi(e,t,ge.SOUNDTOUCH_PITCH_SHIFTER_BUFFER_SIZE)}renderWithScriptProcessorNode(t,e){return fe(this,void 0,void 0,(function*(){const i=Ae.calcAudioDuration(t,this.speedAudio),r=new OfflineAudioContext(2,e.sampleRate*i,e.sampleRate);this.currentPitchShifter=this.getSoundtouchScriptProcessorNode(t,r),this.updateState(),this.currentPitchShifter.connect(r.destination);const n=yield r.startRendering(),o=e.createBufferSource();return o.buffer=n,o.start(),this.cleanUpOldNodes(),{input:o,output:o}}))}renderWithWorklet(t,e){return fe(this,void 0,void 0,(function*(){const i=Ae.calcAudioDuration(t,this.speedAudio);try{yield e.audioWorklet.addModule((this.configService?this.configService.getWorkletBasePath():"")+ge.WORKLET_PATHS.SOUNDTOUCH);const r=e.createBufferSource();return r.buffer=t,r.start(),this.currentPitchShifterWorklet=new vi(e,"soundtouch-worklet",{processorOptions:{bypass:!1,recording:!1,nInputFrames:this.approximateNInputFrames(i,e),updateInterval:10,sampleRate:t.sampleRate}}),r.connect(this.currentPitchShifterWorklet.node),this.isEnabled()?yield this.currentPitchShifterWorklet.setup(this.speedAudio,this.frequencyAudio):yield this.currentPitchShifterWorklet.setup(1,1),{input:this.currentPitchShifterWorklet,output:this.currentPitchShifterWorklet}}catch(i){return console.error(i),this.renderWithScriptProcessorNode(t,e)}}))}approximateNInputFrames(t,e){return t*e.sampleRate*(Math.round(14*Math.exp(-4*this.frequencyAudio))+1)}get order(){return 2}get id(){return ge.FILTERS_NAMES.SOUNDTOUCH}getSettings(){return{speedAudio:this.speedAudio,frequencyAudio:this.frequencyAudio}}isAudioWorkletEnabled(){return this.configService?this.configService.isSoundtouchAudioWorkletEnabled():ge.ENABLE_SOUNDTOUCH_AUDIO_WORKLET}getCurrentPitchShifter(){return this.isOfflineMode?1==this.speedAudio&&1==this.frequencyAudio?null:this.isAudioWorkletEnabled()&&this.currentPitchShifterWorklet&&1==this.speedAudio?this.currentPitchShifterWorklet:this.currentPitchShifter:this.currentPitchShifter}updateState(){const t=this.getCurrentPitchShifter();this.isEnabled()?(t&&(t.pitch=this.frequencyAudio,t.tempo=this.speedAudio),this.currentSpeedAudio=this.speedAudio):(t&&(t.pitch=1,t.tempo=1),this.currentSpeedAudio=1)}setSetting(t,e){return fe(this,void 0,void 0,(function*(){if(!Ae.isSettingValueValid(e))return;const i=parseFloat(e);switch(t){case"speedAudio":this.speedAudio=i;break;case"frequencyAudio":this.frequencyAudio=i}this.updateState()}))}setEnabled(t){super.setEnabled(t),this.updateState()}getSpeed(){return this.currentSpeedAudio}}),Ai.bind(ce.Renderers).to(class extends qe{renderAudio(t,e){return new Promise((i=>{const r=e.numberOfChannels,n=t.sampleRate*e.duration+2*t.sampleRate,o=t.createBuffer(r,n,t.sampleRate);for(let t=0;t<r;t++){const i=o.getChannelData(t),r=e.getChannelData(t);for(let t=0;t<n;t++)t<r.length?i[t]=r[r.length-1-t]:i[t]=0}i(o)}))}get order(){return 0}get id(){return ge.FILTERS_NAMES.RETURN_AUDIO}}),Ai.bind(ce.Filters).toDynamicValue((()=>Ai.get(ce.EntryPointFilter))),Ai.bind(ce.Filters).to(class extends He{constructor(){super(...arguments),this.frequencyBooster=200,this.frequencyReduce=200,this.dbBooster=15,this.dbReduce=-2}getNode(t){const e=t.createBiquadFilter();e.type="lowshelf",e.frequency.value=this.frequencyBooster,e.gain.value=this.dbBooster;const i=t.createBiquadFilter();return i.type="highshelf",i.frequency.value=this.frequencyReduce,i.gain.value=this.dbReduce,i.connect(e),{input:i,output:e}}get order(){return 3}get id(){return ge.FILTERS_NAMES.BASS_BOOST}getSettings(){return{frequencyBooster:this.frequencyBooster,frequencyReduce:this.frequencyReduce,dbBooster:this.dbBooster,dbReduce:this.dbReduce}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){if(Ae.isSettingValueValid(e))switch(t){case"frequencyBooster":this.frequencyBooster=parseInt(e);break;case"frequencyReduce":this.frequencyReduce=parseInt(e);break;case"dbBooster":this.dbBooster=parseInt(e);break;case"dbReduce":this.dbReduce=parseInt(e)}}))}}),Ai.bind(ce.Filters).to(class extends Qe{constructor(){super(...arguments),this.bits=16,this.normFreq=.9}receiveEvent(t){}get workletPath(){return ge.WORKLET_PATHS.BITCRUSHER}get workletName(){return ge.WORKLET_NAMES.BITCRUSHER}get order(){return 6}get id(){return ge.FILTERS_NAMES.BITCRUSHER}getSettings(){return{bits:this.bits,normFreq:this.normFreq}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){if(Ae.isSettingValueValid(e)){switch(t){case"bits":this.bits=parseInt(e);break;case"normFreq":this.normFreq=parseFloat(e)}this.applyCurrentSettingsToWorklet()}}))}}),Ai.bind(ce.Filters).to(class extends He{constructor(){super(...arguments),this.delay=.2,this.gain=.75}getNode(t){const e=t.createDelay(179);e.delayTime.value=this.delay;const i=t.createGain();return i.gain.value=this.gain,i.connect(e),e.connect(i),{input:i,output:e}}get order(){return 7}get id(){return ge.FILTERS_NAMES.ECHO}getAddingTime(){return 5}getSettings(){return{delay:this.delay,gain:this.gain}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){if(Ae.isSettingValueValid(e))switch(t){case"delay":this.delay=parseFloat(e);break;case"gain":this.gain=parseFloat(e)}}))}}),Ai.bind(ce.Filters).to(class extends He{constructor(){super(...arguments),this.highFrequency=3500}getNode(t){const e=t.createBiquadFilter();return e.type="highpass",e.frequency.value=this.highFrequency,{input:e,output:e}}get order(){return 4}get id(){return ge.FILTERS_NAMES.HIGH_PASS}getSettings(){return{highFrequency:this.highFrequency}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){if(Ae.isSettingValueValid(e)&&"highFrequency"===t)this.highFrequency=parseInt(e)}))}}),Ai.bind(ce.Filters).to(class extends Qe{constructor(){super(),this.preGain=0,this.postGain=0,this.attackTime=0,this.releaseTime=6,this.threshold=0,this.lookAheadTime=.3,this.keepCurrentNodeIfPossible=!0,this.setDefaultEnabled(!0)}receiveEvent(t){}get workletPath(){return ge.WORKLET_PATHS.LIMITER}get workletName(){return ge.WORKLET_NAMES.LIMITER}get order(){return 11}get id(){return ge.FILTERS_NAMES.LIMITER}getAddingTime(){return this.lookAheadTime}getSettings(){return{preGain:this.preGain,postGain:this.postGain,attackTime:this.attackTime,releaseTime:this.releaseTime,threshold:this.threshold,lookAheadTime:this.lookAheadTime}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){if(Ae.isSettingValueValid(e)){switch(t){case"preGain":this.preGain=parseFloat(e);break;case"postGain":this.postGain=parseFloat(e);break;case"attackTime":this.attackTime=parseFloat(e);break;case"releaseTime":this.releaseTime=parseFloat(e);break;case"threshold":this.threshold=parseFloat(e);break;case"lookAheadTime":this.lookAheadTime=parseFloat(e)}this.applyCurrentSettingsToWorklet()}}))}}),Ai.bind(ce.Filters).to(class extends He{constructor(){super(...arguments),this.lowFrequency=3500}getNode(t){const e=t.createBiquadFilter();return e.type="lowpass",e.frequency.value=this.lowFrequency,{input:e,output:e}}get order(){return 5}get id(){return ge.FILTERS_NAMES.LOW_PASS}getSettings(){return{lowFrequency:this.lowFrequency}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){if(Ae.isSettingValueValid(e)&&"lowFrequency"===t)this.lowFrequency=parseInt(e)}))}}),Ai.bind(ce.Filters).to(class extends He{constructor(){super(...arguments),this.reverbEnvironment=ge.DEFAULT_REVERB_ENVIRONMENT,this.reverbCustomEnvironmentAddTime=5,this.customEnvironment=null}getNode(t){const e=t.createConvolver();this.reverbEnvironment&&("custom"!=this.reverbEnvironment.url||this.customEnvironment)||(this.reverbEnvironment=ge.DEFAULT_REVERB_ENVIRONMENT);const i=this.getReverbBuffer(t);return i&&(e.buffer=i),{input:e,output:e}}getReverbBuffer(t){if("custom"==this.reverbEnvironment.url&&this.customEnvironment){if(this.customEnvironment.sampleRate===t.sampleRate)return this.customEnvironment;this.reverbEnvironment=ge.DEFAULT_REVERB_ENVIRONMENT}else if(this.bufferFetcherService)return this.bufferFetcherService.getAudioBuffer(this.reverbEnvironment.url)}get order(){return 9}get id(){return ge.FILTERS_NAMES.REVERB}getAddingTime(){const t=this.getSettings();if(t&&t.reverbEnvironment){if("custom"==t.reverbEnvironment.value)return this.reverbCustomEnvironmentAddTime;if(t.reverbEnvironment.additionalData)return t.reverbEnvironment.additionalData.addDuration}return 0}getSettings(){var t;return this.reverbEnvironment?{reverbEnvironment:{name:this.reverbEnvironment.name,value:this.reverbEnvironment.url,additionalData:{size:this.reverbEnvironment.size,link:this.reverbEnvironment.link,addDuration:this.reverbEnvironment.addDuration}},downloadedBuffers:null===(t=this.bufferFetcherService)||void 0===t?void 0:t.getDownloadedBuffersList(),hasCustomEnvironment:!!this.customEnvironment,reverbCustomEnvironmentAddTime:this.reverbCustomEnvironmentAddTime}:{reverbCustomEnvironmentAddTime:this.reverbCustomEnvironmentAddTime}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){var i;if("reverbEnvironment"==t){const t=e;if(t){const e=t.value;try{"custom"!=e&&(yield null===(i=this.bufferFetcherService)||void 0===i?void 0:i.fetchBuffer(e)),t.additionalData?this.reverbEnvironment={name:t.name,url:e,size:t.additionalData.size,addDuration:t.additionalData.addDuration,link:t.additionalData.link}:this.reverbEnvironment={name:t.name,url:e,size:0,addDuration:0,link:""}}catch(t){}}}else"reverbCustomEnvironmentAddTime"==t?Ae.isSettingValueValid(e)&&(this.reverbCustomEnvironmentAddTime=parseInt(e)):"reverbCustomEnvironmentFile"==t&&this.bufferDecoderService&&e&&(this.customEnvironment=yield this.bufferDecoderService.decodeBufferFromFile(e),this.customEnvironment||(this.reverbEnvironment=ge.DEFAULT_REVERB_ENVIRONMENT))}))}bufferFetcherReseted(){return fe(this,void 0,void 0,(function*(){var t;const e=this.getSettings();if(e){const i=null===(t=e.reverbEnvironment)||void 0===t?void 0:t.value;if(i&&"custom"!==i&&this.bufferFetcherService)return yield this.bufferFetcherService.fetchBuffer(i),!0}return!1}))}}),Ai.bind(ce.Filters).to(class extends He{getNode(t){const e=t.createBiquadFilter();e.type="lowpass",e.frequency.value=2e3;const i=t.createBiquadFilter();i.type="lowpass",i.frequency.value=2e3;const r=t.createBiquadFilter();r.type="highpass",r.frequency.value=500;const n=t.createBiquadFilter();return n.type="highpass",n.frequency.value=500,e.connect(i),i.connect(r),r.connect(n),{input:e,output:n}}get order(){return 7}get id(){return ge.FILTERS_NAMES.TELEPHONIZER}getSettings(){return{}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){}))}}),Ai.bind(ce.Filters).to(class extends He{constructor(){super(...arguments),this.currentVocoder=null,this.modulatorGainValue=1,this.carrierSampleGainValue=0,this.oscillatorGainValue=1,this.noiseGainValue=.2,this.oscillatorDetuneValue=0}getNode(t){var e;const i=null===(e=this.bufferFetcherService)||void 0===e?void 0:e.getAudioBuffer(ge.VOCODER_MODULATOR);this.currentVocoder=new mi(t,i),this.currentVocoder.init(),this.applyCurrentSettingsToVocoder();const{modulatorGain:r,outputGain:n}=this.currentVocoder.getNodes();return{input:r,output:n}}getSettings(){return{modulatorGainValue:this.modulatorGainValue,carrierSampleGainValue:this.carrierSampleGainValue,oscillatorGainValue:this.oscillatorGainValue,noiseGainValue:this.noiseGainValue,oscillatorDetuneValue:this.oscillatorDetuneValue}}setSetting(t,e){return fe(this,void 0,void 0,(function*(){if(Ae.isSettingValueValid(e)){switch(t){case"modulatorGainValue":this.modulatorGainValue=parseFloat(e);break;case"carrierSampleGainValue":this.carrierSampleGainValue=parseFloat(e);break;case"oscillatorGainValue":this.oscillatorGainValue=parseFloat(e);break;case"noiseGainValue":this.noiseGainValue=parseFloat(e);break;case"oscillatorDetuneValue":this.oscillatorDetuneValue=parseFloat(e)}this.applyCurrentSettingsToVocoder()}}))}applyCurrentSettingsToVocoder(){this.currentVocoder&&(this.currentVocoder.updateModGain(this.modulatorGainValue),this.currentVocoder.updateSampleLevel(this.carrierSampleGainValue),this.currentVocoder.updateSynthLevel(this.oscillatorGainValue),this.currentVocoder.updateNoiseLevel(this.noiseGainValue),this.currentVocoder.updateDetuneValue(this.oscillatorDetuneValue))}get order(){return 1}get id(){return ge.FILTERS_NAMES.VOCODER}}),Ai.bind(ce.Filters).to(class extends Qe{constructor(){super(...arguments),this.currentTime=0,this.lastSampleCount=0,this.samplePerSecond=0,this.currentTimeSamplesPerSecond=0}receiveEvent(t){const e=performance.now(),i=t.data.samplesCount;"update"===t.data.command&&this.calculatePercentageProcessed(e,i),this.calculateRemainingTimeProcessing(e,i)}calculatePercentageProcessed(t,e){0===this.currentTime&&(this.currentTime=t);const i=t-this.currentTime,r=e/this._totalSamples;this.eventEmitter&&i>=ge.TREATMENT_TIME_COUNTING_THROTTLE_INTERVAL&&(this.eventEmitter.emit(exports.EventType.UPDATE_AUDIO_TREATMENT_PERCENT,100*r),this.currentTime=t)}calculateRemainingTimeProcessing(t,e){0===this.currentTimeSamplesPerSecond&&(this.currentTimeSamplesPerSecond=t);const i=t-this.currentTimeSamplesPerSecond,r=this._totalSamples-e;if(this.eventEmitter&&r<=0)this.eventEmitter.emit(exports.EventType.UPDATE_REMAINING_TIME_ESTIMATED,0);else if(this.eventEmitter&&i>=1e3){this.calculateSmoothedSamplePerSecond(i,e);const n=r/this.samplePerSecond;this.currentTimeSamplesPerSecond=t,this.lastSampleCount=e,isNaN(n)||!isFinite(n)?this.eventEmitter.emit(exports.EventType.UPDATE_REMAINING_TIME_ESTIMATED,-1):this.eventEmitter.emit(exports.EventType.UPDATE_REMAINING_TIME_ESTIMATED,n)}}calculateSmoothedSamplePerSecond(t,e){if(t>0){const i=(e-this.lastSampleCount)/(t/1e3);this.samplePerSecond=ge.TREATMENT_TIME_COUNTING_SMOOTHING_FACTOR*i+(1-ge.TREATMENT_TIME_COUNTING_SMOOTHING_FACTOR)*this.samplePerSecond}}get workletName(){return ge.WORKLET_NAMES.PASSTHROUGH}get workletPath(){return ge.WORKLET_PATHS.PASSTHROUGH}get order(){return 10}get id(){return ge.FILTERS_NAMES.PASSTHROUGH}set totalSamples(t){super.totalSamples=t,this.currentTime=0,this.currentTimeSamplesPerSecond=0,this.samplePerSecond=0,this.lastSampleCount=0}getSettings(){return{}}isEnabled(){return!0}setSetting(t,e){return fe(this,void 0,void 0,(function*(){}))}}),Ai.bind(ce.EventEmitter).to(me),Ai.bind(ce.AudioContextManager).to(Ee),Ai.bind(ce.AudioEditor).to(we),Ai.bind(ce.AudioProcessor).to(Te),Ai.bind(ce.BufferManager).to(Ie),Ai.bind(ce.FilterManager).to(Pe),Ai.bind(ce.RendererManager).to(Be),Ai.bind(ce.SaveBufferManager).to(ke),Ai.bind(ce.BufferPlayer).to(Ge),Ai.bind(ce.BufferFetcherService).to(Ve),Ai.bind(ce.BufferDecoderService).to(je),Ai.bind(ce.VoiceRecorder).to(bi);let Si=class{constructor(){this.mapConfig=new Map}getConfig(t){return this.mapConfig.get(t)}setConfig(t,e){this.mapConfig.set(t,e)}isCompatibilityModeEnabled(){return"true"==this.getConfig(ge.PREFERENCES_KEYS.COMPATIBILITY_MODE_ENABLED)}isCompatibilityModeChecked(){return"true"==this.getConfig(ge.PREFERENCES_KEYS.COMPATIBILITY_MODE_CHECKED)}isAudioWorkletEnabled(){const t=this.getConfig(ge.PREFERENCES_KEYS.ENABLE_AUDIO_WORKLET);return null!=t?"true"==t:ge.ENABLE_AUDIO_WORKLET}isSoundtouchAudioWorkletEnabled(){const t=this.getConfig(ge.PREFERENCES_KEYS.ENABLE_SOUNDTOUCH_AUDIO_WORKLET);return null!=t?"true"==t:ge.ENABLE_SOUNDTOUCH_AUDIO_WORKLET}getBufferSize(){const t=this.getConfig(ge.PREFERENCES_KEYS.BUFFER_SIZE);return null!=t?parseInt(t):ge.DEFAULT_BUFFER_SIZE}getSampleRate(){const t=this.getConfig(ge.PREFERENCES_KEYS.SAMPLE_RATE);return null!=t?parseInt(t):ge.DEFAULT_SAMPLE_RATE}getBitrateMP3(){const t=this.getConfig(ge.PREFERENCES_KEYS.BITRATE_MP3);return null!=t?parseInt(t):ge.DEFAULT_MP3_BITRATE}enableCompatibilityMode(){this.setConfig(ge.PREFERENCES_KEYS.COMPATIBILITY_MODE_ENABLED,"true")}disableCompatibilityMode(){this.setConfig(ge.PREFERENCES_KEYS.COMPATIBILITY_MODE_ENABLED,"false")}getWorkletBasePath(){return""}getWorkerBasePath(){return""}getSoundBasePath(){return""}isInitialRenderingDisabled(){const t=this.getConfig(ge.PREFERENCES_KEYS.DISABLE_INITIAL_RENDERING);return null!=t?"true"==t:ge.DISABLE_INITIAL_RENDERING}};Si=he([oe()],Si);var wi=Si;class Ri{static createAudioEditor(t,e){return Ri.ready||(t?Ai.bind(ce.ConfigService).toDynamicValue((()=>t)):(Ai.bind(ce.ConfigService).to(wi),console.warn("No ConfigService provided. Using default generic implementation.")),Ai.bind(ce.AudioBuffersToFetch).toConstantValue(e||[]),Ri.ready=!0),Ai.get(ce.AudioEditor)}static createVoiceRecorder(){return Ai.get(ce.VoiceRecorder)}static getAudioEditorInstance(){return Ai.get(ce.AudioEditor)}static getAudioPlayerInstance(){return Ai.get(ce.BufferPlayer)}static getAudioRecorderInstance(){return Ai.get(ce.VoiceRecorder)}static getEventEmitterInstance(){return Ai.get(ce.EventEmitter)}static getConfigServiceInstance(){return Ai.get(ce.ConfigService)}}Ri.ready=!1,exports.AbstractAudioElement=be,exports.AbstractAudioFilter=He,exports.AbstractAudioFilterWorklet=Qe,exports.AbstractAudioRenderer=qe,exports.AudioEditor=we,exports.BufferPlayer=Ge,exports.Constants=ge,exports.EventEmitter=me,exports.GenericConfigService=wi,exports.SoundStudioFactory=Ri,exports.UtilFunctions=Ae,exports.VoiceRecorder=bi,exports.audioEditorContainer=Ai;
//# sourceMappingURL=SimpleSoundStudioLibrary.js.map
