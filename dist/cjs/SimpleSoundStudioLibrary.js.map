{"version":3,"file":"SimpleSoundStudioLibrary.js","sources":["../../node_modules/tslib/tslib.es6.js","../../node_modules/@inversifyjs/common/lib/esm/index.js","../../node_modules/reflect-metadata/Reflect.js","../../node_modules/@inversifyjs/reflect-metadata-utils/lib/esm/index.js","../../node_modules/@inversifyjs/core/lib/esm/index.js","../../node_modules/@inversifyjs/container/lib/esm/index.js","../../lib/inversify.types.ts","../../lib/interfaces/AbstractAudioElement.ts","../../lib/model/EventTypeEnum.ts","../../lib/utils/Functions.ts","../../lib/audioEditor/AudioEditor.ts","../../lib/bufferPlayer/BufferPlayer.ts","../../lib/utils/TimerSaveTime.ts","../../lib/model/FilterNames.ts","../../lib/model/Constants.ts","../../lib/recorder/getRecorderWorker.ts","../../lib/recorder/Recorder.ts","../../lib/voiceRecorder/VoiceRecorder.ts","../../lib/filters/interfaces/AbstractAudioNode.ts","../../lib/filters/interfaces/AbstractAudioFilter.ts","../../lib/workletPolyfill/AudioParamPolyfill.ts","../../lib/workletPolyfill/WorkletScriptProcessorNodeAdapter.ts","../../lib/workletPolyfill/RegisterProcessorPolyfill.ts","../../lib/workletPolyfill/SimpleAudioWorkletProcessor.ts","../../lib/workletPolyfill/AudioWorkletProcessorPolyfill.ts","../../lib/filters/interfaces/AbstractAudioFilterWorklet.ts","../../lib/filters/interfaces/AbstractAudioRenderer.ts","../../lib/utils/EventEmitter.ts","../../lib/services/GenericConfigService.ts","../../lib/audioEditor/AudioContextManager.ts","../../lib/audioEditor/AudioProcessor.ts","../../lib/audioEditor/BufferManager.ts","../../lib/audioEditor/FilterManager.ts","../../lib/audioEditor/RendererManager.ts","../../lib/audioEditor/SaveBufferManager.ts","../../lib/services/BufferFetcherService.ts","../../lib/services/BufferDecoderService.ts","../../lib/filters/ReturnAudioRenderer.ts","../../lib/filters/BassBoosterFilter.ts","../../lib/filters/worklets/BitCrusher.worklet.ts","../../lib/filters/BitCrusherFilter.ts","../../lib/filters/EchoFilter.ts","../../lib/filters/HighPassFilter.ts","../../lib/utils/DelayBuffer.ts","../../lib/filters/worklets/Limiter.worklet.ts","../../lib/filters/LimiterFilter.ts","../../lib/filters/LowPassFilter.ts","../../lib/filters/ReverbFilter.ts","../../node_modules/soundtouchjs/dist/soundtouch.js","../../lib/filters/worklets/SoundtouchWrapperFilterWorkletNode.ts","../../lib/filters/SountouchWrapperFilter.ts","../../lib/filters/TelephonizerFilter.ts","../../lib/utils/Vocoder.ts","../../lib/filters/VocoderFilter.ts","../../lib/filters/worklets/Passthrough.worklet.ts","../../lib/filters/PassThroughFilter.ts","../../lib/utils/SoundStudioFactory.ts","../../lib/inversify.config.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","function e(e){return(\"object\"==typeof e&&null!==e||\"function\"==typeof e)&&\"function\"==typeof e.then}function t(e){switch(typeof e){case\"string\":case\"symbol\":return e.toString();case\"function\":return e.name;default:throw new Error(`Unexpected ${typeof e} service id type`)}}const n=Symbol.for(\"@inversifyjs/common/islazyServiceIdentifier\");class r{[n];#e;constructor(e){this.#e=e,this[n]=!0}static is(e){return\"object\"==typeof e&&null!==e&&!0===e[n]}unwrap(){return this.#e()}}export{r as LazyServiceIdentifier,e as isPromise,t as stringifyServiceIdentifier};\n//# sourceMappingURL=index.js.map\n","/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof globalThis === \"object\" ? globalThis :\n            typeof global === \"object\" ? global :\n                typeof self === \"object\" ? self :\n                    typeof this === \"object\" ? this :\n                        sloppyModeThis();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect !== \"undefined\") {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter, root);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                if (previous)\n                    previous(key, value);\n            };\n        }\n        function functionThis() {\n            try {\n                return Function(\"return this;\")();\n            }\n            catch (_) { }\n        }\n        function indirectEvalThis() {\n            try {\n                return (void 0, eval)(\"(function() { return this; })()\");\n            }\n            catch (_) { }\n        }\n        function sloppyModeThis() {\n            return functionThis() || indirectEvalThis();\n        }\n    })(function (exporter, root) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var _Map = typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        var registrySymbol = supportsSymbol ? Symbol.for(\"@reflect-metadata:registry\") : undefined;\n        var metadataRegistry = GetOrCreateMetadataRegistry();\n        var metadataProvider = CreateMetadataProvider(metadataRegistry);\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var provider = GetMetadataProvider(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(provider))\n                return false;\n            return provider.OrdinaryDeleteMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ false);\n            if (IsUndefined(provider))\n                return false;\n            return ToBoolean(provider.OrdinaryHasOwnMetadata(MetadataKey, O, P));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ false);\n            if (IsUndefined(provider))\n                return;\n            return provider.OrdinaryGetOwnMetadata(MetadataKey, O, P);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ true);\n            provider.OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var provider = GetMetadataProvider(O, P, /*create*/ false);\n            if (!provider) {\n                return [];\n            }\n            return provider.OrdinaryOwnMetadataKeys(O, P);\n        }\n        // 6 ECMAScript Data Types and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        function SameValueZero(x, y) {\n            return x === y || x !== x && y !== y;\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // Global metadata registry\n        // - Allows `import \"reflect-metadata\"` and `import \"reflect-metadata/no-conflict\"` to interoperate.\n        // - Uses isolated metadata if `Reflect` is frozen before the registry can be installed.\n        /**\n         * Creates a registry used to allow multiple `reflect-metadata` providers.\n         */\n        function CreateMetadataRegistry() {\n            var fallback;\n            if (!IsUndefined(registrySymbol) &&\n                typeof root.Reflect !== \"undefined\" &&\n                !(registrySymbol in root.Reflect) &&\n                typeof root.Reflect.defineMetadata === \"function\") {\n                // interoperate with older version of `reflect-metadata` that did not support a registry.\n                fallback = CreateFallbackProvider(root.Reflect);\n            }\n            var first;\n            var second;\n            var rest;\n            var targetProviderMap = new _WeakMap();\n            var registry = {\n                registerProvider: registerProvider,\n                getProvider: getProvider,\n                setProvider: setProvider,\n            };\n            return registry;\n            function registerProvider(provider) {\n                if (!Object.isExtensible(registry)) {\n                    throw new Error(\"Cannot add provider to a frozen registry.\");\n                }\n                switch (true) {\n                    case fallback === provider: break;\n                    case IsUndefined(first):\n                        first = provider;\n                        break;\n                    case first === provider: break;\n                    case IsUndefined(second):\n                        second = provider;\n                        break;\n                    case second === provider: break;\n                    default:\n                        if (rest === undefined)\n                            rest = new _Set();\n                        rest.add(provider);\n                        break;\n                }\n            }\n            function getProviderNoCache(O, P) {\n                if (!IsUndefined(first)) {\n                    if (first.isProviderFor(O, P))\n                        return first;\n                    if (!IsUndefined(second)) {\n                        if (second.isProviderFor(O, P))\n                            return first;\n                        if (!IsUndefined(rest)) {\n                            var iterator = GetIterator(rest);\n                            while (true) {\n                                var next = IteratorStep(iterator);\n                                if (!next) {\n                                    return undefined;\n                                }\n                                var provider = IteratorValue(next);\n                                if (provider.isProviderFor(O, P)) {\n                                    IteratorClose(iterator);\n                                    return provider;\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!IsUndefined(fallback) && fallback.isProviderFor(O, P)) {\n                    return fallback;\n                }\n                return undefined;\n            }\n            function getProvider(O, P) {\n                var providerMap = targetProviderMap.get(O);\n                var provider;\n                if (!IsUndefined(providerMap)) {\n                    provider = providerMap.get(P);\n                }\n                if (!IsUndefined(provider)) {\n                    return provider;\n                }\n                provider = getProviderNoCache(O, P);\n                if (!IsUndefined(provider)) {\n                    if (IsUndefined(providerMap)) {\n                        providerMap = new _Map();\n                        targetProviderMap.set(O, providerMap);\n                    }\n                    providerMap.set(P, provider);\n                }\n                return provider;\n            }\n            function hasProvider(provider) {\n                if (IsUndefined(provider))\n                    throw new TypeError();\n                return first === provider || second === provider || !IsUndefined(rest) && rest.has(provider);\n            }\n            function setProvider(O, P, provider) {\n                if (!hasProvider(provider)) {\n                    throw new Error(\"Metadata provider not registered.\");\n                }\n                var existingProvider = getProvider(O, P);\n                if (existingProvider !== provider) {\n                    if (!IsUndefined(existingProvider)) {\n                        return false;\n                    }\n                    var providerMap = targetProviderMap.get(O);\n                    if (IsUndefined(providerMap)) {\n                        providerMap = new _Map();\n                        targetProviderMap.set(O, providerMap);\n                    }\n                    providerMap.set(P, provider);\n                }\n                return true;\n            }\n        }\n        /**\n         * Gets or creates the shared registry of metadata providers.\n         */\n        function GetOrCreateMetadataRegistry() {\n            var metadataRegistry;\n            if (!IsUndefined(registrySymbol) && IsObject(root.Reflect) && Object.isExtensible(root.Reflect)) {\n                metadataRegistry = root.Reflect[registrySymbol];\n            }\n            if (IsUndefined(metadataRegistry)) {\n                metadataRegistry = CreateMetadataRegistry();\n            }\n            if (!IsUndefined(registrySymbol) && IsObject(root.Reflect) && Object.isExtensible(root.Reflect)) {\n                Object.defineProperty(root.Reflect, registrySymbol, {\n                    enumerable: false,\n                    configurable: false,\n                    writable: false,\n                    value: metadataRegistry\n                });\n            }\n            return metadataRegistry;\n        }\n        function CreateMetadataProvider(registry) {\n            // [[Metadata]] internal slot\n            // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n            var metadata = new _WeakMap();\n            var provider = {\n                isProviderFor: function (O, P) {\n                    var targetMetadata = metadata.get(O);\n                    if (IsUndefined(targetMetadata))\n                        return false;\n                    return targetMetadata.has(P);\n                },\n                OrdinaryDefineOwnMetadata: OrdinaryDefineOwnMetadata,\n                OrdinaryHasOwnMetadata: OrdinaryHasOwnMetadata,\n                OrdinaryGetOwnMetadata: OrdinaryGetOwnMetadata,\n                OrdinaryOwnMetadataKeys: OrdinaryOwnMetadataKeys,\n                OrdinaryDeleteMetadata: OrdinaryDeleteMetadata,\n            };\n            metadataRegistry.registerProvider(provider);\n            return provider;\n            function GetOrCreateMetadataMap(O, P, Create) {\n                var targetMetadata = metadata.get(O);\n                var createdTargetMetadata = false;\n                if (IsUndefined(targetMetadata)) {\n                    if (!Create)\n                        return undefined;\n                    targetMetadata = new _Map();\n                    metadata.set(O, targetMetadata);\n                    createdTargetMetadata = true;\n                }\n                var metadataMap = targetMetadata.get(P);\n                if (IsUndefined(metadataMap)) {\n                    if (!Create)\n                        return undefined;\n                    metadataMap = new _Map();\n                    targetMetadata.set(P, metadataMap);\n                    if (!registry.setProvider(O, P, provider)) {\n                        targetMetadata.delete(P);\n                        if (createdTargetMetadata) {\n                            metadata.delete(O);\n                        }\n                        throw new Error(\"Wrong provider for target.\");\n                    }\n                }\n                return metadataMap;\n            }\n            // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n            function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return false;\n                return ToBoolean(metadataMap.has(MetadataKey));\n            }\n            // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n            function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return undefined;\n                return metadataMap.get(MetadataKey);\n            }\n            // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n            function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n                metadataMap.set(MetadataKey, MetadataValue);\n            }\n            // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n            function OrdinaryOwnMetadataKeys(O, P) {\n                var keys = [];\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return keys;\n                var keysObj = metadataMap.keys();\n                var iterator = GetIterator(keysObj);\n                var k = 0;\n                while (true) {\n                    var next = IteratorStep(iterator);\n                    if (!next) {\n                        keys.length = k;\n                        return keys;\n                    }\n                    var nextValue = IteratorValue(next);\n                    try {\n                        keys[k] = nextValue;\n                    }\n                    catch (e) {\n                        try {\n                            IteratorClose(iterator);\n                        }\n                        finally {\n                            throw e;\n                        }\n                    }\n                    k++;\n                }\n            }\n            function OrdinaryDeleteMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return false;\n                if (!metadataMap.delete(MetadataKey))\n                    return false;\n                if (metadataMap.size === 0) {\n                    var targetMetadata = metadata.get(O);\n                    if (!IsUndefined(targetMetadata)) {\n                        targetMetadata.delete(P);\n                        if (targetMetadata.size === 0) {\n                            metadata.delete(targetMetadata);\n                        }\n                    }\n                }\n                return true;\n            }\n        }\n        function CreateFallbackProvider(reflect) {\n            var defineMetadata = reflect.defineMetadata, hasOwnMetadata = reflect.hasOwnMetadata, getOwnMetadata = reflect.getOwnMetadata, getOwnMetadataKeys = reflect.getOwnMetadataKeys, deleteMetadata = reflect.deleteMetadata;\n            var metadataOwner = new _WeakMap();\n            var provider = {\n                isProviderFor: function (O, P) {\n                    var metadataPropertySet = metadataOwner.get(O);\n                    if (!IsUndefined(metadataPropertySet) && metadataPropertySet.has(P)) {\n                        return true;\n                    }\n                    if (getOwnMetadataKeys(O, P).length) {\n                        if (IsUndefined(metadataPropertySet)) {\n                            metadataPropertySet = new _Set();\n                            metadataOwner.set(O, metadataPropertySet);\n                        }\n                        metadataPropertySet.add(P);\n                        return true;\n                    }\n                    return false;\n                },\n                OrdinaryDefineOwnMetadata: defineMetadata,\n                OrdinaryHasOwnMetadata: hasOwnMetadata,\n                OrdinaryGetOwnMetadata: getOwnMetadata,\n                OrdinaryOwnMetadataKeys: getOwnMetadataKeys,\n                OrdinaryDeleteMetadata: deleteMetadata,\n            };\n            return provider;\n        }\n        /**\n         * Gets the metadata provider for an object. If the object has no metadata provider and this is for a create operation,\n         * then this module's metadata provider is assigned to the object.\n         */\n        function GetMetadataProvider(O, P, Create) {\n            var registeredProvider = metadataRegistry.getProvider(O, P);\n            if (!IsUndefined(registeredProvider)) {\n                return registeredProvider;\n            }\n            if (Create) {\n                if (metadataRegistry.setProvider(O, P, metadataProvider)) {\n                    return metadataProvider;\n                }\n                throw new Error(\"Illegal state.\");\n            }\n            return undefined;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            var Map = /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (SameValueZero(key, this._cacheKey)) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (!SameValueZero(this._cacheKey, key)) {\n                        this._cacheIndex = -1;\n                        for (var i = 0; i < this._keys.length; i++) {\n                            if (SameValueZero(this._keys[i], key)) {\n                                this._cacheIndex = i;\n                                break;\n                            }\n                        }\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            return Map;\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            var Set = /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.keys(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n            return Set;\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    var array = new Uint8Array(size);\n                    if (typeof crypto !== \"undefined\") {\n                        crypto.getRandomValues(array);\n                    }\n                    else if (typeof msCrypto !== \"undefined\") {\n                        msCrypto.getRandomValues(array);\n                    }\n                    else {\n                        FillRandomBytes(array, size);\n                    }\n                    return array;\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122 § 4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n","function t(t,e){return Reflect.getOwnMetadata(e,t)}function e(t,e){return Reflect.getMetadata(e,t)}function n(t,e,n){Reflect.defineMetadata(e,n,t)}function a(e,n,a,f){const c=f(t(e,n)??a());Reflect.defineMetadata(n,c,e)}function f(t,n,a,f){const c=f(e(t,n)??a());Reflect.defineMetadata(n,c,t)}export{t as getOwnReflectMetadata,e as getReflectMetadata,n as setReflectMetadata,a as updateOwnReflectMetadata,f as updateReflectMetadata};\n//# sourceMappingURL=index.js.map\n","import{getOwnReflectMetadata as e,updateOwnReflectMetadata as t,setReflectMetadata as n}from\"@inversifyjs/reflect-metadata-utils\";import{getBaseType as i}from\"@inversifyjs/prototype-utils\";import{stringifyServiceIdentifier as o,LazyServiceIdentifier as r,isPromise as a}from\"@inversifyjs/common\";const s={Request:\"Request\",Singleton:\"Singleton\",Transient:\"Transient\"},c={ConstantValue:\"ConstantValue\",DynamicValue:\"DynamicValue\",Factory:\"Factory\",Instance:\"Instance\",Provider:\"Provider\",ResolvedValue:\"ResolvedValue\",ServiceRedirection:\"ServiceRedirection\"};function*u(...e){for(const t of e)yield*t}class d{#e;#t;#n;constructor(e){this.#e=new Map,this.#t={};for(const t of Reflect.ownKeys(e))this.#t[t]=new Map;this.#n=e}add(e,t){this.#i(e).push(t);for(const n of Reflect.ownKeys(t))this.#o(n,t[n]).push(e)}clone(){const e=Reflect.ownKeys(this.#n),t=new d(this.#n);this.#r(this.#e,t.#e);for(const n of e)this.#r(this.#t[n],t.#t[n]);return t}get(e,t){return this.#t[e].get(t)}getAllKeys(e){return this.#t[e].keys()}removeByRelation(e,t){const n=this.get(e,t);if(void 0===n)return;const i=new Set(n);for(const n of i){const i=this.#e.get(n);if(void 0===i)throw new Error(\"Expecting model relation, none found\");for(const o of i)o[e]===t&&this.#a(n,o);this.#e.delete(n)}}#i(e){let t=this.#e.get(e);return void 0===t&&(t=[],this.#e.set(e,t)),t}#o(e,t){let n=this.#t[e].get(t);return void 0===n&&(n=[],this.#t[e].set(t,n)),n}#r(e,t){for(const[n,i]of e)t.set(n,[...i])}#a(e,t){for(const n of Reflect.ownKeys(t))this.#s(e,n,t[n])}#s(e,t,n){const i=this.#t[t].get(n);if(void 0!==i){const o=i.indexOf(e);-1!==o&&i.splice(o,1),0===i.length&&this.#t[t].delete(n)}}}var l,p,f;!function(e){e.moduleId=\"moduleId\",e.serviceId=\"serviceId\"}(l||(l={}));class g{#c;#u;constructor(e,t){this.#c=t??new d({moduleId:{isOptional:!0},serviceId:{isOptional:!1}}),this.#u=e}static build(e){return new g(e)}add(e,t){this.#c.add(e,t)}clone(){return new g(this.#u,this.#c.clone())}get(e){const t=[],n=this.#c.get(l.serviceId,e);void 0!==n&&t.push(n);const i=this.#u?.get(e);if(void 0!==i&&t.push(i),0!==t.length)return u(...t)}removeAllByModuleId(e){this.#c.removeByRelation(l.moduleId,e)}removeAllByServiceId(e){this.#c.removeByRelation(l.serviceId,e)}}!function(e){e.id=\"id\",e.moduleId=\"moduleId\",e.serviceId=\"serviceId\"}(p||(p={}));class m{#d;#u;constructor(e,t){this.#d=t??new d({id:{isOptional:!1},moduleId:{isOptional:!0},serviceId:{isOptional:!1}}),this.#u=e}static build(e){return new m(e)}clone(){return new m(this.#u,this.#d.clone())}get(e){return this.getNonParentBindings(e)??this.#u?.get(e)}getById(e){return this.#d.get(p.id,e)??this.#u?.getById(e)}getByModuleId(e){return this.#d.get(p.moduleId,e)??this.#u?.getByModuleId(e)}getNonParentBindings(e){return this.#d.get(p.serviceId,e)}getNonParentBoundServices(){return this.#d.getAllKeys(p.serviceId)}removeById(e){this.#d.removeByRelation(p.id,e)}removeAllByModuleId(e){this.#d.removeByRelation(p.moduleId,e)}removeAllByServiceId(e){this.#d.removeByRelation(p.serviceId,e)}set(e){const t={[p.id]:e.id,[p.serviceId]:e.serviceIdentifier};void 0!==e.moduleId&&(t[p.moduleId]=e.moduleId),this.#d.add(e,t)}}!function(e){e.moduleId=\"moduleId\",e.serviceId=\"serviceId\"}(f||(f={}));class h{#l;#u;constructor(e,t){this.#l=t??new d({moduleId:{isOptional:!0},serviceId:{isOptional:!1}}),this.#u=e}static build(e){return new h(e)}add(e,t){this.#l.add(e,t)}clone(){return new h(this.#u,this.#l.clone())}get(e){const t=[],n=this.#l.get(f.serviceId,e);void 0!==n&&t.push(n);const i=this.#u?.get(e);if(void 0!==i&&t.push(i),0!==t.length)return u(...t)}removeAllByModuleId(e){this.#l.removeByRelation(f.moduleId,e)}removeAllByServiceId(e){this.#l.removeByRelation(f.serviceId,e)}}function v(e,t,n){const i=Array.isArray(e)?e:[e];if(void 0!==n)if(\"number\"!=typeof n)Reflect.decorate(i,t.prototype,n);else for(const e of i)e(t,void 0,n);else Reflect.decorate(i,t)}const y=\"@inversifyjs/core/classMetadataReflectKey\";function M(){return{constructorArguments:[],lifecycle:{postConstructMethodName:void 0,preDestroyMethodName:void 0},properties:new Map,scope:void 0}}const I=\"@inversifyjs/core/pendingClassMetadataCountReflectKey\";const w=Symbol.for(\"@inversifyjs/core/InversifyCoreError\");class b extends Error{[w];kind;constructor(e,t,n){super(t,n),this[w]=!0,this.kind=e}static is(e){return\"object\"==typeof e&&null!==e&&!0===e[w]}static isErrorOfKind(e,t){return b.is(e)&&e.kind===t}}var j,T,C;function S(t){const n=e(t,y)??M();if(!function(t){const n=e(t,I);return void 0!==n&&0!==n}(t))return function(e,t){const n=[];if(t.length<e.length)throw new b(j.missingInjectionDecorator,`Found unexpected missing metadata on type \"${e.name}\". \"${e.name}\" constructor requires at least ${e.length.toString()} arguments, found ${t.length.toString()} instead.\\nAre you using @inject, @multiInject or @unmanaged decorators in every non optional constructor argument?\\n\\nIf you're using typescript and want to rely on auto injection, set \"emitDecoratorMetadata\" compiler option to true`);for(let e=0;e<t.length;++e)void 0===t[e]&&n.push(e);if(n.length>0)throw new b(j.missingInjectionDecorator,`Found unexpected missing metadata on type \"${e.name}\" at constructor indexes \"${n.join('\", \"')}\".\\n\\nAre you using @inject, @multiInject or @unmanaged decorators at those indexes?\\n\\nIf you're using typescript and want to rely on auto injection, set \"emitDecoratorMetadata\" compiler option to true`)}(t,n.constructorArguments),n;!function(e,t){const n=[];for(let i=0;i<t.constructorArguments.length;++i){const o=t.constructorArguments[i];void 0!==o&&o.kind!==T.unknown||n.push(`  - Missing or incomplete metadata for type \"${e.name}\" at constructor argument with index ${i.toString()}.\\nEvery constructor parameter must be decorated either with @inject, @multiInject or @unmanaged decorator.`)}for(const[i,o]of t.properties)o.kind===T.unknown&&n.push(`  - Missing or incomplete metadata for type \"${e.name}\" at property \"${i.toString()}\".\\nThis property must be decorated either with @inject or @multiInject decorator.`);if(0===n.length)throw new b(j.unknown,`Unexpected class metadata for type \"${e.name}\" with uncompletion traces.\\nThis might be caused by one of the following reasons:\\n\\n1. A third party library is targeting inversify reflection metadata.\\n2. A bug is causing the issue. Consider submiting an issue to fix it.`);throw new b(j.missingInjectionDecorator,`Invalid class metadata at type ${e.name}:\\n\\n${n.join(\"\\n\\n\")}`)}(t,n)}function A(){return 0}function $(e){return n=>{void 0!==n&&n.kind===T.unknown&&t(e,I,A,(e=>e-1))}}function x(e,t){return(...n)=>i=>{if(void 0===i)return e(...n);if(i.kind===C.unmanaged)throw new b(j.injectionDecoratorConflict,\"Unexpected injection found. Multiple @inject, @multiInject or @unmanaged decorators found\");return t(i,...n)}}function B(e){if(e.kind!==T.unknown&&!0!==e.isFromTypescriptParamType)throw new b(j.injectionDecoratorConflict,\"Unexpected injection found. Multiple @inject, @multiInject or @unmanaged decorators found\")}!function(e){e[e.injectionDecoratorConflict=0]=\"injectionDecoratorConflict\",e[e.missingInjectionDecorator=1]=\"missingInjectionDecorator\",e[e.planning=2]=\"planning\",e[e.resolution=3]=\"resolution\",e[e.unknown=4]=\"unknown\"}(j||(j={})),function(e){e[e.unknown=32]=\"unknown\"}(T||(T={})),function(e){e[e.multipleInjection=0]=\"multipleInjection\",e[e.singleInjection=1]=\"singleInjection\",e[e.unmanaged=2]=\"unmanaged\"}(C||(C={}));const R=x((function(e,t){return{kind:e,name:void 0,optional:!1,tags:new Map,value:t}}),(function(e,t,n){return B(e),{...e,kind:t,value:n}}));function k(e,t){return n=>{const i=n.properties.get(t);return n.properties.set(t,e(i)),n}}var P;function D(e,t,n,i){if(b.isErrorOfKind(i,j.injectionDecoratorConflict)){const o=function(e,t,n){if(void 0===n){if(void 0===t)throw new b(j.unknown,\"Unexpected undefined property and index values\");return{kind:P.property,property:t,targetClass:e.constructor}}return\"number\"==typeof n?{index:n,kind:P.parameter,targetClass:e}:{kind:P.method,method:t,targetClass:e}}(e,t,n);throw new b(j.injectionDecoratorConflict,`Unexpected injection error.\\n\\nCause:\\n\\n${i.message}\\n\\nDetails\\n\\n${function(e){switch(e.kind){case P.method:return`[class: \"${e.targetClass.name}\", method: \"${e.method.toString()}\"]`;case P.parameter:return`[class: \"${e.targetClass.name}\", index: \"${e.index.toString()}\"]`;case P.property:return`[class: \"${e.targetClass.name}\", property: \"${e.property.toString()}\"]`}}(o)}`,{cause:i})}throw i}function V(e,n){return(i,o,r)=>{try{void 0===r?function(e,n){const i=F(e,n);return(e,n)=>{t(e.constructor,y,M,k(i(e),n))}}(e,n)(i,o):\"number\"==typeof r?function(e,n){const i=F(e,n);return(e,n,o)=>{if(!function(e,t){return\"function\"==typeof e&&void 0===t}(e,n))throw new b(j.injectionDecoratorConflict,`Found an @inject decorator in a non constructor parameter.\\nFound @inject decorator at method \"${n?.toString()??\"\"}\" at class \"${e.constructor.name}\"`);t(e,y,M,function(e,t){return n=>{const i=n.constructorArguments[t];return n.constructorArguments[t]=e(i),n}}(i(e),o))}}(e,n)(i,o,r):function(e,n){const i=F(e,n);return(e,n,o)=>{if(!function(e){return void 0!==e.set}(o))throw new b(j.injectionDecoratorConflict,`Found an @inject decorator in a non setter property method.\\nFound @inject decorator at method \"${n.toString()}\" at class \"${e.constructor.name}\"`);t(e.constructor,y,M,k(i(e),n))}}(e,n)(i,o,r)}catch(e){D(i,o,r,e)}}}function F(e,t){return n=>{const i=t(n);return t=>(i(t),e(t))}}function O(e){return V(R(C.singleInjection,e),$)}!function(e){e[e.method=0]=\"method\",e[e.parameter=1]=\"parameter\",e[e.property=2]=\"property\"}(P||(P={}));const N=\"@inversifyjs/core/classIsInjectableFlagReflectKey\";const E=[Array,BigInt,Boolean,Function,Number,Object,String];function U(n){const i=e(n,\"design:paramtypes\");void 0!==i&&t(n,y,M,function(e){return t=>(e.forEach(((e,n)=>{var i;void 0!==t.constructorArguments[n]||(i=e,E.includes(i))||(t.constructorArguments[n]=function(e){return{isFromTypescriptParamType:!0,kind:C.singleInjection,name:void 0,optional:!1,tags:new Map,value:e}}(e))})),t)}(i))}function K(i){return o=>{!function(t){if(void 0!==e(t,N))throw new b(j.injectionDecoratorConflict,`Cannot apply @injectable decorator multiple times at class \"${t.name}\"`);n(t,N,!0)}(o),U(o),void 0!==i&&t(o,y,M,(e=>({...e,scope:i})))}}function q(e,t,n){let i;return e.extendConstructorArguments??!0?(i=[...t.constructorArguments],n.constructorArguments.map(((e,t)=>{i[t]=e}))):i=n.constructorArguments,i}function z(e,t,n){let i;return i=e.extendProperties??!0?new Map(u(t.properties,n.properties)):n.properties,i}function G(e){return n=>{const i=S(e.type);t(n,y,M,function(e,t){const n=n=>({constructorArguments:q(e,t,n),lifecycle:n.lifecycle,properties:z(e,t,n),scope:n.scope});return n}(e,i))}}function H(e){return t=>{const n=i(t);if(void 0===n)throw new b(j.injectionDecoratorConflict,`Expected base type for type \"${t.name}\", none found.`);G({...e,type:n})(t)}}function J(e){return V(R(C.multipleInjection,e),$)}function L(e){return n=>{void 0===n&&t(e,I,A,(e=>e+1))}}function Q(e){return t=>{const n=t??{kind:T.unknown,name:void 0,optional:!1,tags:new Map};if(n.kind===C.unmanaged)throw new b(j.injectionDecoratorConflict,\"Unexpected injection found. Found @unmanaged injection with additional @named, @optional, @tagged or @targetName injections\");return e(n)}}function W(e){const t=Q(function(e){return t=>{if(void 0!==t.name)throw new b(j.injectionDecoratorConflict,\"Unexpected duplicated named decorator\");return t.name=e,t}}(e));return V(t,L)}function X(e){if(e.optional)throw new b(j.injectionDecoratorConflict,\"Unexpected duplicated optional decorator\");return e.optional=!0,e}function Y(){return V(Q(X),L)}function Z(){return(e,n,i)=>{try{t(e.constructor,y,M,(o=n,e=>{if(void 0!==e.lifecycle.postConstructMethodName)throw new b(j.injectionDecoratorConflict,\"Unexpected duplicated postConstruct decorator\");return e.lifecycle.postConstructMethodName=o,e}))}catch(t){D(e,n,void 0,t)}var o}}function _(){return(e,n,i)=>{try{t(e.constructor,y,M,(o=n,e=>{if(void 0!==e.lifecycle.preDestroyMethodName)throw new b(j.injectionDecoratorConflict,\"Unexpected duplicated preDestroy decorator\");return e.lifecycle.preDestroyMethodName=o,e}))}catch(t){D(e,n,void 0,t)}var o}}function ee(e,t){const n=Q(function(e,t){return n=>{if(n.tags.has(e))throw new b(j.injectionDecoratorConflict,\"Unexpected duplicated tag decorator with existing tag\");return n.tags.set(e,t),n}}(e,t));return V(n,L)}function te(){return{kind:C.unmanaged}}const ne=x(te,(function(e){if(B(e),function(e){return void 0!==e.name||e.optional||e.tags.size>0}(e))throw new b(j.injectionDecoratorConflict,\"Unexpected injection found. Found @unmanaged injection with additional @named, @optional, @tagged or @targetName injections\");return te()}));function ie(){return V(ne(),$)}var oe;!function(e){e[e.multipleInjection=0]=\"multipleInjection\",e[e.singleInjection=1]=\"singleInjection\"}(oe||(oe={}));class re{#p;constructor(e){this.#p=e}get name(){return this.#p.elem.name}get serviceIdentifier(){return this.#p.elem.serviceIdentifier}get tags(){return this.#p.elem.tags}getAncestor(){if(void 0!==this.#p.previous)return new re(this.#p.previous)}}class ae{last;constructor(e){this.last=e}concat(e){return new ae({elem:e,previous:this.last})}[Symbol.iterator](){let e=this.last;return{next:()=>{if(void 0===e)return{done:!0,value:void 0};const t=e.elem;return e=e.previous,{done:!1,value:t}}}}}function se(e,t,n){const i=n?.customServiceIdentifier??t.serviceIdentifier,o=[...e.getBindings(i)??[]].filter((e=>e.isSatisfiedBy(t)));if(0===o.length&&void 0!==e.autobindOptions&&\"function\"==typeof i){const t=function(e,t){return{cache:{isRight:!1,value:void 0},id:0,implementationType:t,isSatisfiedBy:()=>!0,moduleId:void 0,onActivation:void 0,onDeactivation:void 0,scope:e.scope,serviceIdentifier:t,type:c.Instance}}(e.autobindOptions,i);e.setBinding(t),o.push(t)}return o}function ce(e){return void 0!==e.redirections}function ue(e,t,n,i){let r,a;ce(n)?(r=n.binding.targetServiceIdentifier,a=n.binding.serviceIdentifier):(r=n.serviceIdentifier,a=n.parent?.binding.serviceIdentifier),Array.isArray(e)?function(e,t,n,i,r){if(0!==e.length){const t=`Ambiguous bindings found for service: \"${o(n)}\".\\n\\nRegistered bindings:\\n\\n${e.map((e=>function(e){switch(e.type){case c.Instance:return`[ type: \"${e.type}\", serviceIdentifier: \"${o(e.serviceIdentifier)}\", scope: \"${e.scope}\", implementationType: \"${e.implementationType.name}\" ]`;case c.ServiceRedirection:return`[ type: \"${e.type}\", serviceIdentifier: \"${o(e.serviceIdentifier)}\", redirection: \"${o(e.targetServiceIdentifier)}\" ]`;default:return`[ type: \"${e.type}\", serviceIdentifier: \"${o(e.serviceIdentifier)}\", scope: \"${e.scope}\" ]`}}(e.binding))).join(\"\\n\")}\\n\\nTrying to resolve bindings for \"${le(n,i)}\".\\n\\n${pe(r)}`;throw new b(j.planning,t)}t||de(n,i,r)}(e,t,r,a,i):function(e,t,n,i,o){if(void 0!==e||t)return;de(n,i,o)}(e,t,r,a,i)}function de(e,t,n){const i=`No bindings found for service: \"${o(e)}\".\\n\\nTrying to resolve bindings for \"${le(e,t)}\".\\n\\n${pe(n)}`;throw new b(j.planning,i)}function le(e,t){return void 0===t?`${o(e)} (Root service)`:o(t)}function pe(e){const t=0===e.tags.size?\"\":`\\n- tags:\\n  - ${[...e.tags.keys()].map((e=>e.toString())).join(\"\\n  - \")}`;return`Binding constraints:\\n- service identifier: ${o(e.serviceIdentifier)}\\n- name: ${e.name?.toString()??\"-\"}${t}`}function fe(e,t,n){if(1!==e.redirections.length)ue(e.redirections,t,e,n);else{const[i]=e.redirections;ce(i)&&fe(i,t,n)}}function ge(e,t,n){if(Array.isArray(e.bindings)&&1===e.bindings.length){const[i]=e.bindings;ce(i)&&fe(i,t,n)}else ue(e.bindings,t,e,n)}function me(e,t){if(function(e){return e instanceof Error&&(e instanceof RangeError&&/stack space|call stack|too much recursion/i.test(e.message)||\"InternalError\"===e.name&&/too much recursion/.test(e.message))}(t)){const n=function(e){const t=[...e];if(0===t.length)return\"(No dependency trace)\";return t.map(o).join(\" -> \")}(function(e){const t=new Set;for(const n of e.servicesBranch){if(t.has(n))return[...t,n];t.add(n)}return[...t]}(e));throw new b(j.planning,`Circular dependency found: ${n}`,{cause:t})}throw t}function he(e){try{const t=new Map;void 0!==e.rootConstraints.tag&&t.set(e.rootConstraints.tag.key,e.rootConstraints.tag.value);const n=new ae({elem:{name:e.rootConstraints.name,serviceIdentifier:e.rootConstraints.serviceIdentifier,tags:t},previous:void 0}),i=new re(n.last),o=se(e,i),r=[],a={bindings:r,parent:void 0,serviceIdentifier:e.rootConstraints.serviceIdentifier};if(r.push(...we(e,n,o,a)),!e.rootConstraints.isMultiple){ge(a,e.rootConstraints.isOptional??!1,i);const[t]=r;a.bindings=t}return{tree:{root:a}}}catch(t){me(e,t)}}function ve(e,t,n,i){const o={binding:t,classMetadata:e.getClassMetadata(t.implementationType),constructorParams:[],parent:i,propertyParams:new Map};return je({autobindOptions:e.autobindOptions,getBindings:e.getBindings,getClassMetadata:e.getClassMetadata,node:o,servicesBranch:e.servicesBranch,setBinding:e.setBinding},n)}function ye(e,t,n){if(n.kind===C.unmanaged)return;const i=r.is(n.value)?n.value.unwrap():n.value,o=t.concat({name:n.name,serviceIdentifier:i,tags:n.tags}),a=new re(o.last),s=se(e,a),c=[],u={bindings:c,parent:e.node,serviceIdentifier:i};if(c.push(...we(e,o,s,u)),n.kind===C.singleInjection){ge(u,n.optional,a);const[e]=c;u.bindings=e}return u}function Me(e,t,n){const i=r.is(n.value)?n.value.unwrap():n.value,o=t.concat({name:n.name,serviceIdentifier:i,tags:n.tags}),a=new re(o.last),s=se(e,a),c=[],u={bindings:c,parent:e.node,serviceIdentifier:i};if(c.push(...we(e,o,s,u)),n.kind===oe.singleInjection){ge(u,n.optional,a);const[e]=c;u.bindings=e}return u}function Ie(e,t,n,i){const o={binding:t,params:[],parent:i};return je({autobindOptions:e.autobindOptions,getBindings:e.getBindings,getClassMetadata:e.getClassMetadata,node:o,servicesBranch:e.servicesBranch,setBinding:e.setBinding},n)}function we(e,t,n,i){const o=ce(i)?i.binding.targetServiceIdentifier:i.serviceIdentifier;e.servicesBranch.push(o);const r=[];for(const o of n)switch(o.type){case c.Instance:r.push(ve(e,o,t,i));break;case c.ResolvedValue:r.push(Ie(e,o,t,i));break;case c.ServiceRedirection:{const n=be(e,t,o,i);r.push(n);break}default:r.push({binding:o,parent:i})}return e.servicesBranch.pop(),r}function be(e,t,n,i){const o={binding:n,parent:i,redirections:[]},r=se(e,new re(t.last),{customServiceIdentifier:n.targetServiceIdentifier});return o.redirections.push(...we(e,t,r,o)),o}function je(e,t){return e.node.binding.type===c.Instance?function(e,t,n){const i=t.classMetadata;for(const[o,r]of i.constructorArguments.entries())t.constructorParams[o]=ye(e,n,r);for(const[o,r]of i.properties){const i=ye(e,n,r);void 0!==i&&t.propertyParams.set(o,i)}return e.node}(e,e.node,t):function(e,t,n){const i=t.binding.metadata;for(const[o,r]of i.arguments.entries())t.params[o]=Me(e,n,r);return e.node}(e,e.node,t)}var Te;!function(e){e[e.singleMandatory=0]=\"singleMandatory\",e[e.singleOptional=1]=\"singleOptional\",e[e.multipleMandatory=2]=\"multipleMandatory\",e[e.multipleOptional=3]=\"multipleOptional\",e[e.length=4]=\"length\"}(Te||(Te={}));class Ce{#f;#g;#m;#h;#v;constructor(){this.#f=this.#y(),this.#g=this.#y(),this.#h=this.#y(),this.#m=this.#y(),this.#v=[]}clearCache(){for(const e of this.#M())e.clear();for(const e of this.#v)e.clearCache()}get(e){return void 0===e.name?void 0===e.tag?this.#I(this.#f,e).get(e.serviceIdentifier):this.#I(this.#m,e).get(e.serviceIdentifier)?.get(e.tag.key)?.get(e.tag.value):void 0===e.tag?this.#I(this.#g,e).get(e.serviceIdentifier)?.get(e.name):this.#I(this.#h,e).get(e.serviceIdentifier)?.get(e.name)?.get(e.tag.key)?.get(e.tag.value)}set(e,t){void 0===e.name?void 0===e.tag?this.#I(this.#f,e).set(e.serviceIdentifier,t):this.#w(this.#w(this.#I(this.#m,e),e.serviceIdentifier),e.tag.key).set(e.tag.value,t):void 0===e.tag?this.#w(this.#I(this.#g,e),e.serviceIdentifier).set(e.name,t):this.#w(this.#w(this.#w(this.#I(this.#h,e),e.serviceIdentifier),e.name),e.tag.key).set(e.tag.value,t)}subscribe(e){this.#v.push(e)}#y(){const e=new Array(Te.length);for(let t=0;t<e.length;++t)e[t]=new Map;return e}#w(e,t){let n=e.get(t);return void 0===n&&(n=new Map,e.set(t,n)),n}#I(e,t){return e[this.#b(t)]}#M(){return[...this.#f,...this.#g,...this.#h,...this.#m]}#b(e){return e.isMultiple?!0===e.optional?Te.multipleOptional:Te.multipleMandatory:!0===e.optional?Te.singleOptional:Te.singleMandatory}}function Se(e,t){return a(t)?(e.cache={isRight:!0,value:t},t.then((t=>Ae(e,t)))):Ae(e,t)}function Ae(e,t){return e.cache={isRight:!0,value:t},t}function $e(e,t,n){const i=e.getActivations(t);return void 0===i?n:a(n)?xe(e,n,i[Symbol.iterator]()):function(e,t,n){let i=t,o=n.next();for(;!0!==o.done;){const t=o.value(e.context,i);if(a(t))return xe(e,t,n);i=t,o=n.next()}return i}(e,n,i[Symbol.iterator]())}async function xe(e,t,n){let i=await t,o=n.next();for(;!0!==o.done;)i=await o.value(e.context,i),o=n.next();return i}function Be(e,t,n){let i=n;if(void 0!==t.onActivation){const n=t.onActivation;i=a(i)?i.then((t=>n(e.context,t))):n(e.context,i)}return $e(e,t.serviceIdentifier,i)}function Re(e){return(t,n)=>{if(n.cache.isRight)return n.cache.value;return Se(n,Be(t,n,e(t,n)))}}const ke=Re((function(e,t){return t.value}));function Pe(e){return e}function De(e,t){return(n,i)=>{const o=e(i);switch(o.scope){case s.Singleton:if(o.cache.isRight)return o.cache.value;return Se(o,Be(n,o,t(n,i)));case s.Request:{if(n.requestScopeCache.has(o.id))return n.requestScopeCache.get(o.id);const e=Be(n,o,t(n,i));return n.requestScopeCache.set(o.id,e),e}case s.Transient:return Be(n,o,t(n,i))}}}const Ve=(e=>De(Pe,e))((function(e,t){return t.value(e.context)}));const Fe=Re((function(e,t){return t.factory(e.context)}));function Oe(e,t,n){const i=function(e,t,n){if(void 0===n)return;if(!(n in e))throw new b(j.resolution,`Expecting a \"${n.toString()}\" property when resolving \"${t.implementationType.name}\" class @postConstruct decorated method, none found.`);if(\"function\"!=typeof e[n])throw new b(j.resolution,`Expecting a \"${n.toString()}\" method when resolving \"${t.implementationType.name}\" class @postConstruct decorated method, a non function property was found instead.`);{let i;try{i=e[n]()}catch(e){throw new b(j.resolution,`Unexpected error found when calling \"${n.toString()}\" @postConstruct decorated method on class \"${t.implementationType.name}\"`,{cause:e})}if(a(i))return async function(e,t,n){try{await n}catch(n){throw new b(j.resolution,`Unexpected error found when calling \"${t.toString()}\" @postConstruct decorated method on class \"${e.implementationType.name}\"`,{cause:n})}}(t,n,i)}}(e,t,n);return a(i)?i.then((()=>e)):e}function Ne(e){return(t,n,i)=>{const o=new i.binding.implementationType(...t),r=e(n,o,i);return a(r)?r.then((()=>Oe(o,i.binding,i.classMetadata.lifecycle.postConstructMethodName))):Oe(o,i.binding,i.classMetadata.lifecycle.postConstructMethodName)}}const Ee=Re((function(e,t){return t.provider(e.context)}));function Ue(e){return e.binding}function Ke(e){return e.binding}const qe=function(e){return(t,n,i)=>{const o=[];for(const[r,s]of i.propertyParams){const c=i.classMetadata.properties.get(r);if(void 0===c)throw new b(j.resolution,`Expecting metadata at property \"${r.toString()}\", none found`);c.kind!==C.unmanaged&&void 0!==s.bindings&&(n[r]=e(t,s),a(n[r])&&o.push((async()=>{n[r]=await n[r]})()))}if(o.length>0)return Promise.all(o).then((()=>{}))}}(Xe),ze=function(e){return function t(n,i){const o=[];for(const r of i.redirections)ce(r)?o.push(...t(n,r)):o.push(e(n,r));return o}}(We),Ge=function(e,t,n){return(i,o)=>{const r=e(i,o);return a(r)?t(r,i,o):n(r,i,o)}}(function(e){return(t,n)=>{const i=[];for(const o of n.constructorParams)void 0===o?i.push(void 0):i.push(e(t,o));return i.some(a)?Promise.all(i):i}}(Xe),function(e){return async(t,n,i)=>{const o=await t;return e(o,n,i)}}(Ne(qe)),Ne(qe)),He=function(e){return(t,n)=>{const i=e(t,n);return a(i)?i.then((e=>n.binding.factory(...e))):n.binding.factory(...i)}}(function(e){return(t,n)=>{const i=[];for(const o of n.params)i.push(e(t,o));return i.some(a)?Promise.all(i):i}}(Xe)),Je=(e=>De(Ue,e))(Ge),Le=(e=>De(Ke,e))(He);function Qe(e){return Xe(e,e.planResult.tree.root)}function We(e,t){switch(t.binding.type){case c.ConstantValue:return ke(e,t.binding);case c.DynamicValue:return Ve(e,t.binding);case c.Factory:return Fe(e,t.binding);case c.Instance:return Je(e,t);case c.Provider:return Ee(e,t.binding);case c.ResolvedValue:return Le(e,t)}}function Xe(e,t){if(void 0!==t.bindings)return Array.isArray(t.bindings)?function(e,t){const n=[];for(const i of t)ce(i)?n.push(...ze(e,i)):n.push(We(e,i));if(n.some(a))return Promise.all(n);return n}(e,t.bindings):function(e,t){if(ce(t)){const n=ze(e,t);if(1===n.length)return n[0];throw new b(j.resolution,\"Unexpected multiple resolved values on single injection\")}return We(e,t)}(e,t.bindings)}function Ye(e){return void 0!==e.scope}function Ze(e,t){if(void 0!==e.lifecycle.preDestroyMethodName&&\"function\"==typeof t[e.lifecycle.preDestroyMethodName])return t[e.lifecycle.preDestroyMethodName]()}function _e(e,t,n){const i=e.getDeactivations(t);if(void 0!==i)return a(n)?et(n,i[Symbol.iterator]()):function(e,t){let n=t.next();for(;!0!==n.done;){const i=n.value(e);if(a(i))return et(e,t);n=t.next()}}(n,i[Symbol.iterator]())}async function et(e,t){const n=await e;let i=t.next();for(;!0!==i.done;)await i.value(n),i=t.next()}function tt(e,t){const n=function(e,t){if(t.type===c.Instance){const n=e.getClassMetadata(t.implementationType),i=t.cache.value;return a(i)?i.then((e=>Ze(n,e))):Ze(n,i)}}(e,t);return void 0===n?nt(e,t):n.then((()=>nt(e,t)))}function nt(e,t){const n=t.cache;return a(n.value)?n.value.then((n=>it(e,t,n))):it(e,t,n.value)}function it(e,t,n){let i;if(void 0!==t.onDeactivation){i=(0,t.onDeactivation)(n)}return void 0===i?_e(e,t.serviceIdentifier,n):i.then((()=>_e(e,t.serviceIdentifier,n)))}function ot(e,t){if(void 0===t)return;const n=function(e){const t=[];for(const n of e)Ye(n)&&n.scope===s.Singleton&&n.cache.isRight&&t.push(n);return t}(t),i=[];for(const t of n){const n=tt(e,t);void 0!==n&&i.push(n)}return i.length>0?Promise.all(i).then((()=>{})):void 0}function rt(e,t){const n=e.getBindingsFromModule(t);return ot(e,n)}function at(e,t){const n=e.getBindings(t);return ot(e,n)}export{g as ActivationsService,m as BindingService,C as ClassElementMetadataKind,h as DeactivationsService,Ce as PlanResultCacheService,oe as ResolvedValueElementMetadataKind,s as bindingScopeValues,c as bindingTypeValues,v as decorate,S as getClassMetadata,O as inject,H as injectFromBase,K as injectable,J as multiInject,W as named,Y as optional,he as plan,Z as postConstruct,_ as preDestroy,Qe as resolve,ot as resolveBindingsDeactivations,rt as resolveModuleDeactivations,at as resolveServiceDeactivations,ee as tagged,ie as unmanaged};\n//# sourceMappingURL=index.js.map\n","import\"reflect-metadata\";import{getOwnReflectMetadata as i,setReflectMetadata as e,updateOwnReflectMetadata as n}from\"@inversifyjs/reflect-metadata-utils\";import{LazyServiceIdentifier as t,isPromise as s,stringifyServiceIdentifier as r}from\"@inversifyjs/common\";import{getClassMetadata as a,bindingTypeValues as o,bindingScopeValues as d,ResolvedValueElementMetadataKind as c,PlanResultCacheService as l,ActivationsService as u,BindingService as h,DeactivationsService as v,resolveServiceDeactivations as g,plan as b,resolve as f,resolveModuleDeactivations as S,resolveBindingsDeactivations as p}from\"@inversifyjs/core\";const y=\"@inversifyjs/container/bindingId\";class m{#i;#e;constructor(t){this.#i=function(){const t=i(Object,y)??0;return t===Number.MAX_SAFE_INTEGER?e(Object,y,Number.MIN_SAFE_INTEGER):n(Object,y,(()=>t),(i=>i+1)),t}(),this.#e=t}get id(){return this.#i}load(i){return this.#e(i)}}const w=Symbol.for(\"@inversifyjs/container/bindingIdentifier\");function I(i){return\"object\"==typeof i&&null!==i&&!0===i[w]}class A{static always=i=>!0}const P=\"@inversifyjs/container/bindingId\";function B(){const t=i(Object,P)??0;return t===Number.MAX_SAFE_INTEGER?e(Object,P,Number.MIN_SAFE_INTEGER):n(Object,P,(()=>t),(i=>i+1)),t}function C(i){return{[w]:!0,id:i.id}}function R(i){return e=>{for(let n=e.getAncestor();void 0!==n;n=n.getAncestor())if(i(n))return!0;return!1}}function M(i){return e=>e.name===i}function x(i){return e=>e.serviceIdentifier===i}function O(i,e){return n=>n.tags.has(i)&&n.tags.get(i)===e}function N(i){return void 0===i.name&&0===i.tags.size}function F(i){const e=R(i);return i=>!e(i)}function U(i){return e=>{const n=e.getAncestor();return void 0===n||!i(n)}}function j(i){return e=>{const n=e.getAncestor();return void 0!==n&&i(n)}}class k{#n;constructor(i){this.#n=i}getIdentifier(){return C(this.#n)}inRequestScope(){return this.#n.scope=d.Request,new V(this.#n)}inSingletonScope(){return this.#n.scope=d.Singleton,new V(this.#n)}inTransientScope(){return this.#n.scope=d.Transient,new V(this.#n)}}class D{#t;#s;#r;#a;constructor(i,e,n,t){this.#t=i,this.#s=e,this.#r=n,this.#a=t}to(i){const e=a(i),n={cache:{isRight:!1,value:void 0},id:B(),implementationType:i,isSatisfiedBy:A.always,moduleId:this.#s,onActivation:void 0,onDeactivation:void 0,scope:e.scope??this.#r,serviceIdentifier:this.#a,type:o.Instance};return this.#t(n),new _(n)}toSelf(){if(\"function\"!=typeof this.#a)throw new Error('\"toSelf\" function can only be applied when a newable function is used as service identifier');return this.to(this.#a)}toConstantValue(i){const e={cache:{isRight:!1,value:void 0},id:B(),isSatisfiedBy:A.always,moduleId:this.#s,onActivation:void 0,onDeactivation:void 0,scope:d.Singleton,serviceIdentifier:this.#a,type:o.ConstantValue,value:i};return this.#t(e),new V(e)}toDynamicValue(i){const e={cache:{isRight:!1,value:void 0},id:B(),isSatisfiedBy:A.always,moduleId:this.#s,onActivation:void 0,onDeactivation:void 0,scope:this.#r,serviceIdentifier:this.#a,type:o.DynamicValue,value:i};return this.#t(e),new _(e)}toResolvedValue(i,e){const n={cache:{isRight:!1,value:void 0},factory:i,id:B(),isSatisfiedBy:A.always,metadata:this.#o(e),moduleId:this.#s,onActivation:void 0,onDeactivation:void 0,scope:this.#r,serviceIdentifier:this.#a,type:o.ResolvedValue};return this.#t(n),new _(n)}toFactory(i){const e={cache:{isRight:!1,value:void 0},factory:i,id:B(),isSatisfiedBy:A.always,moduleId:this.#s,onActivation:void 0,onDeactivation:void 0,scope:d.Singleton,serviceIdentifier:this.#a,type:o.Factory};return this.#t(e),new V(e)}toProvider(i){const e={cache:{isRight:!1,value:void 0},id:B(),isSatisfiedBy:A.always,moduleId:this.#s,onActivation:void 0,onDeactivation:void 0,provider:i,scope:d.Singleton,serviceIdentifier:this.#a,type:o.Provider};return this.#t(e),new V(e)}toService(i){const e={id:B(),isSatisfiedBy:A.always,moduleId:this.#s,serviceIdentifier:this.#a,targetServiceIdentifier:i,type:o.ServiceRedirection};this.#t(e)}#o(i){return{arguments:(i??[]).map((i=>function(i){return\"object\"==typeof i&&!t.is(i)}(i)?{kind:!0===i.isMultiple?c.multipleInjection:c.singleInjection,name:i.name,optional:i.optional??!1,tags:new Map((i.tags??[]).map((i=>[i.key,i.value]))),value:i.serviceIdentifier}:{kind:c.singleInjection,name:void 0,optional:!1,tags:new Map,value:i}))}}}class E{#n;constructor(i){this.#n=i}getIdentifier(){return C(this.#n)}onActivation(i){return this.#n.onActivation=i,new T(this.#n)}onDeactivation(i){return this.#n.onDeactivation=i,new T(this.#n)}}class T{#n;constructor(i){this.#n=i}getIdentifier(){return C(this.#n)}when(i){return this.#n.isSatisfiedBy=i,new E(this.#n)}whenAnyAncestor(i){return this.when(R(i))}whenAnyAncestorIs(i){return this.when(R(x(i)))}whenAnyAncestorNamed(i){return this.when(function(i){return R(M(i))}(i))}whenAnyAncestorTagged(i,e){return this.when(function(i,e){return R(O(i,e))}(i,e))}whenDefault(){return this.when(N)}whenNamed(i){return this.when(M(i))}whenNoParent(i){return this.when(U(i))}whenNoParentIs(i){return this.when(U(x(i)))}whenNoParentNamed(i){return this.when(function(i){return U(M(i))}(i))}whenNoParentTagged(i,e){return this.when(function(i,e){return U(O(i,e))}(i,e))}whenParent(i){return this.when(j(i))}whenParentIs(i){return this.when(j(x(i)))}whenParentNamed(i){return this.when(function(i){return j(M(i))}(i))}whenParentTagged(i,e){return this.when(function(i,e){return j(O(i,e))}(i,e))}whenTagged(i,e){return this.when(O(i,e))}whenNoAncestor(i){return this.when(F(i))}whenNoAncestorIs(i){return this.when(F(x(i)))}whenNoAncestorNamed(i){return this.when(function(i){return F(M(i))}(i))}whenNoAncestorTagged(i,e){return this.when(function(i,e){return F(O(i,e))}(i,e))}}class V extends T{#d;constructor(i){super(i),this.#d=new E(i)}onActivation(i){return this.#d.onActivation(i)}onDeactivation(i){return this.#d.onDeactivation(i)}}class _ extends V{#c;constructor(i){super(i),this.#c=new k(i)}inRequestScope(){return this.#c.inRequestScope()}inSingletonScope(){return this.#c.inSingletonScope()}inTransientScope(){return this.#c.inTransientScope()}}const G=Symbol.for(\"@inversifyjs/container/InversifyContainerError\");class q extends Error{[G];kind;constructor(i,e,n){super(e,n),this[G]=!0,this.kind=i}static is(i){return\"object\"==typeof i&&null!==i&&!0===i[G]}static isErrorOfKind(i,e){return q.is(i)&&i.kind===e}}var $;!function(i){i[i.invalidOperation=0]=\"invalidOperation\"}($||($={}));const L=d.Transient;class X{#l;#u;#h;#v;#g;#b;#f;#S;#p;#y;#m;constructor(i){this.#h=this.#w(),this.#g=i=>this.#l.get(i),this.#S=new l,this.#p=this.#I(),void 0===i?.parent?(this.#l=u.build(void 0),this.#u=h.build(void 0),this.#v=v.build(void 0)):(this.#l=u.build(i.parent.#l),this.#u=h.build(i.parent.#u),this.#v=v.build(i.parent.#v),i.parent.#S.subscribe(this.#S)),this.#b=this.#u.get.bind(this.#u),this.#y=this.#A.bind(this),this.#f={autobind:i?.autobind??!1,defaultScope:i?.defaultScope??L},this.#m=[]}bind(i){return new D((i=>{this.#A(i)}),void 0,this.#f.defaultScope,i)}get(i,e){const n=this.#P(!1,i,e),t=this.#B(n);if(s(t))throw new q($.invalidOperation,`Unexpected asyncronous service when resolving service \"${r(i)}\"`);return t}getAll(i,e){const n=this.#P(!0,i,e),t=this.#B(n);if(s(t))throw new q($.invalidOperation,`Unexpected asyncronous service when resolving service \"${r(i)}\"`);return t}async getAllAsync(i,e){const n=this.#P(!0,i,e);return this.#B(n)}async getAsync(i,e){const n=this.#P(!1,i,e);return this.#B(n)}isBound(i,e){const n=this.#u.get(i);return this.#C(i,n,e)}isCurrentBound(i,e){const n=this.#u.getNonParentBindings(i);return this.#C(i,n,e)}async load(...i){await Promise.all(this.#e(...i))}loadSync(...i){const e=this.#e(...i);for(const i of e)if(void 0!==i)throw new q($.invalidOperation,\"Unexpected asyncronous module load. Consider using Container.load() instead.\")}onActivation(i,e){this.#l.add(e,{serviceId:i})}onDeactivation(i,e){this.#v.add(e,{serviceId:i})}restore(){const i=this.#m.pop();if(void 0===i)throw new q($.invalidOperation,\"No snapshot available to restore\");this.#l=i.activationService,this.#u=i.bindingService,this.#v=i.deactivationService,this.#R()}async rebind(i){return await this.unbind(i),this.bind(i)}rebindSync(i){return this.unbindSync(i),this.bind(i)}snapshot(){this.#m.push({activationService:this.#l.clone(),bindingService:this.#u.clone(),deactivationService:this.#v.clone()})}async unbind(i){await this.#M(i)}async unbindAll(){const i=[...this.#u.getNonParentBoundServices()];await Promise.all(i.map((async i=>g(this.#h,i))));for(const e of i)this.#l.removeAllByServiceId(e),this.#u.removeAllByServiceId(e),this.#v.removeAllByServiceId(e);this.#S.clearCache()}unbindSync(i){void 0!==this.#M(i)&&this.#x(i)}async unload(...i){await Promise.all(this.#O(...i)),this.#N(i)}unloadSync(...i){const e=this.#O(...i);for(const i of e)if(void 0!==i)throw new q($.invalidOperation,\"Unexpected asyncronous module unload. Consider using Container.unload() instead.\");this.#N(i)}#F(i){return{bind:e=>new D((i=>{this.#A(i)}),i,this.#f.defaultScope,e),isBound:this.isBound.bind(this),onActivation:(e,n)=>{this.#l.add(n,{moduleId:i,serviceId:e})},onDeactivation:(e,n)=>{this.#v.add(n,{moduleId:i,serviceId:e})},rebind:this.rebind.bind(this),rebindSync:this.rebindSync.bind(this),unbind:this.unbind.bind(this),unbindSync:this.unbindSync.bind(this)}}#w(){return{getBindings:i=>this.#u.get(i),getBindingsFromModule:i=>this.#u.getByModuleId(i),getClassMetadata:a,getDeactivations:i=>this.#v.get(i)}}#U(i,e,n){return{isMultiple:i,name:n?.name,optional:n?.optional,serviceIdentifier:e,tag:n?.tag}}#j(i,e,n){const t={autobindOptions:n?.autobind??this.#f.autobind?{scope:this.#f.defaultScope}:void 0,getBindings:this.#b,getClassMetadata:a,rootConstraints:{isMultiple:e,serviceIdentifier:i},servicesBranch:[],setBinding:this.#y};return this.#k(t,n),t}#P(i,e,n){const t=this.#U(i,e,n),s=this.#S.get(t);if(void 0!==s)return s;const r=b(this.#j(e,i,n));return this.#S.set(t,r),r}#I(){return{get:this.get.bind(this),getAll:this.getAll.bind(this),getAllAsync:this.getAllAsync.bind(this),getAsync:this.getAsync.bind(this)}}#B(i){return f({context:this.#p,getActivations:this.#g,planResult:i,requestScopeCache:new Map})}#k(i,e){void 0!==e&&(void 0!==e.name&&(i.rootConstraints.name=e.name),!0===e.optional&&(i.rootConstraints.isOptional=!0),void 0!==e.tag&&(i.rootConstraints.tag={key:e.tag.key,value:e.tag.value}))}#C(i,e,n){if(void 0===e)return!1;const t={getAncestor:()=>{},name:n?.name,serviceIdentifier:i,tags:new Map};void 0!==n?.tag&&t.tags.set(n.tag.key,n.tag.value);for(const i of e)if(i.isSatisfiedBy(t))return!0;return!1}#e(...i){return i.map((i=>i.load(this.#F(i.id))))}#O(...i){return i.map((i=>S(this.#h,i.id)))}#R(){this.#S.clearCache(),this.#g=i=>this.#l.get(i),this.#b=this.#u.get.bind(this.#u),this.#p=this.#I(),this.#y=this.#A.bind(this)}#A(i){this.#u.set(i),this.#S.clearCache()}#x(i){let e;if(I(i)){const t=this.#u.getById(i.id),s=(n=t,function(i){if(void 0===i)return;const e=i.next();return!0!==e.done?e.value:void 0}(n?.[Symbol.iterator]()))?.serviceIdentifier;e=void 0===s?\"Unexpected asyncronous deactivation when unbinding binding identifier. Consider using Container.unbind() instead.\":`Unexpected asyncronous deactivation when unbinding \"${r(s)}\" binding. Consider using Container.unbind() instead.`}else e=`Unexpected asyncronous deactivation when unbinding \"${r(i)}\" service. Consider using Container.unbind() instead.`;var n;throw new q($.invalidOperation,e)}#M(i){return I(i)?this.#D(i):this.#E(i)}#D(i){const e=this.#u.getById(i.id),n=p(this.#h,e);if(void 0!==n)return n.then((()=>{this.#T(i)}));this.#T(i)}#T(i){this.#u.removeById(i.id),this.#S.clearCache()}#N(i){for(const e of i)this.#l.removeAllByModuleId(e.id),this.#u.removeAllByModuleId(e.id),this.#v.removeAllByModuleId(e.id);this.#S.clearCache()}#E(i){const e=g(this.#h,i);if(void 0!==e)return e.then((()=>{this.#V(i)}));this.#V(i)}#V(i){this.#l.removeAllByServiceId(i),this.#u.removeAllByServiceId(i),this.#v.removeAllByServiceId(i),this.#S.clearCache()}}export{X as Container,m as ContainerModule,q as InversifyContainerError,$ as InversifyContainerErrorKind};\n//# sourceMappingURL=index.js.map\n","const TYPES = {\n    AudioContextManager: Symbol.for(\"AudioContextManager\"),\n    AudioEditor: Symbol.for(\"AudioEditor\"),\n    AudioProcessor: Symbol.for(\"AudioProcessor\"),\n    BufferManager: Symbol.for(\"BufferManager\"),\n    FilterManager: Symbol.for(\"FilterManager\"),\n    RendererManager: Symbol.for(\"RendererManager\"),\n    SaveBufferManager: Symbol.for(\"SaveBufferManager\"),\n    ConfigService: Symbol.for(\"ConfigService\"),\n    EventEmitter: Symbol.for(\"EventEmitter\"),\n    BufferPlayer: Symbol.for(\"BufferPlayer\"),\n    BufferDecoderService: Symbol.for(\"BufferDecoderService\"),\n    BufferFetcherService: Symbol.for(\"BufferFetcherService\"),\n    AudioBuffersToFetch: Symbol.for(\"AudioBuffersToFetch\"),\n    Renderers: Symbol.for(\"Renderers\"),\n    Filters: Symbol.for(\"Filters\"),\n    EntryPointFilter: Symbol.for(\"EntryPointFilter\"),\n    VoiceRecorder: Symbol.for(\"VoiceRecorder\")\n};\n\nexport { TYPES };\n","import { inject, injectable } from \"inversify\";\nimport type { ConfigService } from \"../services/interfaces/ConfigService\";\nimport { TYPES } from \"@/inversify.types\";\nimport type BufferFetcherServiceInterface from \"@/services/interfaces/BufferFetcherServiceInterface\";\nimport type BufferDecoderServiceInterface from \"@/services/interfaces/BufferDecoderServiceInterface\";\nimport type EventEmitterInterface from \"@/utils/interfaces/EventEmitterInterface\";\n\n@injectable()\nexport default abstract class AbstractAudioElement {\n\n    @inject(TYPES.BufferFetcherService)\n    protected bufferFetcherService: BufferFetcherServiceInterface | null = null;\n\n    @inject(TYPES.BufferDecoderService)\n    protected bufferDecoderService: BufferDecoderServiceInterface | null = null;\n\n    @inject(TYPES.ConfigService)\n    protected configService: ConfigService | null = null;\n\n    @inject(TYPES.EventEmitter)\n    protected eventEmitter: EventEmitterInterface | null = null;\n\n    injectDependencies(bufferFetcherService: BufferFetcherServiceInterface | null, bufferDecoderService: BufferDecoderServiceInterface | null, configService: ConfigService | null, eventEmitter: EventEmitterInterface | null) {\n        if (bufferFetcherService) {\n            this.bufferFetcherService = bufferFetcherService;\n        }\n\n        if (bufferDecoderService) {\n            this.bufferDecoderService = bufferDecoderService;\n        }\n\n        if (configService) {\n            this.configService = configService;\n        }\n\n        if (eventEmitter) {\n            this.eventEmitter = eventEmitter;\n        }\n    }\n}\n","export enum EventType {\n    LOADING_BUFFERS = \"loadingBuffers\",\n    LOADING_BUFFERS_ERROR = \"loadingBuffersError\",\n    FETCHING_BUFFERS = \"fetchingBuffers\",\n    FETCHING_BUFFERS_ERROR = \"fetchingBuffersError\",\n    FINISHED_FETCHING_BUFFERS = \"finishedFetchingBuffers\",\n    LOADED_BUFFERS = \"loadedBuffers\",\n    COMPATIBILITY_MODE_AUTO_ENABLED = \"compatibilityModeAutoEnabled\",\n    STARTED_RENDERING_AUDIO = \"renderingAudio\",\n    RENDERING_AUDIO_PROBLEM_DETECTED = \"renderingAudioProblemDetected\",\n    AUDIO_RENDERING_FINISHED = \"audioRenderingFinished\",\n    AUDIO_RENDERING_EXCEPTION_THROWN = \"audioRenderingExceptionThrown\",\n    OFFLINE_AUDIO_RENDERING_FINISHED = \"offlineAudioRenderingFinished\",\n    PLAYING_STOPPED = \"playingStopped\",\n    PLAYING_STARTED = \"playingStarted\",\n    PLAYING_FINISHED = \"playingFinished\",\n    PLAYING_UPDATE = \"playingUpdate\",\n    RECORDER_INIT = \"recorderInit\",\n    RECORDER_SUCCESS = \"recorderSuccess\",\n    RECORDER_ERROR = \"recorderError\",\n    RECORDER_UPDATE_CONSTRAINTS = \"recorderUpdateConstraints\",\n    RECORDER_RECORDING = \"recorderRecording\",\n    RECORDER_STOPPED = \"recorderStopped\",\n    RECORDER_PAUSED = \"recorderPaused\",\n    RECORDER_RESETED = \"recorderReseted\",\n    RECORDER_COUNT_UPDATE = \"recorderCountUpdate\",\n    SAMPLE_RATE_CHANGED = \"sampleRateChanged\",\n    DECODING_AUDIO_FILE = \"decodingAudioFile\",\n    DECODED_AUDIO_FILE = \"decodedAudioFile\",\n    ERROR_DECODING_AUDIO_FILE = \"errorDecodingAudioFile\",\n    RECORDER_NOT_FOUND_ERROR = \"recorderNotFoundError\",\n    RECORDER_UNKNOWN_ERROR = \"recorderUnknownError\",\n    UPDATE_AUDIO_TREATMENT_PERCENT = \"updateAudioTreatmentPercent\",\n    UPDATE_REMAINING_TIME_ESTIMATED = \"updateRemainingTimeEstimated\",\n    CANCELLED_AND_LOADED_INITIAL_AUDIO = \"cancelledAndLoadedInitialAudio\",\n    CANCELLING_AUDIO_PROCESSING = \"cancellingAudioProcessing\",\n    PLAYING_FINISHED_LOOP_ALL = \"playingFinishedLoopAll\",\n    LOADED_AUDIO_FILE_FROM_LIST = \"loadedAudioFileFromList\"\n};\n","import { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport { EventType } from \"@/model/EventTypeEnum\";\nimport FilterManagerInterface from \"@/audioEditor/interfaces/FilterManagerInterface\";\nimport EventEmitterInterface from \"./interfaces/EventEmitterInterface\";\n\nconst utilFunctions = {\n    calcAudioDuration: (audio: AudioBuffer, speed: number) => {\n        if (audio) {\n            let duration = audio.duration + 1;\n\n            if (speed) {\n                duration = duration / speed;\n            }\n\n            return duration;\n        }\n\n        return 0;\n    },\n    loadAudioBuffer: async (context: AudioContext, file: File) => {\n        const arrayBuffer = await utilFunctions.readAsArrayBufferPromisified(file);\n        const audioBuffer = await context.decodeAudioData(arrayBuffer);\n        return utilFunctions.decodeBuffer(context, audioBuffer);\n    },\n    readAsArrayBufferPromisified: (file: File): Promise<ArrayBuffer> => {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n\n            reader.onload = ev => {\n                const result = ev?.target?.result;\n\n                if (result instanceof ArrayBuffer) {\n                    resolve(result);\n                } else {\n                    reject();\n                }\n            };\n\n            if (file) {\n                reader.readAsArrayBuffer(file); // Read the file\n            }\n        });\n    },\n    decodeBuffer: (context: AudioContext, buffer: AudioBuffer) => {\n        if (buffer.numberOfChannels == 1) { // convert to stereo buffer\n            context.resume();\n\n            const duration = buffer.duration;\n            const sampleRate = context.sampleRate;\n\n            const newBuffer = context.createBuffer(2, sampleRate * duration + sampleRate * 2, sampleRate);\n\n            // Original buffer data\n            const sourceChannelData = buffer.getChannelData(0);\n\n            // Destination buffers\n            const channel0Data = newBuffer.getChannelData(0);\n            const channel1Data = newBuffer.getChannelData(1);\n\n            for (let i = 0; i < sourceChannelData.length; i++) {\n                channel0Data[i] = sourceChannelData[i];\n                channel1Data[i] = sourceChannelData[i];\n            }\n\n            return newBuffer;\n        }\n\n        return buffer;\n    },\n    convertAudioBufferToFloat32Array: (buffer: AudioBuffer) => {\n        const array: Float32Array[] = [];\n\n        for (let channel = 0; channel < buffer.numberOfChannels; channel++) {\n            array.push(buffer.getChannelData(channel));\n        }\n\n        return array;\n    },\n    convertAudioParamToFloat32Array: (param: AudioParam, length: number) => {\n        const array = new Float32Array(length);\n\n        for (let i = 0; i < length; i++) {\n            array.set([param.value], i);\n        }\n\n        return array;\n    },\n    sumAudioBufferChannel(buffer: AudioBuffer, channel: number) {\n        return buffer.getChannelData(channel).reduce((a, b) => a + b, 0);\n    },\n    sumAudioBuffer(buffer: AudioBuffer) {\n        let sum = 0;\n\n        for (let channel = 0; channel < buffer.numberOfChannels; channel++) {\n            sum += this.sumAudioBufferChannel(buffer, channel);\n        }\n\n        return sum;\n    },\n    /**\n    * This method checks if the browser is compatible with audio worklets\n    * @param audioContext \n    */\n    isAudioWorkletCompatible(audioContext: BaseAudioContext) {\n        if (typeof (audioContext) !== \"undefined\" && typeof (audioContext.audioWorklet) !== \"undefined\") {\n            return true;\n        }\n\n        return false;\n    },\n    /**\n     * Check that the setting value is correct\n     * @param value FilterSettingValue\n     */\n    isSettingValueValid(value: FilterSettingValue) {\n        return typeof (value) !== \"undefined\" && !isNaN(Number(value)) && !(typeof (value) === \"string\" && value.trim() === \"\");\n    },\n    /**\n     * Calculate approximative audio duration according to enabled filters and their settings\n     * @param speedAudio Current audio speed\n     * @returns The audio duration\n     */\n    calculateAudioDuration(buffer: AudioBuffer, filterManager: FilterManagerInterface, speedAudio: number): number {\n        if (buffer && filterManager) {\n            const duration = this.calcAudioDuration(buffer, speedAudio);\n            return duration + filterManager.getAddingTime();\n        }\n\n        return 0;\n    },\n    /**\n     * Reset audio rendering progress\n     */\n    resetAudioRenderingProgress(eventEmitter: EventEmitterInterface | null) {\n        if (eventEmitter) {\n            eventEmitter.emit(EventType.UPDATE_AUDIO_TREATMENT_PERCENT, 0);\n            eventEmitter.emit(EventType.UPDATE_REMAINING_TIME_ESTIMATED, -1);\n        }\n    },\n    forceDownload(blob: Blob, filename: string) {\n        const link = window.document.createElement(\"a\");\n        const url = URL.createObjectURL(blob);\n        window.document.body.appendChild(link);\n        link.href = url;\n        link.download = filename || \"output.wav\";\n        link.click();\n        URL.revokeObjectURL(url);\n        window.document.body.removeChild(link);\n    },\n    clearAudioBuffer(buffer: AudioBuffer | null) {\n        if(buffer) {\n            for(let channel = 0; channel < buffer.numberOfChannels; channel++) {\n                const channelData = buffer.getChannelData(channel);\n\n                for(let i = 0; i < channelData.length; i++) {\n                    channelData[i] = 0;\n                }\n            }\n        }\n    }\n};\n\nexport default utilFunctions;\n","import AbstractAudioElement from \"../interfaces/AbstractAudioElement\";\nimport AbstractAudioFilter from \"../filters/interfaces/AbstractAudioFilter\";\nimport AbstractAudioRenderer from \"../filters/interfaces/AbstractAudioRenderer\";\nimport utils from \"../utils/Functions\";\nimport { EventType } from \"../model/EventTypeEnum\";\nimport { FilterSettings } from \"../model/filtersSettings/FilterSettings\";\nimport { EventEmitterCallback } from \"../model/EventEmitterCallback\";\nimport { FilterState } from \"../model/FilterState\";\nimport SaveBufferOptions from \"../model/SaveBufferOptions\";\nimport { TYPES } from \"../inversify.types\";\nimport { inject, injectable } from \"inversify\";\nimport AudioEditorInterface from \"./interfaces/AudioEditorInterface\";\nimport type FilterManagerInterface from \"./interfaces/FilterManagerInterface\";\nimport type RendererManagerInterface from \"./interfaces/RendererManagerInterface\";\nimport type AudioContextManagerInterface from \"./interfaces/AudioContextManagerInterface\";\nimport type SaveBufferManagerInterface from \"./interfaces/SaveBufferManagerInteface\";\nimport type AudioProcessorInterface from \"./interfaces/AudioProcessorInterface\";\nimport type BufferManagerInterface from \"./interfaces/BufferManagerInterface\";\nimport type BufferPlayerInterface from \"@/bufferPlayer/interfaces/BufferPlayerInterface\";\n\n\n/**\n * Principal class used to manage audio processing: load an audio file or buffer,\n * manage filters/renderers (enable/disable, settings), add new filters/renderers,\n * download rendered audio, get rendered audio buffer\n */\n@injectable()\nexport default class AudioEditor extends AbstractAudioElement implements AudioEditorInterface {\n\n    /** The filter manager */\n    private filterManager: FilterManagerInterface | undefined;\n\n    /** The renderer manager */\n    private rendererManager: RendererManagerInterface | undefined;\n\n    /** The context manager */\n    private contextManager: AudioContextManagerInterface | undefined;\n\n    /** The save buffer manager */\n    private saveBufferManager: SaveBufferManagerInterface | undefined;\n\n    /** The save buffer manager */\n    private audioProcessor: AudioProcessorInterface | undefined;\n\n    /** The save buffer manager */\n    private bufferManager: BufferManagerInterface | undefined;\n\n    /** The audio player */\n    private bufferPlayer: BufferPlayerInterface | undefined;\n\n    /** The audio buffer to be processed */\n    private principalBuffer: AudioBuffer | null = null;\n\n    /** The list of file selected by user */\n    private fileList: FileList | null = null;\n\n    /** The current index of the loaded file from file list */\n    private fileListCurrIndex = 0;\n\n    private loadingAudio = false;\n\n    private renderingAudio = false;\n\n    constructor(\n        @inject(TYPES.FilterManager) filterManager: FilterManagerInterface,\n        @inject(TYPES.RendererManager) rendererManager: RendererManagerInterface,\n        @inject(TYPES.AudioContextManager) contextManager: AudioContextManagerInterface,\n        @inject(TYPES.SaveBufferManager) saveBufferManager: SaveBufferManagerInterface,\n        @inject(TYPES.AudioProcessor) audioProcessor: AudioProcessorInterface,\n        @inject(TYPES.BufferManager) bufferManager: BufferManagerInterface,\n        @inject(TYPES.BufferPlayer) player: BufferPlayerInterface\n    ) {\n        super();\n\n        this.filterManager = filterManager;\n        this.rendererManager = rendererManager;\n        this.contextManager = contextManager;\n        this.saveBufferManager = saveBufferManager;\n        this.audioProcessor = audioProcessor;\n        this.bufferManager = bufferManager;\n        this.bufferPlayer = player;\n\n        this.setup();\n    }\n\n    private setup() {\n        if (this.bufferPlayer) {\n            // Callback called just before starting playing audio, when compatibility mode is enabled\n            this.bufferPlayer.onBeforePlaying(async () => {\n                if (this.bufferPlayer && this.bufferPlayer.compatibilityMode\n                    && this.contextManager && this.contextManager.currentContext && this.audioProcessor) {\n                    await this.audioProcessor.setupOutput(this.principalBuffer, this.contextManager.currentContext);\n                }\n            });\n\n            // Callback called when playing is finished\n            this.bufferPlayer.on(EventType.PLAYING_FINISHED, () => {\n                if (this.bufferPlayer && this.bufferPlayer.loop) {\n                    this.bufferPlayer.start();\n                }\n            });\n\n            // Callback called when playing is finished and looping all audio\n            this.bufferPlayer.on(EventType.PLAYING_FINISHED_LOOP_ALL, async () => {\n                if (this.bufferPlayer && this.bufferPlayer.loopAll && !this.renderingAudio && !this.loadingAudio) {\n                    await this.loadNextAudio(true);\n                    this.bufferPlayer.start();\n                }\n            });\n        }\n    }\n\n    addFilters(...filters: AbstractAudioFilter[]) {\n        if (this.filterManager) {\n            this.filterManager.addFilters(...filters);\n        }\n    }\n\n    addRenderers(...renderers: AbstractAudioRenderer[]) {\n        if (this.rendererManager) {\n            this.rendererManager.addRenderers(...renderers);\n        }\n    }\n\n    get currentSampleRate(): number {\n        if (this.contextManager) {\n            return this.contextManager.currentSampleRate;\n        }\n\n        return 0;\n    }\n\n    get defaultDeviceSampleRate(): number {\n        const tempContext = new AudioContext();\n        let sampleRate = 0;\n\n        if (tempContext) {\n            sampleRate = tempContext.sampleRate;\n            tempContext.close();\n        }\n\n        return sampleRate;\n    }\n\n    async loadBufferFromFile(file: File) {\n        this.clearBuffers();\n        this.loadingAudio = true;\n\n        if (this.audioProcessor) {\n            await this.audioProcessor.prepareContext(this.principalBuffer);\n        }\n\n        if (this.contextManager && this.contextManager.currentContext && this.bufferDecoderService && this.audioProcessor) {\n            this.principalBuffer = await this.bufferDecoderService.decodeBufferFromFile(file);\n            this.audioProcessor.initialRenderingDone = false;\n\n            if (this.principalBuffer) {\n                this.audioProcessor.sumInputBuffer = utils.sumAudioBuffer(this.principalBuffer);\n            } else {\n                this.loadingAudio = false;\n                throw new Error(\"Error decoding audio file\");\n            }\n\n            utils.resetAudioRenderingProgress(this.eventEmitter);\n\n            // If switching between a list of audio to one audio, reset the loop audio playing\n            if (this.bufferPlayer && this.bufferPlayer.loopAll && this.totalFileList <= 1) {\n                this.bufferPlayer.toggleLoop();\n            }\n\n            this.loadingAudio = false;\n        } else {\n            this.loadingAudio = false;\n            throw new Error(\"Audio Context is not ready!\");\n        }\n    }\n\n    async loadFileList(fileList: FileList) {\n        this.fileList = fileList;\n\n        await this.loadBufferFromFileListIndex(0);\n    }\n\n    async loadBufferFromFileListIndex(index: number) {\n        if (this.fileList) {\n            this.fileListCurrIndex = index;\n\n            const file = this.fileList.item(this.fileListCurrIndex);\n\n            if (this.eventEmitter) {\n                this.eventEmitter.emit(EventType.LOADED_AUDIO_FILE_FROM_LIST, index);\n            }\n\n            if (file) {\n                await this.loadBufferFromFile(file);\n            }\n        }\n    }\n\n    async loadPreviousAudio(forceInitialRendering?: boolean) {\n        const currentIndex = this.currentIndexFileList;\n        const maxIndex = this.totalFileList;\n        const newIndex = currentIndex - 1;\n\n        if (newIndex != currentIndex) {\n            if (newIndex < 0) {\n                await this.loadBufferFromFileListIndex(maxIndex - 1);\n            } else {\n                await this.loadBufferFromFileListIndex(newIndex);\n            }\n\n            await this.renderAudio(forceInitialRendering);\n        }\n    }\n\n    async loadNextAudio(forceInitialRendering?: boolean) {\n        const currentIndex = this.currentIndexFileList;\n        const maxIndex = this.totalFileList;\n        const newIndex = currentIndex + 1;\n\n        if (newIndex != currentIndex) {\n            if (newIndex >= maxIndex) {\n                await this.loadBufferFromFileListIndex(0);\n            } else {\n                await this.loadBufferFromFileListIndex(newIndex);\n            }\n\n            await this.renderAudio(forceInitialRendering);\n        }\n    }\n\n    getCurrentFileList(): Map<string, boolean> {\n        if (this.fileList) {\n            const mapFiles = new Map();\n\n            for (let i = 0; i < this.fileList.length; i++) {\n                const file = this.fileList.item(i);\n\n                if (file) {\n                    mapFiles.set(file.name, this.currentIndexFileList === i);\n                }\n            }\n\n            return mapFiles;\n        }\n\n        return new Map();\n    }\n\n    get currentIndexFileList() {\n        return this.fileListCurrIndex;\n    }\n\n    get totalFileList() {\n        if (this.fileList) {\n            return this.fileList.length;\n        }\n\n        return 0;\n    }\n\n    loadBuffer(audioBuffer: AudioBuffer) {\n        this.principalBuffer = audioBuffer;\n\n        if (this.audioProcessor) {\n            this.audioProcessor.sumInputBuffer = utils.sumAudioBuffer(this.principalBuffer);\n            this.audioProcessor.initialRenderingDone = false;\n        }\n    }\n\n    getOutputBuffer() {\n        if (this.audioProcessor) {\n            return this.audioProcessor.renderedBuffer;\n        }\n\n        return null;\n    }\n\n    async renderAudio(forceInitialRendering?: boolean): Promise<boolean> {\n        if (this.audioProcessor) {\n            try {\n                this.renderingAudio = true;\n\n                if (this.eventEmitter) {\n                    this.eventEmitter.emit(EventType.STARTED_RENDERING_AUDIO);\n                }\n\n                const result = await this.audioProcessor.renderAudio(this.principalBuffer, forceInitialRendering);\n\n                if (this.eventEmitter) {\n                    this.eventEmitter.emit(EventType.AUDIO_RENDERING_FINISHED);\n                }\n\n                this.renderingAudio = false;\n\n                return result;\n            } catch (e) {\n                if (this.eventEmitter) {\n                    this.eventEmitter.emit(EventType.AUDIO_RENDERING_FINISHED);\n                    this.eventEmitter.emit(EventType.AUDIO_RENDERING_EXCEPTION_THROWN, e as Error);\n                }\n\n                this.renderingAudio = false;\n            }\n        }\n\n        return false;\n    }\n\n    isAudioWorkletAvailable(): boolean {\n        if (this.contextManager && this.contextManager.currentContext) {\n            return utils.isAudioWorkletCompatible(this.contextManager.currentContext);\n        }\n\n        return false;\n    }\n\n    // Filters settings\n\n    getFiltersState(): FilterState {\n        if (this.filterManager && this.rendererManager) {\n            return {\n                ...this.filterManager.getFiltersState(),\n                ...this.rendererManager.getRenderersState()\n            };\n        }\n\n        return {};\n    }\n\n    getFiltersSettings(): Map<string, FilterSettings> {\n        if (this.filterManager) {\n            return this.filterManager.getFiltersSettings();\n        }\n\n        return new Map();\n    }\n\n    async reconnectNodesIfNeeded() {\n        if (this.contextManager && this.bufferPlayer && this.bufferPlayer.compatibilityMode &&\n            this.contextManager.currentContext && this.principalBuffer &&\n            this.filterManager && this.filterManager.entrypointFilter) {\n            await this.filterManager.connectNodes(this.contextManager.currentContext, this.principalBuffer, true, this.bufferPlayer.compatibilityMode);\n\n            const speedAudio = this.filterManager.entrypointFilter.getSpeed();\n            this.bufferPlayer.speedAudio = speedAudio;\n            this.bufferPlayer.duration = utils.calculateAudioDuration(this.principalBuffer, this.filterManager, speedAudio) * speedAudio;\n        }\n    }\n\n    enableFilter(filterId: string) {\n        if (this.rendererManager) {\n            this.rendererManager.enableRenderer(filterId);\n        }\n\n        if (this.filterManager) {\n            this.filterManager.enableFilter(filterId);\n            this.reconnectNodesIfNeeded();\n        }\n    }\n\n    disableFilter(filterId: string) {\n        if (this.rendererManager) {\n            this.rendererManager.disableRenderer(filterId);\n        }\n\n        if (this.filterManager) {\n            this.filterManager.disableFilter(filterId);\n            this.reconnectNodesIfNeeded();\n        }\n    }\n\n    toggleFilter(filterId: string) {\n        if (this.rendererManager) {\n            this.rendererManager.toggleRenderer(filterId);\n        }\n\n        if (this.filterManager) {\n            this.filterManager.toggleFilter(filterId);\n            this.reconnectNodesIfNeeded();\n        }\n    }\n\n    async changeFilterSettings(filterId: string, settings: FilterSettings) {\n        if (this.filterManager) {\n            await this.filterManager.changeFilterSettings(filterId, settings);\n            await this.reconnectNodesIfNeeded();\n        }\n    }\n\n    async resetFilterSettings(filterId: string) {\n        if (this.filterManager) {\n            await this.filterManager.resetFilterSettings(filterId);\n            await this.reconnectNodesIfNeeded();\n        }\n    }\n\n    resetAllFiltersState() {\n        if (this.rendererManager) {\n            this.rendererManager.resetAllRenderersState();\n        }\n\n        if (this.filterManager) {\n            this.filterManager.resetAllFiltersState();\n            this.reconnectNodesIfNeeded();\n        }\n    }\n\n    // Events and exit\n\n    exit() {\n        if (this.bufferPlayer) {\n            this.bufferPlayer.stop();\n            this.bufferPlayer.reset();\n        }\n\n        this.cancelAudioRendering();\n        this.clearBuffers();\n\n        this.fileList = null;\n        this.fileListCurrIndex = 0;\n    }\n\n    private clearBuffers() {\n        utils.clearAudioBuffer(this.principalBuffer);\n        this.principalBuffer = null;\n\n        if(this.audioProcessor) {\n            this.audioProcessor.clearRenderedBuffer();\n        }\n    }\n\n    cancelAudioRendering() {\n        if (this.audioProcessor) {\n            this.audioProcessor.cancelAudioRendering();\n        }\n    }\n\n    on(event: string, callback: EventEmitterCallback) {\n        if (this.eventEmitter) {\n            this.eventEmitter.on(event, callback);\n        }\n    }\n\n    off(event: string, callback: EventEmitterCallback) {\n        if (this.eventEmitter) {\n            this.eventEmitter.off(event, callback);\n        }\n    }\n\n    async saveBuffer(options?: SaveBufferOptions): Promise<boolean> {\n        if (this.saveBufferManager && this.audioProcessor) {\n            return await this.saveBufferManager?.saveBuffer(this.audioProcessor.renderedBuffer, options);\n        }\n\n        return false;\n    }\n\n    set downloadingInitialData(state: boolean) {\n        if (this.bufferManager) {\n            this.bufferManager.downloadingInitialData = state;\n        }\n    }\n\n    get downloadingInitialData(): boolean {\n        if (this.bufferManager) {\n            return this.bufferManager.downloadingInitialData;\n        }\n\n        return false;\n    }\n}\n","/*\n * Copyright (C) 2019-2024 Eliastik (eliastiksofts.com)\n *\n * This file is part of \"Simple Voice Changer\".\n *\n * \"Simple Voice Changer\" is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * \"Simple Voice Changer\" is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with \"Simple Voice Changer\".  If not, see <http://www.gnu.org/licenses/>.\n */\n// The audio buffer player\n// Used to play the audio buffer, with time controls, pause/play, stop and loop\nimport { EventType } from \"../model/EventTypeEnum\";\nimport { EventEmitterCallback } from \"../model/EventEmitterCallback\";\nimport AbstractAudioElement from \"../interfaces/AbstractAudioElement\";\nimport { TYPES } from \"../inversify.types\";\nimport { inject, injectable } from \"inversify\";\nimport BufferPlayerInterface from \"./interfaces/BufferPlayerInterface\";\nimport AudioContextManagerInterface from \"@/audioEditor/interfaces/AudioContextManagerInterface\";\n\n// Also used in compatibility mode (which doesn't use audio buffer) with less functions (no time control)\n@injectable()\nexport default class BufferPlayer extends AbstractAudioElement implements BufferPlayerInterface {\n\n    private _contextManager: AudioContextManagerInterface | undefined | null;\n\n    private buffer: AudioBuffer | null = null;\n    private source: AudioBufferSourceNode | null = null;\n    private gainNode: GainNode | null = null;\n    private intervals: number[] = [];\n    private onBeforePlayingCallback: () => void = async () => { };\n    private _volume = 1;\n    \n    currentTime = 0;\n    displayTime = 0;\n    duration = 0;\n    playing = false;\n    loop = false;\n    loopAll = false;\n    speedAudio = 1;\n\n    compatibilityMode = false;\n    currentNode: AudioNode | null = null;\n\n    constructor(\n        @inject(TYPES.AudioContextManager) contextManager: AudioContextManagerInterface | undefined | null) {\n        super();\n\n        this._contextManager = contextManager;\n    }\n\n    init(direct?: boolean) {\n        this.playing = false;\n\n        if (this._contextManager && this._contextManager.currentContext) {\n            this._contextManager.currentContext.resume();\n\n            if (!this.compatibilityMode && this.buffer) {\n                if (this.source != null && !direct) {\n                    this.source.buffer = null;\n                    this.source.disconnect();\n                }\n\n                this.source = this._contextManager.currentContext.createBufferSource();\n                this.source.buffer = this.buffer;\n\n                this.gainNode = this._contextManager.currentContext.createGain();\n                this.setGainNodeValue();\n\n                this.duration = this.buffer.duration * this.speedAudio;\n\n                this.source.connect(this.gainNode);\n                this.gainNode.connect(this._contextManager.currentContext.destination);\n            }\n        }\n\n        this.updateInfos();\n    }\n\n    loadBuffer(buffer: AudioBuffer) {\n        this.compatibilityMode = false;\n        this.reset();\n        this.buffer = buffer;\n        this.init();\n    }\n\n    setCompatibilityMode(currentNode: AudioNode, duration?: number) {\n        this.compatibilityMode = true;\n        this.reset();\n        this.init();\n\n        if (duration != null) {\n            this.duration = duration * this.speedAudio;\n        }\n\n        this.currentNode = currentNode;\n        this.updateInfos();\n    }\n\n    reset(direct?: boolean) {\n        this.clearIntervals();\n\n        this.currentTime = 0;\n        this.displayTime = 0;\n\n        if (!direct) {\n            this.stop();\n        }\n    }\n\n    stop() {\n        this.clearIntervals();\n\n        if (this.source != undefined && this.source != null && this.playing) {\n            this.source.stop(0);\n            this.playing = false;\n        }\n\n        if (this.currentNode) {\n            this.currentNode.disconnect();\n\n            if (this.compatibilityMode) {\n                this.currentTime = 0;\n                this.displayTime = 0;\n            }\n        }\n\n        this.eventEmitter?.emit(EventType.PLAYING_STOPPED);\n        this.updateInfos();\n    }\n\n    /**\n     * Clear old intervals\n     */\n    private clearIntervals() {\n        for (const interval of this.intervals) {\n            clearInterval(interval);\n        }\n\n        this.intervals = [];\n    }\n\n    async start(direct?: boolean) {\n        if (this.source || this.compatibilityMode) {\n            if (!direct) {\n                this.stop();\n            }\n\n            this.init(direct);\n\n            await this.onBeforePlayingCallback();\n\n            this.eventEmitter?.emit(EventType.PLAYING_STARTED);\n\n            if (!this.compatibilityMode) {\n                if (this.source) {\n                    this.source.start(0, direct ? 0 : this.currentTime / this.speedAudio);\n                    this.playing = true;\n                } else {\n                    return;\n                }\n            } else {\n                if (this.currentNode && this._contextManager && this._contextManager.currentContext) {\n                    this.currentNode.connect(this._contextManager.currentContext.destination);\n                } else {\n                    return;\n                }\n            }\n\n            let startTime = performance.now();\n\n            this.intervals.push(window.setInterval(() => {\n                const timeNow = performance.now();\n                const nextTime = timeNow - startTime;\n                startTime = timeNow;\n\n                this.currentTime += (nextTime / 1000) * this.speedAudio;\n                this.displayTime = this.currentTime;\n\n                if (this.currentTime > this.duration) {\n                    if (this.loop) {\n                        if (!this.compatibilityMode) {\n                            this.reset(direct);\n                            this.start();\n                        } else {\n                            this.eventEmitter?.emit(EventType.PLAYING_FINISHED);\n                        }\n                    } else {\n                        this.eventEmitter?.emit(EventType.PLAYING_FINISHED);\n                        this.reset(direct);\n\n                        if (this.loopAll) {\n                            this.eventEmitter?.emit(EventType.PLAYING_FINISHED_LOOP_ALL);\n                        }\n                    }\n                } else {\n                    this.updateInfos();\n                }\n            }, 100));\n        }\n    }\n\n    async playDirect() {\n        if (!this.compatibilityMode) {\n            this.start(true);\n        } else {\n            // Play direct is not possible when compatibility mode is enabled\n            this.start(false);\n        }\n    }\n\n    pause() {\n        this.stop();\n    }\n\n    /** Send an event to update the informations of this player */\n    private updateInfos() {\n        this.eventEmitter?.emit(EventType.PLAYING_UPDATE);\n    }\n\n    setTimePercent(percent: number) {\n        if (!this.compatibilityMode) {\n            this.currentTime = Math.round(this.duration * (percent / 100));\n            this.displayTime = this.currentTime;\n\n            if (this.playing) {\n                this.pause();\n                this.start();\n            } else {\n                this.updateInfos();\n            }\n        }\n    }\n\n    setTime(time: number) {\n        if (!this.compatibilityMode) {\n            this.currentTime = time;\n            this.displayTime = this.currentTime;\n\n            if (this.playing) {\n                this.pause();\n                this.start();\n            } else {\n                this.updateInfos();\n            }\n        }\n    }\n\n    set volume(volume: number) {\n        this._volume = volume;\n        this.setGainNodeValue();\n    }\n\n    private setGainNodeValue() {\n        if(this.gainNode) {\n            this.gainNode.gain.value = Math.pow(this._volume, 2);\n        }\n    }\n\n    get volume() {\n        return this._volume;\n    }\n\n    onBeforePlaying(callback: () => void) {\n        this.onBeforePlayingCallback = callback;\n    }\n\n    toggleLoop() {\n        this.loopAll = false;\n        this.loop = !this.loop;\n    }\n\n    toggleLoopAll() {\n        this.loop = false;\n        this.loopAll = !this.loopAll;\n    }\n\n    on(event: string, callback: EventEmitterCallback) {\n        if (this.eventEmitter) {\n            this.eventEmitter.on(event, callback);\n        }\n    }\n\n    get currentTimeDisplay() {\n        return (\"0\" + Math.trunc(this.displayTime / 60)).slice(-2) + \":\" + (\"0\" + Math.trunc(this.displayTime % 60)).slice(-2);\n    }\n\n    get maxTimeDisplay() {\n        return (\"0\" + Math.trunc(this.duration / 60)).slice(-2) + \":\" + (\"0\" + Math.trunc(this.duration % 60)).slice(-2);\n    }\n\n    get percent() {\n        return (100 - Math.round((this.duration - this.displayTime) / this.duration * 100));\n    }\n\n    get remainingTimeDisplay() {\n        return (\"0\" + Math.trunc((this.duration - this.displayTime) / 60)).slice(-2) + \":\" + (\"0\" + Math.trunc((this.duration - this.displayTime) % 60)).slice(-2);\n    }\n}\n","/*\n * Copyright (C) 2019-2023 Eliastik (eliastiksofts.com)\n *\n * This file is part of \"Simple Voice Changer\".\n *\n * \"Simple Voice Changer\" is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * \"Simple Voice Changer\" is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with \"Simple Voice Changer\".  If not, see <http://www.gnu.org/licenses/>.\n */\nexport default class TimerSaveTime {\n    seconds = 0;\n    initialSeconds = 0;\n    interval: number | null = null;\n    incr = 1;\n\n    private countCallback: () => void = () => {};\n\n    constructor(seconds: number, incr: number) {\n        this.seconds = seconds;\n        this.initialSeconds = seconds;\n        this.incr = incr;\n    }\n\n    start() {\n        this.interval = window.setInterval(() => this.count(), 1000);\n    }\n\n    stop() {\n        clearInterval(this.interval!);\n    }\n\n    count() {\n        this.seconds += this.incr;\n\n        if(this.seconds <= 0) {\n            this.stop();\n        }\n\n        if(this.countCallback) {\n            this.countCallback();\n        }\n    }\n\n    onCount(callback: () => void) {\n        this.countCallback = callback;\n    }\n}\n","const FilterNames = {\n    REVERB: \"reverb\",\n    ECHO: \"echo\",\n    BASS_BOOST: \"bassboost\",\n    BITCRUSHER: \"bitcrusher\",\n    HIGH_PASS: \"highpass\",\n    LIMITER: \"limiter\",\n    LOW_PASS: \"lowpass\",\n    PASSTHROUGH: \"passthroughfilter\",\n    RETURN_AUDIO: \"returnAudio\",\n    SOUNDTOUCH: \"soundtouch\",\n    TELEPHONIZER: \"telephonizer\",\n    VOCODER: \"vocoder\"\n};\n\nexport default FilterNames;\n","import FilterNames from \"./FilterNames\";\n\nconst Constants = {\n    AUDIO_EDITOR: \"audioEditor\",\n    VOICE_RECORDER: \"voiceRecorder\",\n    BUFFER_PLAYER: \"bufferPlayer\",\n    AUDIO_CONTEXT_MANAGER: \"audioContextManager\",\n    AUDIO_PROCESSOR: \"audioProcessor\",\n    BUFFER_MANAGER: \"bufferManager\",\n    FILTER_MANAGER: \"filterManager\",\n    RENDERER_MANAGER: \"rendererManager\",\n    SAVE_BUFFER_MANAGER: \"saveBufferManager\",\n    EXPORT_WAV_COMMAND: \"exportWAV\",\n    EXPORT_MP3_COMMAND: \"exportMP3\",\n    AUDIO_WAV: \"audio/wav\",\n    AUDIO_MP3: \"audio/mp3\",\n    RECORD_COMMAND: \"record\",\n    INIT_COMMAND: \"init\",\n    FILTERS_NAMES: FilterNames,\n    WORKLET_PATHS: {\n        BITCRUSHER: \"BitCrusher.worklet.js\",\n        LIMITER: \"Limiter.worklet.js\",\n        SOUNDTOUCH: \"Soundtouch.worklet.js\",\n        RECORDER_WORKLET: \"RecorderWorklet.js\",\n        PASSTHROUGH: \"Passthrough.worklet.js\"\n    },\n    WORKLET_NAMES: {\n        BITCRUSHER: \"bitcrusher-processor\",\n        LIMITER: \"limiter-processor\",\n        SOUNDTOUCH: \"soundtouch-worklet\",\n        RECORDER_WORKLET: \"recorder-worklet\",\n        PASSTHROUGH: \"passthrough\"\n    },\n    PREFERENCES_KEYS: {\n        COMPATIBILITY_MODE_ENABLED: \"compatibility-mode-enabled\",\n        COMPATIBILITY_MODE_CHECKED: \"compatibility-mode-checked\",\n        ENABLE_AUDIO_WORKLET: \"enable-audio-worklet\",\n        ENABLE_SOUNDTOUCH_AUDIO_WORKLET: \"enable-soundtouch-audio-worklet\",\n        BUFFER_SIZE: \"buffer-size\",\n        SAMPLE_RATE: \"sample-rate\",\n        DISABLE_INITIAL_RENDERING: \"disable-initial-rendering\",\n        BITRATE_MP3: \"bitrate-mp3\"\n    },\n    // Enable or disable the use of Audio Worklet version of Soundtouch\n    // If disabled, the ScriptProcessorNode version is used\n    ENABLE_SOUNDTOUCH_AUDIO_WORKLET: true,\n    ENABLE_AUDIO_WORKLET: true,\n    ENABLE_RECORDER_AUDIO_WORKLET: true,\n    SOUNDTOUCH_PITCH_SHIFTER_BUFFER_SIZE: 16384,\n    DEFAULT_REVERB_ENVIRONMENT: {\n        name: \"Medium Damping Cave E002 M2S\",\n        url: \"impulse_response.wav\",\n        size: 1350278,\n        addDuration: 4,\n        link: \"http://www.cksde.com/p_6_250.htm\"\n    },\n    VOCODER_MODULATOR: \"modulator.mp3\",\n    DEFAULT_BUFFER_SIZE: 0,\n    VALID_BUFFER_SIZE: [0, 256, 512, 1024, 2048, 4096, 8192, 16384],\n    VALID_MP3_BITRATES: [32, 64, 96, 128, 160, 256, 320],\n    DEFAULT_SAMPLE_RATE: 0, // 0 = AUTO\n    VALID_SAMPLE_RATES: [0, 8000, 11025, 16000, 22050, 32000, 44100, 48000, 88200, 96000, 176400, 192000],\n    // Interval used by the treatment percent counter. The event will be dispatched each ms defined here\n    TREATMENT_TIME_COUNTING_THROTTLE_INTERVAL: 100,\n    // Smoothing factor for the time couting estimation (between 0 and 1)\n    TREATMENT_TIME_COUNTING_SMOOTHING_FACTOR: 0.9,\n    // Disable initial rendering (when opening audio file or buffer)\n    DISABLE_INITIAL_RENDERING: false,\n    // Default save format\n    DEFAULT_SAVE_FORMAT: \"wav\",\n    // Default bitrate for the MP3 encoder\n    DEFAULT_MP3_BITRATE: 320\n};\n\nexport default Constants;\n","export default function getRecorderWorker(workerBasePath?: string): Worker {\n    return new Worker((workerBasePath ? workerBasePath : \"\") + \"RecorderWorker.js\");\n};\n","import { injectable } from \"inversify\";\nimport Constants from \"../model/Constants\";\nimport { RecorderCallback, RecorderCallbacks } from \"../model/RecorderCallback\";\nimport type RecorderConfig from \"../model/RecorderConfig\";\nimport RecorderWorkerMessage from \"../model/RecorderWorkerMessage\";\nimport RecorderWorkletMessage from \"../model/RecorderWorkletMessage\";\nimport utilFunctions from \"../utils/Functions\";\nimport getRecorderWorker from \"./getRecorderWorker\";\nimport RecorderInterface from \"./interfaces/RecorderInterface\";\n\n@injectable()\nexport class Recorder implements RecorderInterface {\n\n    // Inline Worker\n    private worker: Worker | null = null;\n    private node: ScriptProcessorNode | AudioWorkletNode | null = null;\n    private context: BaseAudioContext | null = null;\n\n    private config: RecorderConfig = {\n        bufferLen: 4096,\n        sampleRate: 44100,\n        numChannels: 2,\n        mimeType: \"audio/wav\",\n        workletBasePath: \"worklets/\",\n        workerBasePath: \"workers/\",\n        bitrate: Constants.DEFAULT_MP3_BITRATE,\n        callback: () => { }\n    };\n\n    private callbacks: RecorderCallbacks = {\n        getBuffer: [],\n        exportWAV: [],\n        exportMP3: []\n    };\n\n    recording = false;\n\n    constructor(cfg: RecorderConfig) {\n        Object.assign(this.config, cfg);\n    }\n\n    async setup(source: AudioNode) {\n        if (this.node) { // Disconnect previous node\n            if (this.node instanceof AudioWorkletNode) {\n                this.node.port.postMessage(\"stop\");\n            }\n\n            this.node.disconnect();\n        }\n\n        if (source) {\n            this.context = source.context;\n\n            await this.createRecorderNode();\n\n            if (this.node && this.context) {\n                source.connect(this.node);\n                this.node.connect(this.context.destination);    //this should not be necessary\n            }\n        }\n\n        if (this.context && !this.worker) {\n            this.worker = getRecorderWorker(this.config.workerBasePath);\n\n            if (this.worker) {\n                this.worker.postMessage({\n                    command: \"init\",\n                    config: {\n                        sampleRate: this.context.sampleRate,\n                        numChannels: this.config.numChannels,\n                        bitrate: this.config.bitrate\n                    }\n                });\n\n                this.worker.onmessage = (e: RecorderWorkerMessage) => {\n                    let callbacks = null;\n\n                    switch (e.data.command) {\n                    case \"getBuffer\":\n                        callbacks = this.callbacks.getBuffer;\n                        break;\n                    case Constants.EXPORT_WAV_COMMAND:\n                        callbacks = this.callbacks.exportWAV;\n                        break;\n                    case Constants.EXPORT_MP3_COMMAND:\n                        callbacks = this.callbacks.exportMP3;\n                        break;\n                    }\n\n                    if (callbacks) {\n                        const cb = callbacks.pop();\n                        if (typeof cb == \"function\") {\n                            (cb as RecorderCallback<Blob | Float32Array[]>)(e.data.data);\n                        }\n                    }\n                };\n            }\n        }\n    }\n\n\n    private async createRecorderNode() {\n        if (this.context) {\n            if (utilFunctions.isAudioWorkletCompatible(this.context) && Constants.ENABLE_RECORDER_AUDIO_WORKLET) {\n                try {\n                    await this.createRecorderWorklet();\n                } catch(e) {\n                    console.error(e);\n                    this.createRecorderScriptProcessorNode();\n                }\n            } else {\n                this.createRecorderScriptProcessorNode();\n            }\n        }\n    }\n\n    private async createRecorderWorklet() {\n        if (this.context) {\n            await this.context.audioWorklet.addModule(this.config.workletBasePath + Constants.WORKLET_PATHS.RECORDER_WORKLET);\n\n            this.node = new AudioWorkletNode(this.context, Constants.WORKLET_NAMES.RECORDER_WORKLET);\n\n            if (this.node && this.node.port) {\n                const numChannelParameter = this.node.parameters.get(\"numChannels\");\n\n                if(numChannelParameter) {\n                    numChannelParameter.value = this.config.numChannels;\n                    numChannelParameter.setValueAtTime(this.config.numChannels, 0);\n                }\n\n                this.node.port.onmessage = (e: MessageEvent<RecorderWorkletMessage>) => {\n                    if (this.worker && e.data.command == \"record\" && e.data.buffer.length > 0) {\n                        this.worker.postMessage({\n                            command: \"record\",\n                            buffer: e.data.buffer\n                        });\n                    }\n                };\n            }\n        }\n    }\n\n    private createRecorderScriptProcessorNode() {\n        if (this.context) {\n            this.node = (this.context.createScriptProcessor).call(this.context,\n                this.config.bufferLen, this.config.numChannels, this.config.numChannels);\n\n            this.node.onaudioprocess = (e) => {\n                if (!this.recording) return;\n\n                const buffer = [];\n                for (let channel = 0; channel < this.config.numChannels; channel++) {\n                    buffer.push(e.inputBuffer.getChannelData(channel));\n                }\n\n                if (this.worker) {\n                    this.worker.postMessage({\n                        command: \"record\",\n                        buffer: buffer\n                    });\n                }\n            };\n        }\n    }\n\n    record() {\n        this.recording = true;\n\n        if (this.node instanceof AudioWorkletNode) {\n            this.node.port.postMessage(\"record\");\n        }\n    }\n\n    stop() {\n        this.recording = false;\n\n        if (this.node instanceof AudioWorkletNode) {\n            this.node.port.postMessage(\"stop\");\n        }\n    }\n\n    clear() {\n        if (this.worker) {\n            this.worker.postMessage({ command: \"clear\" });\n        }\n    }\n\n    kill() {\n        this.clear();\n        this.stop();\n\n        if (this.worker) {\n            this.worker.terminate();\n        }\n    }\n\n    getBuffer(cb: RecorderCallback<Float32Array[]>) {\n        cb = cb || this.config.callback;\n        if (!cb) throw new Error(\"Callback not set\");\n\n        this.callbacks.getBuffer.push(cb);\n\n        if (this.worker) {\n            this.worker.postMessage({ command: \"getBuffer\" });\n        }\n    }\n\n    exportWAV(cb: RecorderCallback<Blob>, mimeType?: string) {\n        mimeType = mimeType || this.config.mimeType;\n        cb = cb || this.config.callback;\n        if (!cb) throw new Error(\"Callback not set\");\n\n        this.callbacks.exportWAV.push(cb);\n\n        if (this.worker) {\n            this.worker.postMessage({\n                command: Constants.EXPORT_WAV_COMMAND,\n                type: mimeType\n            });\n        }\n    }\n\n    exportMP3(cb: RecorderCallback<Blob>, mimeType?: string) {\n        mimeType = mimeType || this.config.mimeType;\n        cb = cb || this.config.callback;\n        if (!cb) throw new Error(\"Callback not set\");\n\n        this.callbacks.exportMP3.push(cb);\n\n        if (this.worker) {\n            this.worker.postMessage({\n                command: Constants.EXPORT_MP3_COMMAND,\n                type: mimeType\n            });\n        }\n    } \n};\n\nexport default Recorder;\n","\n/*\n * Copyright (C) 2019-2023 Eliastik (eliastiksofts.com)\n *\n * This file is part of \"Simple Voice Changer\".\n *\n * \"Simple Voice Changer\" is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * \"Simple Voice Changer\" is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with \"Simple Voice Changer\".  If not, see <http://www.gnu.org/licenses/>.\n */\n// The Voice Recorder class\n// Used to record a sound (voice, etc.) with the user microphone\n// Offer control with play/pause and audio feedback\nimport { inject, injectable } from \"inversify\";\nimport TimerSaveTime from \"../utils/TimerSaveTime\";\nimport { EventType } from \"../model/EventTypeEnum\";\nimport AudioConstraintWrapper from \"../model/AudioConstraintWrapper\";\nimport { RecorderSettings } from \"../model/RecorderSettings\";\nimport type { ConfigService } from \"../services/interfaces/ConfigService\";\nimport AbstractAudioElement from \"../interfaces/AbstractAudioElement\";\nimport { EventEmitterCallback } from \"../model/EventEmitterCallback\";\nimport { AudioConstraint } from \"../model/AudioConstraint\";\nimport Recorder from \"../recorder/Recorder\";\nimport VoiceRecorderInterface from \"./interfaces/VoiceRecorderInterface\";\nimport { TYPES } from \"@/inversify.types\";\nimport AudioContextManagerInterface from \"@/audioEditor/interfaces/AudioContextManagerInterface\";\n\n@injectable()\nexport default class VoiceRecorder extends AbstractAudioElement implements VoiceRecorderInterface {\n\n    private contextManager: AudioContextManagerInterface | null | undefined;\n\n    private recorder: Recorder | null = null;\n\n    private input: MediaStreamAudioSourceNode | null = null;\n\n    private stream: MediaStream | null = null;\n\n    private alreadyInit = false;\n\n    private timer: TimerSaveTime | null = null;\n\n    private enableAudioFeedback = false;\n\n    private recording = false;\n\n    private deviceList: MediaDeviceInfo[] = [];\n\n    private constraints: AudioConstraintWrapper = {\n        audio: {\n            noiseSuppression: true,\n            echoCancellation: true,\n            autoGainControl: true,\n            sampleRate: { ideal: 44100 }\n        }\n    };\n\n    private sampleRateConfigNotSupported = false;\n\n    constructor(\n        @inject(TYPES.AudioContextManager) contextManager: AudioContextManagerInterface | null,\n        @inject(TYPES.ConfigService) configService: ConfigService) {\n        super();\n\n        this.contextManager = contextManager;\n        this.configService = configService;\n    }\n\n    async init() {\n        if (!this.isRecordingAvailable()) {\n            return;\n        }\n\n        // Specific case: Firefox doesn't support changing sample-rate for MediaDevice API\n        // In this case we disable sample-rate config feature for this VoiceRecorder\n        this.sampleRateConfigNotSupported = !navigator.mediaDevices.getSupportedConstraints().sampleRate;\n\n        if (this.contextManager) {\n            if (this.sampleRateConfigNotSupported) {\n                this.contextManager.createNewContext(0);\n            } else {\n                this.contextManager.createNewContextIfNeeded();\n            }\n        }\n\n        this.eventEmitter?.emit(EventType.RECORDER_INIT);\n\n        try {\n            const stream = await navigator.mediaDevices.getUserMedia(this.constraints);\n\n            if (this.contextManager && this.contextManager.currentContext) {\n                this.contextManager.currentContext.resume();\n            }\n\n            await this.setup(stream, false, false);\n\n            this.alreadyInit = true;\n            this.timer = new TimerSaveTime(0, 1);\n\n            this.timer.onCount(() => {\n                this.eventEmitter?.emit(EventType.RECORDER_COUNT_UPDATE);\n            });\n\n            this.successCallback();\n        } catch (e) {\n            console.error(e);\n\n            const exception = e as DOMException;\n\n            if (exception) {\n                switch (exception.name) {\n                case \"SecurityError\":\n                case \"NotAllowedError\":\n                    this.errorCallback();\n                    break;\n                case \"NotFoundError\":\n                    this.notFoundErrorCallback();\n                    break;\n                    // Disable sample rate configuration\n                case \"NotSupportedError\":\n                    if (!this.sampleRateConfigNotSupported) {\n                        this.sampleRateConfigNotSupported = true;\n                        this.init();\n                    }\n                    break;\n                default:\n                    this.unknownErrorCallback();\n                    break;\n                }\n            }\n        }\n\n        navigator.mediaDevices.ondevicechange = () => this.updateInputList();\n    }\n\n    private successCallback() {\n        this.eventEmitter?.emit(EventType.RECORDER_SUCCESS);\n    }\n\n    private errorCallback() {\n        this.eventEmitter?.emit(EventType.RECORDER_ERROR);\n    }\n\n    private notFoundErrorCallback() {\n        this.eventEmitter?.emit(EventType.RECORDER_NOT_FOUND_ERROR);\n    }\n\n    private unknownErrorCallback() {\n        this.eventEmitter?.emit(EventType.RECORDER_UNKNOWN_ERROR);\n    }\n\n    audioFeedback(enable: boolean) {\n        if (this.contextManager && this.contextManager.currentContext) {\n            if (enable) {\n                if (this.input) {\n                    this.input.connect(this.contextManager.currentContext.destination);\n                }\n\n                this.enableAudioFeedback = true;\n            } else {\n                if (this.input) {\n                    this.input.connect(this.contextManager.currentContext.destination);\n                    this.input.disconnect(this.contextManager.currentContext.destination);\n                }\n\n                this.enableAudioFeedback = false;\n            }\n\n            this.eventEmitter?.emit(EventType.RECORDER_UPDATE_CONSTRAINTS);\n        }\n    }\n\n    /**\n     * Get current constraints/settings\n     * @returns MediaTrackSettings\n     */\n    private getConstraints() {\n        if (this.stream) {\n            const tracks = this.stream.getTracks();\n\n            if (tracks && tracks.length > 0) {\n                return tracks[0].getSettings();\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * Update the current constraints\n     */\n    private updateConstraints() {\n        const constraints = this.getConstraints();\n\n        if (constraints) {\n            this.constraints.audio = Object.assign(this.constraints.audio, constraints);\n            this.eventEmitter?.emit(EventType.RECORDER_UPDATE_CONSTRAINTS);\n        }\n    }\n\n    /**\n     * Reset the current constraints\n     * @param newConstraint AudioConstraintWrapper\n     */\n    private async resetConstraints(newConstraint?: AudioConstraintWrapper) {\n        if (this.stream) {\n            const precAudioFeedback = this.enableAudioFeedback;\n            const precRecording = this.recording;\n            const tracks = this.stream.getTracks();\n\n            if (newConstraint) {\n                this.updateConstraints();\n                this.constraints.audio = Object.assign(this.constraints.audio, newConstraint.audio);\n            }\n\n            if (tracks && tracks.length > 0) {\n                try {\n                    await tracks[0].applyConstraints(this.constraints.audio);\n\n                    const newConstraints = this.getConstraints();\n                    const newConstraintName = newConstraint ? Object.keys(newConstraint.audio)[0] : \"\";\n\n                    this.audioFeedback(false);\n                    this.pause();\n\n                    if (!newConstraint ||\n                        (newConstraints && (newConstraints as AudioConstraint)[newConstraintName] != newConstraint.audio[newConstraintName])) {\n                        this.stopStream();\n\n                        const stream = await navigator.mediaDevices.getUserMedia(this.constraints);\n\n                        await this.setup(stream, precRecording, precAudioFeedback);\n                    } else {\n                        await this.setup(null, precRecording, precAudioFeedback);\n                    }\n                } catch (e) {\n                    console.error(e);\n                    this.errorCallback();\n                }\n            }\n        }\n    }\n\n    /**\n     * Setup this voice recorder\n     * @param stream MediaStream\n     * @param precRecording Was recording?\n     * @param precAudioFeedback Has audio feedback?\n     */\n    private async setup(stream: MediaStream | null, precRecording: boolean, precAudioFeedback: boolean) {\n        if (stream && this.contextManager && this.contextManager.currentContext) {\n            this.input = this.contextManager.currentContext.createMediaStreamSource(stream);\n            this.stream = stream;\n        }\n\n        if (this.recorder && this.input) {\n            await this.recorder.setup(this.input);\n\n            if (precRecording) {\n                await this.record();\n            }\n        }\n\n        this.audioFeedback(precAudioFeedback);\n        this.updateConstraints();\n        await this.updateInputList();\n    }\n\n    setNoiseSuppression(enable: boolean) {\n        this.resetConstraints({\n            audio: {\n                noiseSuppression: enable\n            }\n        });\n    }\n\n    setAutoGain(enable: boolean) {\n        this.resetConstraints({\n            audio: {\n                autoGainControl: enable\n            }\n        });\n    }\n\n    setEchoCancellation(enable: boolean) {\n        this.resetConstraints({\n            audio: {\n                echoCancellation: enable\n            }\n        });\n    }\n\n    /**\n     * Update current audio input list\n     */\n    private async updateInputList() {\n        if (this.deviceList) {\n            const devices = await navigator.mediaDevices.enumerateDevices();\n            this.deviceList = [];\n\n            devices.forEach(device => {\n                if (device.kind == \"audioinput\") {\n                    this.deviceList.push(device);\n                }\n            });\n        }\n    }\n\n    changeInput(deviceId: string, groupId: string | undefined) {\n        if (groupId) {\n            this.constraints.audio.deviceId = deviceId;\n            this.constraints.audio.groupId = groupId;\n            this.resetConstraints();\n        }\n    }\n\n    async record() {\n        if (this.alreadyInit && this.configService && this.input) {\n            if (!this.recorder) {\n                this.recorder = new Recorder({\n                    bufferLen: this.configService.getBufferSize(),\n                    sampleRate: this.configService.getSampleRate(),\n                    numChannels: 2,\n                    workletBasePath: this.configService.getWorkletBasePath(),\n                    workerBasePath: this.configService.getWorkerBasePath(),\n                    mimeType: \"audio/wav\"\n                });\n\n                await this.recorder.setup(this.input);\n            }\n\n            if (this.recorder) {\n                this.recorder.record();\n            }\n\n            if (this.timer) {\n                this.timer.start();\n            }\n\n            this.recording = true;\n\n            if (this.eventEmitter) {\n                this.eventEmitter.emit(EventType.RECORDER_RECORDING);\n            }\n        }\n    }\n\n    async stop() {\n        if (this.alreadyInit && this.recorder) {\n            this.recorder.stop();\n\n            if (this.timer) {\n                this.timer.stop();\n            }\n\n            this.recording = false;\n\n            this.recorder.getBuffer((buffer: Float32Array[]) => {\n                if (this.contextManager && this.contextManager.currentContext) {\n                    this.contextManager.currentContext.resume();\n\n                    const newBuffer = this.contextManager.currentContext.createBuffer(2, buffer[0].length, this.contextManager.currentContext.sampleRate);\n                    newBuffer.getChannelData(0).set(buffer[0]);\n                    newBuffer.getChannelData(1).set(buffer[1]);\n\n                    this.eventEmitter?.emit(EventType.RECORDER_STOPPED, newBuffer);\n                    this.reset();\n                }\n            });\n        }\n    }\n\n    pause() {\n        if (this.alreadyInit) {\n            if (this.recorder) {\n                this.recorder.stop();\n            }\n\n            if (this.timer) {\n                this.timer.stop();\n            }\n\n            this.recording = false;\n            this.eventEmitter?.emit(EventType.RECORDER_PAUSED);\n        }\n    }\n\n    /**\n     * Stop stream\n     */\n    private stopStream() {\n        if (this.stream) {\n            const tracks = this.stream.getTracks();\n\n            for (let i = 0, l = tracks.length; i < l; i++) {\n                tracks[i].stop();\n            }\n        }\n    }\n\n    reset() {\n        if (this.recorder) {\n            this.recorder.kill();\n        }\n\n        if (this.timer) {\n            this.timer.stop();\n        }\n\n        this.audioFeedback(false);\n\n        this.stopStream();\n\n        this.input = null;\n        this.recorder = null;\n        this.stream = null;\n        this.alreadyInit = false;\n        this.timer = null;\n\n        this.eventEmitter?.emit(EventType.RECORDER_RESETED);\n    }\n\n    get currentTimeDisplay() {\n        return this.timer?.seconds ? (\"0\" + Math.trunc(this.timer?.seconds / 60)).slice(-2) + \":\" + (\"0\" + Math.trunc(this.timer?.seconds % 60)).slice(-2) : \"00:00\";\n    }\n\n    get currentTime() {\n        return this.timer ? this.timer.seconds : 0;\n    }\n\n    getSettings(): RecorderSettings {\n        return {\n            deviceList: this.deviceList,\n            audioFeedback: this.enableAudioFeedback,\n            constraints: this.constraints.audio\n        };\n    }\n\n    on(event: string, callback: EventEmitterCallback) {\n        this.eventEmitter?.on(event, callback);\n    }\n\n    isRecordingAvailable() {\n        return typeof (navigator.mediaDevices) !== \"undefined\" && typeof (navigator.mediaDevices.getUserMedia) !== \"undefined\";\n    }\n}\n","import { injectable } from \"inversify\";\nimport AbstractAudioElement from \"@/interfaces/AbstractAudioElement\";\n\n@injectable()\nexport default abstract class AbstractAudioNode extends AbstractAudioElement {\n\n    /** Is this element enabled? */\n    private enabled = false;\n\n    /** Is this element enabled by default? */\n    private defaultEnabled = false;\n\n    /** Returns the order in which the filter/renderer needs to be applied */\n    abstract get order(): number;\n\n    /** Returns the id of this filter/renderer */\n    abstract get id(): string;\n\n    /** Is this filter/renderer enabled? */\n    isEnabled(): boolean {\n        return this.enabled;\n    }\n\n    /** Is this filter/renderer enabled by default? */\n    isDefaultEnabled(): boolean {\n        return this.defaultEnabled;\n    }\n\n    /** Set to true if this filter/renderer needs to be enabled by default */\n    setDefaultEnabled(state: boolean) {\n        this.defaultEnabled = state;\n\n        if (state) {\n            this.enable();\n        } else {\n            this.disable();\n        }\n    }\n\n    /**\n     * Set the enabled/disabled state\n     * @param state true to enable, false to disable\n     */\n    setEnabled(state: boolean) {\n        this.enabled = state;\n    }\n\n    /** Enable this filter/renderer */\n    enable() {\n        this.setEnabled(true);\n    }\n\n    /** Disable this filter/renderer */\n    disable() {\n        this.setEnabled(false);\n    }\n\n    /** Toggle to enabled/disabled this filter */\n    toggle() {\n        this.setEnabled(!this.isEnabled());\n    }\n}\n","import { AudioFilterNodes } from \"../../model/AudioNodes\";\nimport { FilterSettingValue, FilterSettings } from \"../../model/filtersSettings/FilterSettings\";\nimport AbstractAudioNode from \"./AbstractAudioNode\";\n\nexport default abstract class AbstractAudioFilter extends AbstractAudioNode {\n\n    /** The default settings */\n    private defaultSettings: FilterSettings | null = null;\n\n    /** Total sample of the input audio buffer */\n    protected _totalSamples = 0;\n\n    /** Return a input and output AudioNode of the filter */\n    abstract getNode(context: BaseAudioContext): AudioFilterNodes;\n\n    /** Return an object with current settings of this filter */\n    abstract getSettings(): FilterSettings;\n\n    /** Set a filter setting */\n    abstract setSetting(settingId: string, value: FilterSettingValue): Promise<void>;\n\n    /** Get the amount of time this filter add to the audio */\n    getAddingTime(): number {\n        return 0;\n    }\n\n    /** Store the default settings */\n    public initializeDefaultSettings() {\n        this.defaultSettings = this.getSettings();\n    }\n\n    /** Returns the default settings of this filter */\n    public getDefaultSettings() {\n        return this.defaultSettings;\n    }\n\n    /** Reset the default settings of this filter */\n    public async resetSettings() {\n        if (this.defaultSettings) {\n            for (const key in this.defaultSettings) {\n                if (this.defaultSettings && typeof (this.defaultSettings[key]) !== \"undefined\") {\n                    await this.setSetting(key, this.defaultSettings[key]);\n                }\n            }\n        }\n    }\n\n    /** Return if the current filter use an audio worklet */\n    public isWorklet() {\n        return false;\n    }\n\n    /**\n     * Called when the buffer fetcher was reseted\n     * @returns boolean\n    */\n    public async bufferFetcherReseted(): Promise<boolean> {\n        return false;\n    }\n\n    set totalSamples(value: number) {\n        this._totalSamples = value;\n    }\n}\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n/**\n * This class is a polyfill for the standard web AudioParam class used by worklets\n */\nexport default class AudioParamPolyfill implements AudioParam {\n    private _value: number = 0;\n    private _minValue: number = 0;\n    private _maxValue: number = Number.MAX_SAFE_INTEGER;\n    private _defaultValue: number = 0;\n    private context: BaseAudioContext | null = null;\n    automationRate: AutomationRate = \"a-rate\";\n\n    constructor(context: BaseAudioContext, defaultValue?: number) {\n        this._defaultValue = defaultValue !== undefined ? defaultValue : 0;\n        this._value = this._defaultValue;\n        this.context = context;\n    }\n\n    get value(): number {\n        return this._value;\n    }\n\n    set value(newValue: number) {\n        this._value = Math.max(this._minValue, Math.min(this._maxValue, newValue));\n    }\n\n    get minValue(): number {\n        return this._minValue;\n    }\n\n    get maxValue(): number {\n        return this._maxValue;\n    }\n\n    get defaultValue(): number {\n        return this._defaultValue;\n    }\n\n    setValueAtTime(value: number, startTime: number): AudioParam {\n        console.warn(\"setValueAtTime used with AudioParamPolyfill, is not fully compatible with standard AudioParam\");\n        this.value = value;\n        return new AudioParamPolyfill(this.context!, value);\n    }\n\n    linearRampToValueAtTime(value: number, endTime: number): AudioParam {\n        console.warn(\"linearRampToValueAtTime used with AudioParamPolyfill, is not fully compatible with standard AudioParam\");\n        this.value = value;\n        return new AudioParamPolyfill(this.context!, value);\n    }\n\n    exponentialRampToValueAtTime(value: number, endTime: number): AudioParam {\n        console.warn(\"exponentialRampToValueAtTime used with AudioParamPolyfill, is not fully compatible with standard AudioParam\");\n        this.value = value;\n        return new AudioParamPolyfill(this.context!, value);\n    }\n\n    cancelAndHoldAtTime(cancelTime: number): AudioParam {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    cancelScheduledValues(cancelTime: number): AudioParam {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    setTargetAtTime(target: number, startTime: number, timeConstant: number): AudioParam {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    setValueCurveAtTime(values: unknown, startTime: unknown, duration: unknown): AudioParam {\n        throw new Error(\"Method not implemented.\");\n    }\n}\n","import SimpleAudioWorkletProcessor from \"./SimpleAudioWorkletProcessor\";\nimport AudioParamPolyfill from \"./AudioParamPolyfill\";\nimport Functions from \"../utils/Functions\";\n\n/**\n * This class convert an audio worklet processor node to a script processor node\n * automagically. Might not work with some WorkletProcessor\n */\nexport default class WorkletScriptProcessorNodeAdapter {\n\n    private workletProcessor: SimpleAudioWorkletProcessor;\n    private _parameters = new Map<string, AudioParamPolyfill>();\n    private _port: MessagePort | null = null;\n    private _scriptProcessorNode: ScriptProcessorNode | null;\n    private currentContext: BaseAudioContext | null = null;\n\n    constructor(context: BaseAudioContext, node: SimpleAudioWorkletProcessor, bufferSize?: number) {\n        this.workletProcessor = node;\n        this.currentContext = context;\n\n        // Create a ScriptProcessorNode with two channels\n        this._scriptProcessorNode = context.createScriptProcessor(\n            bufferSize,\n            2,\n            2\n        );\n\n        this.setupPort();\n        this.setupProcessor();\n        this.setupWorkletScope(context);\n    }\n\n    private setupPort(): void {\n        const messageChannel = new MessageChannel();\n\n        messageChannel.port1.onmessage = (ev) => {\n            if(this.workletProcessor && this.workletProcessor.port2) {\n                this.workletProcessor.port2.postMessage(ev.data);\n            }\n        };\n\n        if(this.workletProcessor && this.workletProcessor.port2) {\n            this.workletProcessor.port2.onmessage = (ev) => {\n                messageChannel.port1.postMessage(ev.data);\n            };\n        }\n\n        this._port = messageChannel.port2;\n    }\n\n    private setupProcessor() {\n        if(!this._scriptProcessorNode) {\n            return;\n        }\n\n        this._scriptProcessorNode.onaudioprocess = (ev: AudioProcessingEvent) => {\n            if(this.workletProcessor) {\n                const inputArray = [Functions.convertAudioBufferToFloat32Array(ev.inputBuffer)];\n                const ouputArray = [Functions.convertAudioBufferToFloat32Array(ev.outputBuffer)];\n\n                const records: [string, Float32Array][] = [];\n\n                for (const [key, value] of this._parameters.entries()) {\n                    records.push([key, Functions.convertAudioParamToFloat32Array(value, 1)]);\n                }\n\n                const recordsMap: Record<string, Float32Array> = Object.fromEntries(records);\n                \n                this.workletProcessor.process(inputArray, ouputArray, recordsMap);\n            }\n        };\n\n        const descriptors = this.workletProcessor.defaultParameterDescriptors;\n\n        if(descriptors) {\n            descriptors.forEach(descriptor => {\n                if(this.currentContext) {\n                    this._parameters.set(descriptor.name, new AudioParamPolyfill(this.currentContext, descriptor.defaultValue));\n                }\n            });\n        }\n    }\n\n    private setupWorkletScope(context: BaseAudioContext) {\n        if(typeof(window) !== \"undefined\") {\n            window.sampleRate = context.sampleRate;\n        }\n    }\n\n    get port() {\n        return this._port;\n    }\n\n    get parameters(): AudioParamMap {\n        return this._parameters;\n    }\n\n    get node() {\n        return this._scriptProcessorNode;\n    }\n\n    get context() {\n        return this._scriptProcessorNode?.context;\n    }\n}\n","import SimpleAudioWorkletProcessor from \"./SimpleAudioWorkletProcessor\";\n\n/**\n * Polyfill for registerProcessor method used in AudioWorklets\n */\nexport default class RegisterProcessorPolyfill {\n\n    private static processorsMap = new Map<string, typeof SimpleAudioWorkletProcessor>();\n\n    static registerProcessor(processorName: string, processorClass: typeof SimpleAudioWorkletProcessor) {\n        RegisterProcessorPolyfill.processorsMap.set(processorName, processorClass);\n    }\n\n    static getProcessor(processorName: string): SimpleAudioWorkletProcessor | null {\n        const processor = RegisterProcessorPolyfill.processorsMap.get(processorName);\n\n        if(processor) {\n            return new processor();\n        }\n\n        return null;\n    }\n};\n","/**\n * This class is the standard AudioWorkletProcessor interface\n */\nexport interface AudioWorkletProcessorInterface {\n\n    process(inputs: Float32Array[][], outputs: Float32Array[][], parameters: Record<string, Float32Array>): boolean;\n    get parameters(): AudioParamMap;\n    get parameterDescriptors(): AudioParamMap;\n    messageProcessor?: (event: MessageEvent) => void;\n}\n\ntype ParameterDescriptors = {\n    name: string;\n    defaultValue: number;\n}[];\n\n/**\n * This class is a polyfill for the AudioWorkletProcessor interface\n */\nexport default class SimpleAudioWorkletProcessor implements AudioWorkletProcessorInterface {\n    private messageChannel: MessageChannel | null = null;\n    messageProcessor?: ((event: MessageEvent) => void) | undefined;\n\n    constructor() {\n        this.messageChannel = new MessageChannel();\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    process(inputs: Float32Array[][], outputs: Float32Array[][], parameters: Record<string, Float32Array>): boolean {\n        return true;\n    }\n\n    get port(): MessagePort | null {\n        return this.messageChannel && this.messageChannel.port1;\n    }\n\n    get port2(): MessagePort | null {\n        return this.messageChannel && this.messageChannel.port2;\n    }\n\n    get parameters(): AudioParamMap {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    get parameterDescriptors(): AudioParamMap {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    get defaultParameterDescriptors(): ParameterDescriptors {\n        return [];\n    }\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport RegisterProcessorPolyfill from \"./RegisterProcessorPolyfill\";\nimport SimpleAudioWorkletProcessor from \"./SimpleAudioWorkletProcessor\";\n\nif(typeof(window) !== \"undefined\" && !(\"AudioWorkletProcessor\" in window)) {\n    (window as any).AudioWorkletProcessor = SimpleAudioWorkletProcessor;\n    (window as any).registerProcessor = RegisterProcessorPolyfill.registerProcessor;\n}\n\nif(typeof(global) !== \"undefined\" && !(\"AudioWorkletProcessor\" in global)) {\n    (global as any).AudioWorkletProcessor = SimpleAudioWorkletProcessor;\n    (global as any).registerProcessor = RegisterProcessorPolyfill.registerProcessor;\n}\n","import WorkletScriptProcessorNodeAdapter from \"../../workletPolyfill/WorkletScriptProcessorNodeAdapter\";\nimport AbstractAudioFilter from \"./AbstractAudioFilter\";\nimport Constants from \"../../model/Constants\";\nimport \"../../workletPolyfill/AudioWorkletProcessorPolyfill\";\nimport RegisterProcessorPolyfill from \"../../workletPolyfill/RegisterProcessorPolyfill\";\nimport utilFunctions from \"../../utils/Functions\";\n\nexport default abstract class AbstractAudioFilterWorklet<T> extends AbstractAudioFilter {\n\n    protected currentWorkletNode: AudioWorkletNode | WorkletScriptProcessorNodeAdapter | null = null;\n\n    protected fallbackToScriptProcessor = false;\n\n    protected keepCurrentNodeIfPossible = false;\n\n    /**\n     * Return the worklet name (as registered with method registerProcessor)\n     */\n    abstract get workletName(): string;\n\n    /**\n     * Return the path to worklet file\n     */\n    abstract get workletPath(): string;\n\n    /**\n     * Receive event from the worklet\n     */\n    abstract receiveEvent(message: MessageEvent<T>): void;\n\n    /**\n     * Initialize the audio worklet by loading the module\n     * @param audioContext The audio context\n     */\n    async initializeWorklet(audioContext: BaseAudioContext): Promise<void> {\n        this.stop();\n\n        if (!utilFunctions.isAudioWorkletCompatible(audioContext)) {\n            console.error(\"Audio Worklets not supported on this browser. Fallback to ScriptProcessor\");\n            this.fallbackToScriptProcessor = true;\n            return;\n        }\n\n        const workletPath = (this.configService ? this.configService.getWorkletBasePath() : \"\") + this.workletPath;\n\n        await audioContext.audioWorklet.addModule(workletPath)\n            .catch(e => {\n                console.error(`Error when loading Worklet (${workletPath}) for filter ${this.id}. Fallback to ScriptProcessor. Exception:`, e);\n                this.fallbackToScriptProcessor = true;\n            });\n    }\n\n    /**\n     * This method checks if audio worklet are enabled\n     * @param audioContext \n     */\n    protected isAudioWorkletEnabled() {\n        if (this.configService) {\n            return this.configService.isAudioWorkletEnabled();\n        }\n\n        return Constants.ENABLE_AUDIO_WORKLET;\n    }\n\n    /**\n     * Initialize the AudioWorkletNode or fallback to ScriptProcessorNode\n     * @param context The audio context\n     * @param workletName The worklet name\n     */\n    private initializeNode(context: BaseAudioContext, workletName: string) {\n        if (this.isAudioWorkletEnabled() && !this.fallbackToScriptProcessor) {\n            // Standard Audio Worklet\n            this.currentWorkletNode = new AudioWorkletNode(context, workletName);\n        } else {\n            // Fallback to ScriptProcessorNode (polyfill)\n            const processor = RegisterProcessorPolyfill.getProcessor(workletName);\n\n            if (processor) {\n                this.currentWorkletNode = new WorkletScriptProcessorNodeAdapter(context, processor, this.configService!.getBufferSize());\n            } else {\n                throw new Error(`No processor registered with name ${workletName} for filter ${this.id} to use the fallback/polyfill for AudioWorklet. Make sure you have created the class.`);\n            }\n        }\n\n        if (this.currentWorkletNode && this.currentWorkletNode.port) {\n            this.currentWorkletNode.port.onmessage = message => this.receiveEvent(message);\n        }\n    }\n\n    /**\n     * Apply current settings to the audio worklet node.\n     * Uses the getSettings method to extract the settings.\n     */\n    protected applyCurrentSettingsToWorklet() {\n        if (this.currentWorkletNode && this.currentWorkletNode.parameters) {\n            const currentSettings = this.getSettings();\n\n            for (const settingKey of Object.keys(currentSettings)) {\n                const settingFromWorklet = this.currentWorkletNode.parameters.get(settingKey);\n\n                if (settingFromWorklet) {\n                    settingFromWorklet.value = currentSettings[settingKey] as number;\n                    settingFromWorklet.setValueAtTime(currentSettings[settingKey] as number, 0);\n                }\n            }\n        }\n    }\n\n    /** Default implementation for GetNode - AbstractAudioFilterWorklet */\n    getNode(context: BaseAudioContext) {\n        if (!this.keepCurrentNodeIfPossible || !this.currentWorkletNode\n            || this.currentWorkletNode.context != context) {\n            this.stop();\n            this.initializeNode(context, this.workletName);\n        }\n\n        this.applyCurrentSettingsToWorklet();\n        this.setEnabled(this.isEnabled());\n\n        if (this.currentWorkletNode) {\n            if (this.currentWorkletNode instanceof WorkletScriptProcessorNodeAdapter) {\n                return {\n                    input: this.currentWorkletNode.node!,\n                    output: this.currentWorkletNode.node!,\n                };\n            } else {\n                return {\n                    input: this.currentWorkletNode,\n                    output: this.currentWorkletNode,\n                };\n            }\n        }\n\n        throw new Error(\"Worklet node has not yet been created\");\n    }\n\n    /**\n     * Stop the current worklet node. The worklet need to respond to \"stop\" events.\n     */\n    stop() {\n        if (this.currentWorkletNode && this.currentWorkletNode.port) {\n            this.currentWorkletNode.port.postMessage(\"stop\");\n            this.currentWorkletNode.port.onmessage = null;\n        }\n\n        this.currentWorkletNode = null;\n    }\n\n    /**\n     * Pass the current disabled/enabled state to the worklet.\n     * The worklet need to respond to \"enable\"/\"disable\" events.\n     * @param state The current disabled/enabled state\n     */\n    setEnabled(state: boolean): void {\n        if (this.currentWorkletNode && this.currentWorkletNode.port) {\n            this.currentWorkletNode.port.postMessage(state ? \"enable\" : \"disable\");\n        }\n\n        super.setEnabled(state);\n    }\n\n    public isWorklet(): boolean {\n        return true;\n    }\n}\n","import AbstractAudioNode from \"./AbstractAudioNode\";\n\n\nexport default abstract class AbstractAudioRenderer extends AbstractAudioNode {\n\n    /** Render an AudioBuffer based on another input AudioBuffer */\n    abstract renderAudio(context: BaseAudioContext, buffer: AudioBuffer): Promise<AudioBuffer>;\n}\n","import { injectable } from \"inversify\";\nimport AudioEditorEvents from \"../model/AudioEditorEvent\";\nimport { EventEmitterCallback } from \"../model/EventEmitterCallback\";\nimport EventEmitterInterface from \"./interfaces/EventEmitterInterface\";\n\n@injectable()\nexport default class EventEmitter implements EventEmitterInterface {\n    listeners: AudioEditorEvents = {};\n    \n    constructor() {\n        this.listeners = {};\n    }\n\n    on(event: string, callback: EventEmitterCallback) {\n        if (!this.listeners[event]) {\n            this.listeners[event] = [];\n        }\n        this.listeners[event].push(callback);\n    }\n\n    emit(event: string, data?: string | number | AudioBuffer) {\n        if (this.listeners[event]) {\n            this.listeners[event].forEach(callback => {\n                callback(data);\n            });\n        }\n    }\n\n    off(event: string, callback: EventEmitterCallback) {\n        if (this.listeners[event]) {\n            this.listeners[event] = this.listeners[event].filter(cb => cb !== callback);\n        }\n    }\n}\n","import { injectable } from \"inversify\";\nimport Constants from \"../model/Constants\";\nimport { ConfigService } from \"./interfaces/ConfigService\";\n\n/**\n * Default implementation for a ConfigService, using a built-in map.\n * The configuration is not stored in localstorage in this case.\n */\n@injectable()\nexport default class GenericConfigService implements ConfigService {\n\n    private mapConfig = new Map<string, string>();\n\n    private workerBasePath = \"\";\n    private workletBasePath = \"\";\n    private soundBasePath = \"\";\n\n    getConfig(key: string): string | undefined | null {\n        return this.mapConfig.get(key);\n    }\n\n    setConfig(key: string, value: string): void {\n        this.mapConfig.set(key, value);\n    }\n\n    isCompatibilityModeEnabled(): boolean {\n        return this.getConfig(Constants.PREFERENCES_KEYS.COMPATIBILITY_MODE_ENABLED) == \"true\";\n    }\n\n    isCompatibilityModeChecked(): boolean {\n        return this.getConfig(Constants.PREFERENCES_KEYS.COMPATIBILITY_MODE_CHECKED) == \"true\";\n    }\n\n    isAudioWorkletEnabled(): boolean {\n        const setting = this.getConfig(Constants.PREFERENCES_KEYS.ENABLE_AUDIO_WORKLET);\n\n        if(setting != null) {\n            return setting == \"true\";\n        }\n\n        return Constants.ENABLE_AUDIO_WORKLET;\n    }\n\n    isSoundtouchAudioWorkletEnabled(): boolean {\n        const setting = this.getConfig(Constants.PREFERENCES_KEYS.ENABLE_SOUNDTOUCH_AUDIO_WORKLET);\n\n        if(setting != null) {\n            return setting == \"true\";\n        }\n\n        return Constants.ENABLE_SOUNDTOUCH_AUDIO_WORKLET;\n    }\n\n    getBufferSize(): number {\n        const setting = this.getConfig(Constants.PREFERENCES_KEYS.BUFFER_SIZE);\n\n        if(setting != null) {\n            return parseInt(setting);\n        }\n\n        return Constants.DEFAULT_BUFFER_SIZE;\n    }\n\n    getSampleRate(): number {\n        const setting = this.getConfig(Constants.PREFERENCES_KEYS.SAMPLE_RATE);\n\n        if(setting != null) {\n            return parseInt(setting);\n        }\n\n        return Constants.DEFAULT_SAMPLE_RATE;\n    }\n\n    getBitrateMP3(): number {\n        const setting = this.getConfig(Constants.PREFERENCES_KEYS.BITRATE_MP3);\n\n        if(setting != null) {\n            return parseInt(setting);\n        }\n\n        return Constants.DEFAULT_MP3_BITRATE;\n    }\n\n    enableCompatibilityMode() {\n        this.setConfig(Constants.PREFERENCES_KEYS.COMPATIBILITY_MODE_ENABLED, \"true\");\n    }\n\n    disableCompatibilityMode() {\n        this.setConfig(Constants.PREFERENCES_KEYS.COMPATIBILITY_MODE_ENABLED, \"false\");\n    }\n\n    getWorkletBasePath(): string {\n        return this.workletBasePath;\n    }\n\n    getWorkerBasePath(): string {\n        return this.workerBasePath;\n    }\n\n    getSoundBasePath(): string {\n        return this.soundBasePath;\n    }\n\n    setWorkletBasePath(workletBasePath: string) {\n        this.workletBasePath = workletBasePath;\n    }\n\n    setWorkerBasePath(workerBasePath: string) {\n        this.workerBasePath = workerBasePath;\n    }\n\n    setSoundBasePath(soundBasePath: string) {\n        this.soundBasePath = soundBasePath;\n    }\n\n    isInitialRenderingDisabled(): boolean {\n        const setting = this.getConfig(Constants.PREFERENCES_KEYS.DISABLE_INITIAL_RENDERING);\n\n        if(setting != null) {\n            return setting == \"true\";\n        }\n\n        return Constants.DISABLE_INITIAL_RENDERING;\n    }\n};\n","import { inject, injectable } from \"inversify\";\nimport { EventType } from \"@/model/EventTypeEnum\";\nimport Constants from \"@/model/Constants\";\nimport EventEmitter from \"@/utils/EventEmitter\";\nimport AudioContextManagerInterface from \"./interfaces/AudioContextManagerInterface\";\nimport { ConfigService } from \"@/services/interfaces/ConfigService\";\nimport EventEmitterInterface from \"@/utils/interfaces/EventEmitterInterface\";\nimport { TYPES } from \"@/inversify.types\";\n\n@injectable()\nexport default class AudioContextManager implements AudioContextManagerInterface {\n\n    /** The current event emitter */\n    private eventEmitter: EventEmitterInterface | undefined;\n\n    /** The config service */\n    private configService: ConfigService | null;\n\n    /** The current audio context */\n    private _currentContext: AudioContext | null | undefined;\n\n    /** The previous sample rate setting */\n    private previousSampleRate = Constants.DEFAULT_SAMPLE_RATE;\n\n    constructor(\n        @inject(TYPES.EventEmitter) eventEmitter: EventEmitterInterface | null,\n        @inject(TYPES.ConfigService) configService: ConfigService | null) {\n        this.eventEmitter = eventEmitter || new EventEmitter();\n        this.configService = configService;\n\n        this.setup();\n    }\n\n    private setup() {\n        if (this.configService) {\n            this.previousSampleRate = this.configService.getSampleRate();\n\n            if (this.eventEmitter) {\n                this.eventEmitter.emit(EventType.SAMPLE_RATE_CHANGED, this.previousSampleRate);\n            }\n        }\n\n        if (!this.currentContext) {\n            this.createNewContext(this.previousSampleRate);\n        }\n    }\n\n    createNewContextIfNeeded(principalBuffer?: AudioBuffer | null) {\n        const isCompatibilityModeEnabled = this.configService && this.configService.isCompatibilityModeEnabled();\n\n        if (isCompatibilityModeEnabled && principalBuffer) {\n            // If compatibility mode is enabled, we use the sample rate of the input audio buffer\n            if (this.currentSampleRate != principalBuffer.sampleRate) {\n                this.createNewContext(principalBuffer.sampleRate);\n                return true;\n            }\n        } else {\n            // Otherwise we change the context if the sample rate has changed\n            let currentSampleRate = Constants.DEFAULT_SAMPLE_RATE;\n\n            if (this.configService) {\n                currentSampleRate = this.configService.getSampleRate();\n            }\n\n            // If sample rate setting has changed, create a new audio context\n            if (currentSampleRate != this.previousSampleRate) {\n                this.createNewContext(currentSampleRate);\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    /** \n     * Stop previous audio context and create a new one\n     * @param sampleRate New sample rate\n     */\n    createNewContext(sampleRate: number) {\n        if (this._currentContext) {\n            this.destroyOldContext(this._currentContext);\n        }\n\n        const options: AudioContextOptions = {\n            latencyHint: \"interactive\"\n        };\n\n        if (sampleRate != 0) {\n            options.sampleRate = sampleRate;\n        }\n\n        this._currentContext = new AudioContext(options);\n\n        if (this.eventEmitter) {\n            this.eventEmitter.emit(EventType.SAMPLE_RATE_CHANGED, this.currentSampleRate);\n        }\n\n        this.previousSampleRate = sampleRate;\n    }\n\n    /**\n     * Destroy previous AudioContext\n     */\n    private destroyOldContext(oldAudioContext: AudioContext) {\n        if(oldAudioContext) {\n            oldAudioContext.close();\n        }\n    }\n\n    get currentSampleRate(): number {\n        if (this.currentContext) {\n            return this.currentContext.sampleRate;\n        }\n\n        return 0;\n    }\n\n    get currentContext() {\n        return this._currentContext;\n    }\n}\n","import AbstractAudioElement from \"@/interfaces/AbstractAudioElement\";\nimport { EventType } from \"@/model/EventTypeEnum\";\nimport utils from \"../utils/Functions\";\nimport Constants from \"@/model/Constants\";\nimport AudioProcessorInterface from \"./interfaces/AudioProcessorInterface\";\nimport { inject, injectable } from \"inversify\";\nimport type BufferPlayerInterface from \"@/bufferPlayer/interfaces/BufferPlayerInterface\";\nimport type BufferManagerInterface from \"./interfaces/BufferManagerInterface\";\nimport AudioContextManagerInterface from \"./interfaces/AudioContextManagerInterface\";\nimport type RendererManagerInterface from \"./interfaces/RendererManagerInterface\";\nimport type FilterManagerInterface from \"./interfaces/FilterManagerInterface\";\nimport { TYPES } from \"@/inversify.types\";\n\n@injectable()\nexport default class AudioProcessor extends AbstractAudioElement implements AudioProcessorInterface {\n\n    /** The filter manager */\n    private filterManager: FilterManagerInterface | undefined;\n\n    /** The filter manager */\n    private rendererManager: RendererManagerInterface | undefined;\n\n    /** The context manager */\n    private contextManager: AudioContextManagerInterface | undefined;\n\n    /** The audio player */\n    private bufferPlayer: BufferPlayerInterface | undefined;\n\n    /** The save buffer manager */\n    private bufferManager: BufferManagerInterface | undefined;\n\n    /** The current offline context */\n    private currentOfflineContext: OfflineAudioContext | null | undefined;\n\n    /** The resulting audio buffer */\n    private _renderedBuffer: AudioBuffer | null = null;\n\n    /** true if the user wanted to cancel audio rendering */\n    private audioRenderingLastCanceled = false;\n\n    /** true if initial rendering for the current buffer was done */\n    initialRenderingDone = false;\n    /** The sum of all the samples of the input buffer,\n     * used to detect the need to enable the compatibility mode */\n    sumInputBuffer: number = 0;\n\n    constructor(\n        @inject(TYPES.FilterManager) filterManager: FilterManagerInterface | undefined,\n        @inject(TYPES.RendererManager) rendererManager: RendererManagerInterface | undefined,\n        @inject(TYPES.AudioContextManager) contextManager: AudioContextManagerInterface | undefined,\n        @inject(TYPES.BufferPlayer) bufferPlayer: BufferPlayerInterface | undefined,\n        @inject(TYPES.BufferManager) bufferManager: BufferManagerInterface | undefined) {\n        super();\n\n        this.contextManager = contextManager;\n        this.bufferPlayer = bufferPlayer;\n        this.filterManager = filterManager;\n        this.rendererManager = rendererManager;\n        this.bufferManager = bufferManager;\n    }\n\n    async prepareContext(inputBuffer: AudioBuffer | null) {\n        if (this.contextManager) {\n            const changed = this.contextManager.createNewContextIfNeeded(inputBuffer);\n\n            if (changed && this.bufferManager) {\n                await this.bufferManager.resetBufferFetcher();\n            }\n\n            if (this.contextManager.currentContext) {\n                this.contextManager.currentContext.resume();\n            }\n        }\n    }\n\n    async renderAudio(inputBuffer: AudioBuffer | null, forceInitialRendering?: boolean): Promise<boolean> {\n        await this.prepareContext(inputBuffer);\n\n        if (!this.contextManager || !this.contextManager.currentContext) {\n            throw new Error(\"AudioContext is not yet available\");\n        }\n\n        if (!this.filterManager) {\n            throw new Error(\"Filter manager is not available\");\n        }\n\n        if (!this.rendererManager) {\n            throw new Error(\"Renderer manager is not available\");\n        }\n\n        if (!this.filterManager.entrypointFilter) {\n            throw new Error(\"Entrypoint filter is not available\");\n        }\n\n        if (!inputBuffer) {\n            throw new Error(\"No principal buffer available\");\n        }\n\n        // If initial rendering is disabled and compatibility mode is disabled, we stop here\n        if (!this.initialRenderingDone && this.configService && this.configService.isInitialRenderingDisabled() && !this.configService.isCompatibilityModeEnabled() && !forceInitialRendering) {\n            this.loadInitialBuffer(inputBuffer);\n            this.initialRenderingDone = true;\n            return true;\n        }\n\n        // If switching from compatiblity mode to normal mode, we stop the audio player\n        if (this.configService && this.bufferPlayer && !this.configService.isCompatibilityModeEnabled() && this.bufferPlayer.compatibilityMode) {\n            this.bufferPlayer.stop();\n        }\n\n        const speedAudio = this.filterManager.entrypointFilter.getSpeed();\n        const durationAudio = utils.calculateAudioDuration(inputBuffer, this.filterManager, speedAudio);\n        const offlineContext = new OfflineAudioContext(2, this.contextManager.currentContext.sampleRate * durationAudio, this.contextManager.currentContext.sampleRate);\n        const outputContext = this.configService && this.configService.isCompatibilityModeEnabled() ? this.contextManager.currentContext : offlineContext;\n\n        this._renderedBuffer = await this.rendererManager.executeAudioRenderers(inputBuffer, outputContext);\n        this.currentOfflineContext = null;\n        this.audioRenderingLastCanceled = false;\n\n        utils.resetAudioRenderingProgress(this.eventEmitter);\n        this.filterManager.setupTotalSamples(durationAudio, this.contextManager.currentContext);\n\n        return await this.setupOutput(inputBuffer, outputContext, durationAudio, offlineContext);\n    }\n\n    private setupPlayerSpeed(bufferPlayer: BufferPlayerInterface) {\n        if (this.filterManager && this.filterManager.entrypointFilter) {\n            const speedAudio = this.filterManager.entrypointFilter.getSpeed();\n            bufferPlayer.speedAudio = speedAudio;\n        }\n    }\n\n    async setupOutput(inputBuffer: AudioBuffer | null, outputContext: BaseAudioContext, durationAudio?: number, offlineContext?: OfflineAudioContext): Promise<boolean> {\n        if (this._renderedBuffer && this.configService && this.eventEmitter && this.bufferPlayer && this.filterManager) {\n            // Initialize worklets then connect the filter nodes\n            await this.filterManager.initializeWorklets(outputContext);\n            await this.filterManager.connectNodes(outputContext, this._renderedBuffer, false, this.configService.isCompatibilityModeEnabled());\n\n            this.setupPlayerSpeed(this.bufferPlayer);\n\n            // Standard mode\n            if (!this.configService.isCompatibilityModeEnabled() && offlineContext && this.filterManager.currentNodes) {\n                this.currentOfflineContext = offlineContext;\n                this.filterManager.currentNodes.output.connect(outputContext.destination);\n\n                const renderedBuffer = await offlineContext.startRendering();\n\n                this.filterManager.clearWorklets();\n\n                if (this.contextManager && !this.loadRenderedAudio(inputBuffer, renderedBuffer)) {\n                    return await this.setupOutput(inputBuffer, this.contextManager.currentContext!, durationAudio);\n                }\n\n                if (this.audioRenderingLastCanceled) {\n                    return false;\n                }\n\n                this.eventEmitter.emit(EventType.OFFLINE_AUDIO_RENDERING_FINISHED);\n            } else { // Compatibility mode\n                if (this.filterManager.currentNodes) {\n                    this.bufferPlayer.setCompatibilityMode(this.filterManager.currentNodes.output, durationAudio);\n                    this.initialRenderingDone = true;\n                }\n            }\n        \n            if (this.eventEmitter) {\n                this.eventEmitter.emit(EventType.AUDIO_RENDERING_FINISHED);\n            }\n\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Load rendered audio buffer into audio player\n     * @param renderedBuffer Rendered audio buffer - AudioBuffer\n     * @returns false if the rendered audio buffer is invalid, true otherwise\n     */\n    private loadRenderedAudio(inputBuffer: AudioBuffer | null, renderedBuffer: AudioBuffer): boolean {\n        if (this.eventEmitter && this.bufferPlayer) {\n            if (!this.audioRenderingLastCanceled) {\n                const sumRenderedAudio = utils.sumAudioBuffer(renderedBuffer);\n\n                if (sumRenderedAudio == 0 && this.sumInputBuffer !== 0) {\n                    if (this.configService && !this.configService.isCompatibilityModeChecked()) {\n                        this.setCompatibilityModeChecked(true);\n                        this.configService.enableCompatibilityMode();\n                        this.eventEmitter.emit(EventType.COMPATIBILITY_MODE_AUTO_ENABLED);\n\n                        console.warn(\"Compatibility mode has been automatically enabled because a problem has been detected with the web browser.\");\n\n                        return false;\n                    }\n\n                    this.eventEmitter.emit(EventType.RENDERING_AUDIO_PROBLEM_DETECTED);\n                }\n\n                this._renderedBuffer = renderedBuffer;\n                this.bufferPlayer.loadBuffer(this._renderedBuffer);\n            } else if (!this.initialRenderingDone) {\n                this.loadInitialBuffer(inputBuffer);\n                this.eventEmitter.emit(EventType.CANCELLED_AND_LOADED_INITIAL_AUDIO);\n            }\n\n            this.initialRenderingDone = true;\n        }\n\n        return true;\n    }\n\n    /**\n     * Load the initial audio buffer to the buffer player\n     */\n    private loadInitialBuffer(inputBuffer: AudioBuffer | null) {\n        if (this.bufferPlayer) {\n            this._renderedBuffer = inputBuffer;\n            this.bufferPlayer.loadBuffer(inputBuffer!);\n        }\n    }\n\n    public cancelAudioRendering() {\n        if (this.currentOfflineContext && !this.audioRenderingLastCanceled && this.filterManager) {\n            this.audioRenderingLastCanceled = true;\n            this.filterManager.disconnectOldNodes(false);\n\n            if (this.eventEmitter) {\n                this.eventEmitter.emit(EventType.CANCELLING_AUDIO_PROCESSING);\n            }\n        }\n    }\n\n    clearRenderedBuffer() {\n        utils.clearAudioBuffer(this._renderedBuffer);\n        this._renderedBuffer = null;\n    }\n\n    /**\n     * Set compatibility/direct audio rendering mode already checked for auto enabling (if an error occurs rendering in offline context)\n     * @param checked boolean\n     */\n    private setCompatibilityModeChecked(checked: boolean) {\n        if (this.configService) {\n            this.configService.setConfig(Constants.PREFERENCES_KEYS.COMPATIBILITY_MODE_CHECKED, \"\" + checked);\n        }\n    }\n\n    get renderedBuffer() {\n        return this._renderedBuffer;\n    }\n}\n","import AbstractAudioElement from \"@/interfaces/AbstractAudioElement\";\nimport { EventType } from \"@/model/EventTypeEnum\";\nimport BufferManagerInterface from \"./interfaces/BufferManagerInterface\";\nimport { inject, injectable } from \"inversify\";\nimport { TYPES } from \"@/inversify.types\";\nimport EventEmitterInterface from \"@/utils/interfaces/EventEmitterInterface\";\nimport type FilterManagerInterface from \"./interfaces/FilterManagerInterface\";\nimport type BufferFetcherServiceInterface from \"@/services/interfaces/BufferFetcherServiceInterface\";\n\n@injectable()\nexport default class BufferManager extends AbstractAudioElement implements BufferManagerInterface {\n\n    /** The filter manager */\n    private filterManager: FilterManagerInterface | undefined;\n\n    /** True if we are downloading initial buffer data */\n    downloadingInitialData = false;\n\n    /** List of audio buffers to fetch */\n    private audioBuffersToFetch: string[] = [];\n\n    constructor(\n        @inject(TYPES.FilterManager) filterManager: FilterManagerInterface,\n        @inject(TYPES.BufferFetcherService) bufferFetcherService: BufferFetcherServiceInterface,\n        @inject(TYPES.EventEmitter) eventEmitter: EventEmitterInterface | null,\n        @inject(TYPES.AudioBuffersToFetch) audioBuffersToFetch: string[]) {\n        super();\n\n        this.bufferFetcherService = bufferFetcherService;\n        this.eventEmitter = eventEmitter;\n        this.filterManager = filterManager;\n        this.filterManager = filterManager;\n        this.audioBuffersToFetch = audioBuffersToFetch;\n\n        this.setup();\n    }\n\n    private setup() {\n        if (this.audioBuffersToFetch.length > 0) {\n            this.fetchBuffers(false);\n        }\n    }\n\n    /**\n     * Fetch default buffers from network\n     * @param refetch true if we need to refetch the buffers\n     */\n    private async fetchBuffers(refetch: boolean) {\n        if (this.downloadingInitialData || !this.bufferFetcherService) {\n            return;\n        }\n\n        this.downloadingInitialData = true;\n\n        if (this.eventEmitter && !refetch) {\n            this.eventEmitter.emit(EventType.LOADING_BUFFERS);\n        }\n\n        try {\n            this.bufferFetcherService.fetchAllBuffers(this.audioBuffersToFetch);\n            this.downloadingInitialData = false;\n\n            if (this.eventEmitter && !refetch) {\n                this.eventEmitter.emit(EventType.LOADED_BUFFERS);\n            }\n        } catch (e) {\n            console.error(e);\n\n            if (this.eventEmitter && !refetch) {\n                this.eventEmitter.emit(EventType.LOADING_BUFFERS_ERROR);\n            }\n        }\n    }\n\n    async resetBufferFetcher() {\n        if (this.bufferFetcherService) {\n            this.bufferFetcherService.reset();\n\n            await this.fetchBuffers(true);\n\n            if (this.filterManager) {\n                await this.filterManager.resetFilterBuffers();\n            }\n        }\n    }\n}\n","import AbstractAudioElement from \"@/interfaces/AbstractAudioElement\";\nimport AbstractAudioFilter from \"@/filters/interfaces/AbstractAudioFilter\";\nimport AudioFilterEntrypointInterface from \"@/filters/interfaces/AudioFilterEntrypointInterface\";\nimport { AudioFilterNodes } from \"@/model/AudioNodes\";\nimport AbstractAudioFilterWorklet from \"@/filters/interfaces/AbstractAudioFilterWorklet\";\nimport { FilterState } from \"@/model/FilterState\";\nimport { FilterSettings } from \"@/model/filtersSettings/FilterSettings\";\nimport FilterManagerInterface from \"./interfaces/FilterManagerInterface\";\nimport { inject, injectable, multiInject } from \"inversify\";\nimport { TYPES } from \"@/inversify.types\";\n\n@injectable()\nexport default class FilterManager extends AbstractAudioElement implements FilterManagerInterface {\n\n    /** A list of filters */\n    private filters: AbstractAudioFilter[] = [];\n\n    /** The entrypoint filter */\n    private _entryPointFilter: (AbstractAudioFilter & AudioFilterEntrypointInterface) | null = null;\n\n    /** The current connected nodes */\n    private _currentNodes: AudioFilterNodes | null = null;\n\n    constructor(\n        @multiInject(TYPES.Filters) filters: AbstractAudioFilter[],\n        @inject(TYPES.EntryPointFilter) entryPointFilter: (AbstractAudioFilter & AudioFilterEntrypointInterface) | null\n    ) {\n        super();\n\n        this.filters = filters;\n        this._entryPointFilter = entryPointFilter;\n\n        this.setup();\n    }\n\n    private setup() {\n        for (const filter of this.filters) {\n            filter.initializeDefaultSettings();\n        }\n    }\n\n    addFilters(...filters: AbstractAudioFilter[]) {\n        for (const filter of filters) {\n            filter.initializeDefaultSettings();\n            filter.injectDependencies(this.bufferFetcherService, this.bufferDecoderService, this.configService, this.eventEmitter);\n        }\n\n        this.filters.push(...filters);\n    }\n\n    getFiltersState(): FilterState {\n        const state: FilterState = {};\n\n        this.filters.forEach(filter => {\n            state[filter.id] = filter.isEnabled();\n        });\n\n        return state;\n    }\n\n    getFiltersSettings(): Map<string, FilterSettings> {\n        const settings = new Map<string, FilterSettings>();\n\n        for (const filter of this.filters) {\n            settings.set(filter.id, filter.getSettings());\n        }\n\n        return settings;\n    }\n\n    enableFilter(filterId: string) {\n        const filter = this.filters.find(f => f.id === filterId);\n\n        if (filter) {\n            filter.enable();\n        }\n    }\n\n    disableFilter(filterId: string) {\n        const filter = this.filters.find(f => f.id === filterId);\n\n        if (filter) {\n            filter.disable();\n        }\n    }\n\n    toggleFilter(filterId: string) {\n        const filter = this.filters.find(f => f.id === filterId);\n\n        if (filter) {\n            filter.toggle();\n        }\n    }\n\n    async changeFilterSettings(filterId: string, settings: FilterSettings) {\n        const filter = this.filters.find(f => f.id === filterId);\n\n        if (filter) {\n            for (const key of Object.keys(settings)) {\n                await filter.setSetting(key, settings[key]);\n            }\n        }\n    }\n\n    async resetFilterSettings(filterId: string) {\n        const filter = this.filters.find(f => f.id === filterId);\n\n        if (filter) {\n            await filter.resetSettings();\n        }\n    }\n\n    resetAllFiltersState() {\n        this.filters.forEach(element => {\n            if (element.isDefaultEnabled()) {\n                element.enable();\n            } else {\n                element.disable();\n            }\n        });\n    }\n\n    async connectNodes(context: BaseAudioContext, buffer: AudioBuffer, keepCurrentInputOutput: boolean, isCompatibilityMode: boolean): Promise<void> {\n        if (!this._entryPointFilter) {\n            return;\n        }\n\n        let entrypointNode: AudioNode | null = null;\n\n        if (keepCurrentInputOutput && this._currentNodes) {\n            entrypointNode = this._currentNodes.input;\n        } else {\n            const entrypointNodes = await this._entryPointFilter.getEntrypointNode(context, buffer, !isCompatibilityMode);\n            entrypointNode = entrypointNodes.input;\n        }\n\n        const intermediateNodes: AudioFilterNodes[] = [];\n        let previousNode: AudioNode | undefined = entrypointNode;\n\n        this.disconnectOldNodes(keepCurrentInputOutput);\n\n        // Sort by filter order, then remove the disabled filter (but always keep the last/output filter)\n        const filters = this.filters\n            .sort((a, b) => a.order - b.order)\n            .filter((filter, index) => filter !== this._entryPointFilter && (filter.isEnabled() || index >= this.filters.length - 1));\n\n        for (const filter of filters) {\n            const node = filter.getNode(context);\n\n            if (previousNode) {\n                previousNode.connect(node.input);\n            }\n\n            previousNode = node.output;\n            intermediateNodes.push(node);\n        }\n\n        if (this._entryPointFilter) {\n            this._entryPointFilter.updateState();\n        }\n\n        this._currentNodes = {\n            input: entrypointNode!,\n            output: previousNode!,\n            intermediateNodes: intermediateNodes\n                .filter(n => n.input != previousNode && n.output != previousNode &&\n                    n.input != entrypointNode && n.output != entrypointNode)\n        };\n    }\n\n    disconnectOldNodes(keepCurrentOutput: boolean) {\n        if (this._currentNodes) {\n            this._currentNodes.input.disconnect();\n\n            if (!keepCurrentOutput) {\n                this._currentNodes.output.disconnect();\n            }\n\n            if (this._currentNodes.intermediateNodes) {\n                for (const intermediate of this._currentNodes.intermediateNodes) {\n                    intermediate.input.disconnect();\n                    intermediate.output.disconnect();\n                }\n            }\n        }\n    }\n\n    async initializeWorklets(context: BaseAudioContext) {\n        for (const filter of this.filters) {\n            if (filter.isWorklet()) {\n                this.clearWorklets();\n                await (filter as AbstractAudioFilterWorklet<object>).initializeWorklet(context);\n            }\n        }\n    }\n\n    clearWorklets() {\n        for (const filter of this.filters) {\n            if (filter.isWorklet()) {\n                (filter as AbstractAudioFilterWorklet<object>).stop();\n            }\n        }\n    }\n\n    getAddingTime() {\n        let duration = 0;\n\n        for (const filter of this.filters) {\n            if (filter.isEnabled()) {\n                duration += filter.getAddingTime();\n            }\n        }\n\n        return duration;\n    }\n\n    setupTotalSamples(durationAudio: number, currentContext: AudioContext | null) {\n        if (currentContext) {\n            const totalSamples = durationAudio * currentContext.sampleRate;\n\n            for (const filter of this.filters) {\n                filter.totalSamples = totalSamples;\n            }\n        }\n    }\n\n    async resetFilterBuffers() {\n        for (const filter of this.filters) {\n            await filter.bufferFetcherReseted();\n        }\n    }\n\n    get entrypointFilter() {\n        return this._entryPointFilter;\n    }\n\n    get currentNodes() {\n        return this._currentNodes;\n    }\n}\n","import { injectable, multiInject } from \"inversify\";\nimport { TYPES } from \"@/inversify.types\";\nimport AbstractAudioElement from \"@/interfaces/AbstractAudioElement\";\nimport AbstractAudioRenderer from \"@/filters/interfaces/AbstractAudioRenderer\";\nimport { FilterState } from \"@/model/FilterState\";\nimport RendererManagerInterface from \"./interfaces/RendererManagerInterface\";\n\n@injectable()\nexport default class RendererManager extends AbstractAudioElement implements RendererManagerInterface {\n\n    /** A list of renderers */\n    private renderers: AbstractAudioRenderer[] = [];\n\n    constructor(\n        @multiInject(TYPES.Renderers) renderers: AbstractAudioRenderer[] = []) {\n        super();\n\n        this.renderers = renderers;\n    }\n\n    addRenderers(...renderers: AbstractAudioRenderer[]) {\n        for (const renderer of renderers) {\n            renderer.injectDependencies(this.bufferFetcherService, this.bufferDecoderService, this.configService, this.eventEmitter);\n        }\n\n        this.renderers.push(...renderers);\n    }\n\n    getRenderersState(): FilterState {\n        const state: FilterState = {};\n\n        this.renderers.forEach(renderer => {\n            state[renderer.id] = renderer.isEnabled();\n        });\n\n        return state;\n    }\n\n    enableRenderer(rendererId: string) {\n        const renderer = this.renderers.find(f => f.id === rendererId);\n\n        if (renderer) {\n            renderer.enable();\n        }\n    }\n\n    disableRenderer(rendererId: string) {\n        const renderer = this.renderers.find(f => f.id === rendererId);\n\n        if (renderer) {\n            renderer.disable();\n        }\n    }\n\n    toggleRenderer(rendererId: string) {\n        const renderer = this.renderers.find(f => f.id === rendererId);\n\n        if (renderer) {\n            renderer.toggle();\n        }\n    }\n\n    resetAllRenderersState() {\n        this.renderers.forEach(element => {\n            if (element.isDefaultEnabled()) {\n                element.enable();\n            } else {\n                element.disable();\n            }\n        });\n    }\n\n    async executeAudioRenderers(buffer: AudioBuffer, outputContext: AudioContext | OfflineAudioContext) {\n        let currentBuffer = buffer;\n\n        for (const renderer of this.renderers.sort((a, b) => a.order - b.order)) {\n            if (renderer.isEnabled()) {\n                currentBuffer = await renderer.renderAudio(outputContext, currentBuffer);\n            }\n        }\n\n        return currentBuffer;\n    }\n}\n","import { inject, injectable } from \"inversify\";\nimport { TYPES } from \"../inversify.types\";\nimport { Recorder } from \"../recorder/Recorder\";\nimport { EventType } from \"@/model/EventTypeEnum\";\nimport AbstractAudioElement from \"@/interfaces/AbstractAudioElement\";\nimport SaveBufferOptions from \"@/model/SaveBufferOptions\";\nimport Constants from \"@/model/Constants\";\nimport RecorderWorkerMessage from \"../model/RecorderWorkerMessage\";\nimport getRecorderWorker from \"../recorder/getRecorderWorker\";\nimport SaveBufferManagerInterface from \"./interfaces/SaveBufferManagerInteface\";\nimport type BufferPlayerInterface from \"@/bufferPlayer/interfaces/BufferPlayerInterface\";\nimport type FilterManagerInterface from \"./interfaces/FilterManagerInterface\";\nimport AudioContextManagerInterface from \"./interfaces/AudioContextManagerInterface\";\nimport utilFunctions from \"@/utils/Functions\";\n\n@injectable()\nexport default class SaveBufferManager extends AbstractAudioElement implements SaveBufferManagerInterface {\n\n    /** The filter manager */\n    private filterManager: FilterManagerInterface | undefined;\n\n    /** The context manager */\n    private contextManager: AudioContextManagerInterface | undefined;\n\n    /** The audio player */\n    private bufferPlayer: BufferPlayerInterface | undefined;\n\n    /** If we are currently processing and downloading the buffer */\n    private _savingBuffer = false;\n\n    /** Callback used when saving audio */\n    private playingStoppedCallback: (() => void) | null = null;\n\n    constructor(\n        @inject(TYPES.FilterManager) filterManager: FilterManagerInterface,\n        @inject(TYPES.AudioContextManager) contextManager: AudioContextManagerInterface | undefined,\n        @inject(TYPES.BufferPlayer) bufferPlayer: BufferPlayerInterface\n    ) {\n        super();\n\n        this.contextManager = contextManager;\n        this.bufferPlayer = bufferPlayer;\n        this.filterManager = filterManager;\n\n        // Callback called just before starting audio player\n        this.setup();\n    }\n\n    private setup() {\n        if (this.bufferPlayer) {\n            // Callback called when playing is finished\n            this.bufferPlayer.on(EventType.PLAYING_FINISHED, () => {\n                if (this._savingBuffer && this.playingStoppedCallback && this.eventEmitter) {\n                    this.eventEmitter.off(EventType.PLAYING_STOPPED, this.playingStoppedCallback);\n                }\n            });\n        }\n    }\n\n    async saveBuffer(renderedBuffer: AudioBuffer | null, options?: SaveBufferOptions, recorder?: Recorder): Promise<boolean> {\n        if (this._savingBuffer) {\n            throw new Error(\"The buffer is currently saving\");\n        }\n\n        if (!this.bufferPlayer) {\n            throw new Error(\"No buffer player was found\");\n        }\n\n        this._savingBuffer = true;\n\n        let savingResult = false;\n\n        if (!this.bufferPlayer.compatibilityMode) {\n            savingResult = await this.saveBufferDirect(renderedBuffer, options);\n        } else {\n            savingResult = await this.saveBufferCompatibilityMode(options, recorder);\n        }\n\n        this._savingBuffer = false;\n\n        return savingResult;\n    }\n\n    /**\n     * Save the rendered audio to a buffer, when compatibility mode is disabled\n     * @param renderedBuffer The rendered buffer to save\n     * @param options The save options\n     * @returns A promise resolved when the audio buffer is downloaded to the user\n     */\n    private saveBufferDirect(renderedBuffer: AudioBuffer | null, options?: SaveBufferOptions): Promise<boolean> {\n        return new Promise((resolve, reject) => {\n            if (!renderedBuffer || (this.contextManager && !this.contextManager.currentContext)) {\n                return reject(\"No rendered buffer or AudioContext not initialized\");\n            }\n\n            const worker = getRecorderWorker(this.configService?.getWorkerBasePath());\n\n            if (worker) {\n                const buffer: Float32Array[] = [];\n\n                for (let i = 0; i < renderedBuffer.numberOfChannels; i++) {\n                    buffer.push(renderedBuffer.getChannelData(i));\n                }\n\n                worker.onmessage = (e: RecorderWorkerMessage) => {\n                    if (e.data.command == Constants.EXPORT_WAV_COMMAND || e.data.command == Constants.EXPORT_MP3_COMMAND) {\n                        this.downloadAudioBlob(e.data.data, options);\n                    }\n\n                    worker.terminate();\n                    this._savingBuffer = false;\n                    resolve(true);\n                };\n\n                worker.postMessage({\n                    command: Constants.INIT_COMMAND,\n                    config: {\n                        sampleRate: renderedBuffer.sampleRate,\n                        numChannels: 2,\n                        bitrate: options?.bitrate || Constants.DEFAULT_MP3_BITRATE\n                    }\n                });\n\n                worker.postMessage({\n                    command: Constants.RECORD_COMMAND,\n                    buffer\n                });\n\n                worker.postMessage({\n                    command: options?.format === \"mp3\" || Constants.DEFAULT_SAVE_FORMAT === \"mp3\" ? Constants.EXPORT_MP3_COMMAND : Constants.EXPORT_WAV_COMMAND,\n                    type: Constants.AUDIO_WAV\n                });\n            }\n        });\n    }\n\n    /**\n     * Save the rendered audio to a buffer, when compatibility mode is enabled\n     * @param options The save options - see SaveBufferOptions\n     * @returns A promise resolved when the audio buffer is downloaded to the user\n     */\n    private saveBufferCompatibilityMode(options?: SaveBufferOptions, recorder?: Recorder): Promise<boolean> {\n        return new Promise((resolve, reject) => {\n            if (!this.bufferPlayer) {\n                return reject(\"No buffer player found\");\n            }\n\n            this.bufferPlayer.start().then(() => {\n                if (!this.configService) {\n                    return reject(\"No config service found\");\n                }\n\n                if (!this.filterManager) {\n                    return reject(\"No filter manager found\");\n                }\n\n                if (!this.filterManager.currentNodes) {\n                    return reject(\"No current nodes found\");\n                }\n\n                const rec = recorder || new Recorder({\n                    bufferLen: this.configService.getBufferSize(),\n                    sampleRate: this.configService.getSampleRate(),\n                    numChannels: 2,\n                    workletBasePath: this.configService.getWorkletBasePath(),\n                    workerBasePath: this.configService.getWorkerBasePath(),\n                    mimeType: options?.format == \"mp3\" ? Constants.AUDIO_MP3 : Constants.AUDIO_WAV,\n                    bitrate: options?.bitrate || Constants.DEFAULT_MP3_BITRATE\n                });\n\n                rec.setup(this.filterManager.currentNodes.output).then(() => {\n                    rec.record();\n\n                    this.playingStoppedCallback = () => {\n                        rec.kill();\n\n                        this._savingBuffer = false;\n\n                        if (this.eventEmitter) {\n                            this.eventEmitter.off(EventType.PLAYING_FINISHED, finishedCallback);\n\n                            if (this.playingStoppedCallback) {\n                                this.eventEmitter.off(EventType.PLAYING_STOPPED, this.playingStoppedCallback);\n                            }\n                        }\n\n                        resolve(true);\n                    };\n\n                    const finishedCallback = () => {\n                        if (this.playingStoppedCallback && this.eventEmitter) {\n                            this.eventEmitter.off(EventType.PLAYING_STOPPED, this.playingStoppedCallback);\n                        }\n\n                        rec.stop();\n\n                        const downloadBlobCallback = (blob: Blob) => {\n                            this.downloadAudioBlob(blob, options);\n\n                            this._savingBuffer = false;\n\n                            if (this.eventEmitter) {\n                                this.eventEmitter.off(EventType.PLAYING_FINISHED, finishedCallback);\n                            }\n\n                            rec.kill();\n\n                            resolve(true);\n                        };\n\n                        if (options?.format === \"mp3\" || Constants.DEFAULT_SAVE_FORMAT === \"mp3\") {\n                            rec.exportMP3(downloadBlobCallback);\n                        } else {\n                            rec.exportWAV(downloadBlobCallback);\n                        }\n                    };\n\n                    if (this.eventEmitter) {\n                        this.eventEmitter.on(EventType.PLAYING_FINISHED, finishedCallback);\n                        this.eventEmitter.on(EventType.PLAYING_STOPPED, this.playingStoppedCallback);\n                    }\n                });\n            });\n        });\n    }\n\n    /**\n     * Download an audio Blob\n     * @param blob The blob\n     * @param options The save options - see SaveBufferOptions\n     */\n    private downloadAudioBlob(blob: Blob, options?: SaveBufferOptions) {\n        utilFunctions.forceDownload(blob, \"audio-\" + new Date().toISOString() + \".\" + (options?.format || Constants.DEFAULT_SAVE_FORMAT));\n    }\n\n    get savingBuffer() {\n        return this._savingBuffer;\n    }\n}\n","import { EventType } from \"../model/EventTypeEnum\";\nimport type { ConfigService } from \"./interfaces/ConfigService\";\nimport utilFunctions from \"../utils/Functions\";\nimport EventEmitter from \"../utils/EventEmitter\";\nimport BufferFetcherServiceInterface from \"./interfaces/BufferFetcherServiceInterface\";\nimport { inject, injectable } from \"inversify\";\nimport type EventEmitterInterface from \"@/utils/interfaces/EventEmitterInterface\";\nimport type AudioContextManagerInterface from \"@/audioEditor/interfaces/AudioContextManagerInterface\";\nimport { TYPES } from \"@/inversify.types\";\n\n@injectable()\nexport default class BufferFetcherService implements BufferFetcherServiceInterface {\n\n    private contextManager: AudioContextManagerInterface;\n    private buffers: Map<string, AudioBuffer> = new Map<string, AudioBuffer>();\n    private bufferErrors: string[] = [];\n    private eventEmitter: EventEmitterInterface | null;\n    private configService: ConfigService | null = null;\n\n    constructor(\n        @inject(TYPES.AudioContextManager) contextManager: AudioContextManagerInterface,\n        @inject(TYPES.ConfigService) configService: ConfigService,\n        @inject(TYPES.EventEmitter) eventEmitter?: EventEmitterInterface) {\n        this.contextManager = contextManager;\n        this.eventEmitter = eventEmitter || new EventEmitter();\n        this.configService = configService;\n    }\n\n    async fetchBuffer(bufferURI: string, force?: boolean) {\n        const realBufferURI = (this.configService ? this.configService.getSoundBasePath() : \"\") + bufferURI;\n\n        if(this.buffers.get(this.getKeyFromLocation(realBufferURI)) != null && !force) {\n            return;\n        }\n\n        this.eventEmitter?.emit(EventType.FETCHING_BUFFERS, realBufferURI);\n\n        try {\n            const response = await fetch(realBufferURI);\n\n            if(!response.ok) {\n                this.bufferErrors.push(realBufferURI);\n                this.eventEmitter?.emit(EventType.FETCHING_BUFFERS_ERROR, realBufferURI);\n                throw EventType.FETCHING_BUFFERS_ERROR;\n            } else {\n                const arrayBuffer = await response.arrayBuffer();\n\n                if (this.contextManager && this.contextManager.currentContext) {\n                    const buffer = await this.contextManager.currentContext.decodeAudioData(arrayBuffer);\n                    this.buffers.set(this.getKeyFromLocation(realBufferURI), utilFunctions.decodeBuffer(this.contextManager.currentContext, buffer));\n                }\n            }\n    \n            this.eventEmitter?.emit(EventType.FINISHED_FETCHING_BUFFERS, realBufferURI);\n        } catch(e) {\n            console.error(e);\n\n            this.bufferErrors.push(realBufferURI);\n            this.eventEmitter?.emit(EventType.FETCHING_BUFFERS_ERROR, realBufferURI);\n            throw EventType.FETCHING_BUFFERS_ERROR;\n        }\n    }\n\n    async fetchAllBuffers(bufferURIs: string[]) {\n        for(const uri of bufferURIs) {\n            await this.fetchBuffer(uri);\n        }\n    }\n\n    getAudioBuffer(filename: string): AudioBuffer | undefined {\n        return this.buffers.get(this.getKeyFromLocation(filename));\n    }\n\n    async getOrFetchAudioBuffer(filename: string): Promise<AudioBuffer | undefined> {\n        if(this.getAudioBuffer(filename) == null) {\n            await this.fetchBuffer(filename);\n        }\n\n        return this.getAudioBuffer(filename);\n    }\n\n    getDownloadedBuffersList(): string[] {\n        return Array.from(this.buffers.keys());\n    }\n\n    private getKeyFromLocation(location: string) {\n        return location.substring(location.lastIndexOf(\"/\") + 1);\n    }\n\n    reset() {\n        this.buffers.clear();\n    }\n}\n","import type AudioContextManagerInterface from \"@/audioEditor/interfaces/AudioContextManagerInterface\";\nimport { EventType } from \"../model/EventTypeEnum\";\nimport EventEmitter from \"../utils/EventEmitter\";\nimport utilFunctions from \"../utils/Functions\";\nimport BufferDecoderServiceInterface from \"./interfaces/BufferDecoderServiceInterface\";\nimport { inject, injectable } from \"inversify\";\nimport type EventEmitterInterface from \"@/utils/interfaces/EventEmitterInterface\";\nimport { TYPES } from \"@/inversify.types\";\n\n@injectable()\nexport default class BufferDecoderService implements BufferDecoderServiceInterface {\n\n    private contextManager: AudioContextManagerInterface;\n    private eventEmitter: EventEmitterInterface | null;\n\n    constructor(\n        @inject(TYPES.AudioContextManager) contextManager: AudioContextManagerInterface,\n        @inject(TYPES.EventEmitter) eventEmitter?: EventEmitterInterface) {\n        this.contextManager = contextManager;\n        this.eventEmitter = eventEmitter || new EventEmitter();\n    }\n\n    async decodeBufferFromFile(file: File): Promise<AudioBuffer | null> {\n        if (this.eventEmitter) {\n            this.eventEmitter.emit(EventType.DECODING_AUDIO_FILE);\n        }\n\n        try {\n            if (this.contextManager && this.contextManager.currentContext) {\n                const buffer = await utilFunctions.loadAudioBuffer(this.contextManager.currentContext, file);\n    \n                if (this.eventEmitter) {\n                    this.eventEmitter.emit(EventType.DECODED_AUDIO_FILE);\n                }\n    \n                return buffer;\n            }\n        } catch (e) {\n            console.error(e);\n\n            if (this.eventEmitter) {\n                this.eventEmitter.emit(EventType.DECODED_AUDIO_FILE);\n                this.eventEmitter.emit(EventType.ERROR_DECODING_AUDIO_FILE);\n            }\n        }\n\n        return null;\n    }\n}\n","import AbstractAudioRenderer from \"./interfaces/AbstractAudioRenderer\";\nimport Constants from \"../model/Constants\";\n\nexport default class ReturnAudioRenderer extends AbstractAudioRenderer {\n\n    renderAudio(context: BaseAudioContext, buffer: AudioBuffer): Promise<AudioBuffer> {\n        return new Promise(resolve => {\n            const numChannels = buffer.numberOfChannels;\n            const totalFrames = context.sampleRate * buffer.duration + context.sampleRate * 2;\n            const bufferReturned = context.createBuffer(numChannels, totalFrames, context.sampleRate);\n\n            for (let channel = 0; channel < numChannels; channel++) {\n                const nowBuffering = bufferReturned.getChannelData(channel);\n                const sourceChannelData = buffer.getChannelData(channel);\n\n                for (let i = 0; i < totalFrames; i++) {\n                    if (i < sourceChannelData.length) {\n                        nowBuffering[i] = sourceChannelData[sourceChannelData.length - 1 - i];\n                    } else {\n                        nowBuffering[i] = 0;\n                    }\n                }\n            }\n\n            resolve(bufferReturned);\n        });\n    }\n\n    get order(): number {\n        return 0;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.RETURN_AUDIO;\n    }\n}\n","import AbstractAudioFilter from \"./interfaces/AbstractAudioFilter\";\nimport Constants from \"../model/Constants\";\nimport BassBoosterSettings from \"../model/filtersSettings/BassBoosterSettings\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport utilFunctions from \"../utils/Functions\";\n\nexport default class BassBoosterFilter extends AbstractAudioFilter {\n    private frequencyBooster = 200;\n    private frequencyReduce = 200;\n    private dbBooster = 15;\n    private dbReduce = -2;\n\n    getNode(context: BaseAudioContext) {\n        const bassBoostFilter = context.createBiquadFilter();\n        bassBoostFilter.type = \"lowshelf\";\n        bassBoostFilter.frequency.value = this.frequencyBooster;\n        bassBoostFilter.gain.value = this.dbBooster;\n\n        const bassBoostFilterHighFreq = context.createBiquadFilter();\n        bassBoostFilterHighFreq.type = \"highshelf\";\n        bassBoostFilterHighFreq.frequency.value = this.frequencyReduce;\n        bassBoostFilterHighFreq.gain.value = this.dbReduce;\n        bassBoostFilterHighFreq.connect(bassBoostFilter);\n\n        return {\n            input: bassBoostFilterHighFreq,\n            output: bassBoostFilter\n        };\n    }\n    \n    get order(): number {\n        return 3;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.BASS_BOOST;\n    }\n\n    getSettings(): BassBoosterSettings {\n        return {\n            frequencyBooster: this.frequencyBooster,\n            frequencyReduce: this.frequencyReduce,\n            dbBooster: this.dbBooster,\n            dbReduce: this.dbReduce,\n        };\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if(!utilFunctions.isSettingValueValid(value)) {\n            return;\n        }\n\n        switch(settingId) {\n        case \"frequencyBooster\":\n            this.frequencyBooster = parseInt(value as string);\n            break;\n        case \"frequencyReduce\":\n            this.frequencyReduce = parseInt(value as string);\n            break;\n        case \"dbBooster\":\n            this.dbBooster = parseInt(value as string);\n            break;\n        case \"dbReduce\":\n            this.dbReduce = parseInt(value as string);\n            break;\n        }\n    }\n}\n","import Constants from \"../../model/Constants\";\n\nclass BitCrusherProcessor extends AudioWorkletProcessor {\n    private stopped = false;\n    private phaser: number[] | null = null;\n    private last: number[] | null = null;\n\n    constructor() {\n        super();\n        this.port.onmessage = (event) => {\n            if (event.data == \"stop\") {\n                this.stop();\n            }\n        };\n    }\n\n    static get parameterDescriptors() {\n        return [\n            { name: \"bits\", defaultValue: 16 },\n            { name: \"normFreq\", defaultValue: 0.9 },\n        ];\n    }\n\n    get defaultParameterDescriptors() {\n        return BitCrusherProcessor.parameterDescriptors;\n    }\n\n    process(inputs: Float32Array[][], outputs: Float32Array[][], parameters: Record<string, Float32Array>): boolean {\n        if (this.stopped) return false;\n\n        const input = inputs[0];\n        const output = outputs[0];\n\n        const step = 2 * Math.pow(1 / 2, parameters.bits[0]);\n        const currentNormFreq = (1 - parameters.normFreq[0]) / (sampleRate / 48000);\n\n        if (this.last == null) {\n            this.last = new Array(input.length).fill(0);\n        }\n\n        if (this.phaser == null) {\n            this.phaser = new Array(input.length).fill(0);\n        }\n\n        if (input && input[0]) {\n            const blockSize = input[0].length;\n\n            for (let channel = 0; channel < input.length; channel++) {\n                const inp = input[channel];\n                const out = output[channel];\n\n                if (inp && out) {\n                    for (let i = 0; i < blockSize; i++) {\n                        this.phaser[channel] += currentNormFreq;\n\n                        if (this.phaser[channel] >= 1.0) {\n                            this.phaser[channel] -= 1.0;\n                            this.last[channel] = step * Math.floor((inp[i] * (1 / step)) + 0.5);\n                        }\n\n                        out[i] = this.last[channel];\n                    }\n                }\n            }\n        }\n\n        return true;\n    }\n\n    stop() {\n        this.stopped = true;\n        this.phaser = null;\n        this.last = null;\n    }\n}\n\nregisterProcessor(Constants.WORKLET_NAMES.BITCRUSHER, BitCrusherProcessor);\n","import AbstractAudioFilterWorklet from \"./interfaces/AbstractAudioFilterWorklet\";\nimport Constants from \"../model/Constants\";\nimport BitCrusherSettings from \"../model/filtersSettings/BitCrusherSettings\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport \"./worklets/BitCrusher.worklet\";\nimport utilFunctions from \"../utils/Functions\";\n\nexport default class BitCrusherFilter extends AbstractAudioFilterWorklet<void> {\n    private bits = 16;\n    private normFreq = 0.9;\n    \n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    receiveEvent(message: MessageEvent<void>): void {\n        // Do nothing\n    }\n\n    get workletPath(): string {\n        return Constants.WORKLET_PATHS.BITCRUSHER;\n    }\n    \n    get workletName(): string {\n        return Constants.WORKLET_NAMES.BITCRUSHER;\n    }\n\n    get order(): number {\n        return 6;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.BITCRUSHER;\n    }\n\n    getSettings(): BitCrusherSettings {\n        return {\n            bits: this.bits,\n            normFreq: this.normFreq,\n        };\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if(!utilFunctions.isSettingValueValid(value)) {\n            return;\n        }\n\n        switch (settingId) {\n        case \"bits\":\n            this.bits = parseInt(value as string);\n            break;\n        case \"normFreq\":\n            this.normFreq = parseFloat(value as string);\n            break;\n        }\n\n        this.applyCurrentSettingsToWorklet();\n    }\n}\n","import AbstractAudioFilter from \"./interfaces/AbstractAudioFilter\";\nimport Constants from \"../model/Constants\";\nimport EchoSettings from \"../model/filtersSettings/EchoSettings\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport utilFunctions from \"../utils/Functions\";\n\nexport default class EchoFilter extends AbstractAudioFilter {\n    private delay = 0.2;\n    private gain = 0.75;\n\n    getNode(context: BaseAudioContext) {\n        const delayNode = context.createDelay(179);\n        delayNode.delayTime.value = this.delay;\n\n        const gainNode = context.createGain();\n        gainNode.gain.value = this.gain;\n\n        gainNode.connect(delayNode);\n        delayNode.connect(gainNode);\n\n        return {\n            input: gainNode,\n            output: delayNode\n        };\n    }\n    \n    get order(): number {\n        return 7;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.ECHO;\n    }\n\n    getAddingTime() {\n        return 5;\n    }\n\n    getSettings(): EchoSettings {\n        return {\n            delay: this.delay,\n            gain: this.gain\n        };\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if(!utilFunctions.isSettingValueValid(value)) {\n            return;\n        }\n        \n        switch(settingId) {\n        case \"delay\":\n            this.delay = parseFloat(value as string);\n            break;\n        case \"gain\":\n            this.gain = parseFloat(value as string);\n            break;\n        }\n    }\n}\n","import AbstractAudioFilter from \"./interfaces/AbstractAudioFilter\";\nimport Constants from \"../model/Constants\";\nimport HighPassSettings from \"../model/filtersSettings/HighPassSettings\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport utilFunctions from \"../utils/Functions\";\n\nexport default class HighPassFilter extends AbstractAudioFilter {\n    private highFrequency = 3500;\n\n    getNode(context: BaseAudioContext) {\n        const highPassFilter = context.createBiquadFilter();\n        highPassFilter.type = \"highpass\";\n        highPassFilter.frequency.value = this.highFrequency;\n\n        return {\n            input: highPassFilter,\n            output: highPassFilter\n        };\n    }\n    \n    get order(): number {\n        return 4;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.HIGH_PASS;\n    }\n\n    getSettings(): HighPassSettings {\n        return {\n            highFrequency: this.highFrequency\n        };\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if(!utilFunctions.isSettingValueValid(value)) {\n            return;\n        }\n        \n        switch(settingId) {\n        case \"highFrequency\":\n            this.highFrequency = parseInt(value as string);\n            break;\n        }\n    }\n}\n","export default class DelayBuffer {\n    private _array: Float32Array = new Float32Array();\n    private n: number = 0;\n    private length: number = 0;\n    private readPointer: number = 0;\n    private writePointer: number = 0;\n\n    constructor(n: number) {\n        this.n = Math.floor(n);\n        this.init();\n    }\n\n    init() {\n        this._array = new Float32Array(2 * this.n);\n        this.length = this._array.length;\n        this.readPointer = 0;\n        this.writePointer = this.n - 1;\n        this._array.fill(0);\n    }\n\n    read() {\n        const value = this._array[this.readPointer % this.length];\n        this.readPointer = (this.readPointer + 1) % this.length;\n        return value;\n    }\n\n    push(v: number) {\n        this._array[this.writePointer % this.length] = v;\n        this.writePointer = (this.writePointer + 1) % this.length;\n    }\n\n    reset() {\n        this.init();\n    }\n\n    clear() {\n        this._array = new Float32Array();\n        this.length = 0;\n        this.readPointer = 0;\n        this.writePointer = 0;\n    }\n\n    sum() {\n        return this._array.reduce((a, b) => a + b, 0);\n    }\n}\n","/*\n * Copyright (C) 2019-2023 Eliastik (eliastiksofts.com)\n *\n * This file is part of \"Simple Voice Changer\".\n *\n * \"Simple Voice Changer\" is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * \"Simple Voice Changer\" is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with \"Simple Voice Changer\".  If not, see <http://www.gnu.org/licenses/>.\n */\n// Source: https://webaudiotech.com/2016/01/21/should-your-web-audio-app-have-a-limiter/ (https://web.archive.org/web/20220519100003/https://webaudiotech.com/2016/01/21/should-your-web-audio-app-have-a-limiter/)\n// Original code: https://webaudiotech.com/sites/limiter_comparison/limiter.js\n// Additions by Eliastik (eliastiksofts.com): Stereo and multi-channel support, code simplified in one object class (Limiter), converted into AudioWorklet\nimport Constants from \"../../model/Constants\";\nimport DelayBuffer from \"../../utils/DelayBuffer\";\n\nclass LimiterProcessor extends AudioWorkletProcessor {\n    private delayBuffer: DelayBuffer[] = [];\n    private envelopeSample = 0;\n    private stopped = false;\n    private disabled = false;\n\n    constructor() {\n        super();\n        this.port.onmessage = (event) => {\n            if (event.data == \"reset\") {\n                this.reset();\n            } else if (event.data == \"stop\") {\n                this.stop();\n            } else if (event.data == \"disable\") {\n                this.disabled = true;\n            } else if (event.data == \"enable\") {\n                this.disabled = false;\n            }\n        };\n    }\n\n    static get parameterDescriptors() {\n        return [\n            { name: \"preGain\", defaultValue: 0 },\n            { name: \"postGain\", defaultValue: 0 },\n            { name: \"attackTime\", defaultValue: 0 },\n            { name: \"releaseTime\", defaultValue: 3 },\n            { name: \"threshold\", defaultValue: -0.05 },\n            { name: \"lookAheadTime\", defaultValue: 0 }\n        ];\n    }\n\n    get defaultParameterDescriptors() {\n        return LimiterProcessor.parameterDescriptors;\n    }\n\n    getEnvelope(data: Float32Array, attackTime: number, releaseTime: number, sampleRate: number) {\n        const attackGain = Math.exp(-1 / (sampleRate * attackTime));\n        const releaseGain = Math.exp(-1 / (sampleRate * releaseTime));\n\n        const envelope = new Float32Array(data.length);\n\n        for (let i = 0; i < data.length; i++) {\n            const envIn = Math.abs(data[i]);\n\n            if (this.envelopeSample < envIn) {\n                this.envelopeSample = envIn + attackGain * (this.envelopeSample - envIn);\n            } else {\n                this.envelopeSample = envIn + releaseGain * (this.envelopeSample - envIn);\n            }\n\n            envelope[i] = this.envelopeSample;\n        }\n\n        return envelope;\n    }\n\n    getMaxEnvelope(envelope: Float32Array[], channels: number, index: number) {\n        let max = envelope[0][index];\n\n        for (let channel = 0; channel < channels; channel++) {\n            if (envelope[channel][index] > max) {\n                max = envelope[channel][index];\n            }\n        }\n\n        return max;\n    }\n\n    ampToDB(value: number) {\n        return 20 * Math.log10(value);\n    }\n\n    dBToAmp(db: number) {\n        return Math.pow(10, db / 20);\n    }\n\n    process(inputs: Float32Array[][], outputs: Float32Array[][], parameters: Record<string, Float32Array>): boolean {\n        if (this.stopped) return false;\n\n        const inputBuffer = inputs[0];\n        const outputBuffer = outputs[0];\n        const envelopeData = [];\n\n        // transform db to amplitude value\n        const postGainAmp = this.dBToAmp(parameters.postGain[0]);\n        const preGainAmp = this.dBToAmp(parameters.preGain[0]);\n\n        // apply pre gain to signal\n        // compute the envelope for each channel\n        for (let channel = 0; channel < outputBuffer.length; channel++) {\n            const inp = inputBuffer[channel];\n            const out = outputBuffer[channel];\n\n            // create a delay buffer\n            if (this.delayBuffer[channel] == null) {\n                this.delayBuffer[channel] = new DelayBuffer(parameters.lookAheadTime[0] * sampleRate);\n            }\n\n            // apply pre gain to signal\n            if (inp && out) {\n                for (let k = 0; k < inp.length; ++k) {\n                    if (!this.disabled) {\n                        out[k] = preGainAmp * inp[k];\n                    } else {\n                        out[k] = inp[k];\n                    }\n                }\n            }\n\n            // compute the envelope\n            if (!this.disabled && out) {\n                envelopeData[channel] = this.getEnvelope(out, parameters.attackTime[0], parameters.releaseTime[0], sampleRate);\n            }\n        }\n\n        for (let channel = 0; channel < outputBuffer.length; channel++) {\n            const inp = inputBuffer[channel];\n            const out = outputBuffer[channel];\n\n            if (parameters.lookAheadTime[0] > 0 && out) {\n                // write signal into buffer and read delayed signal\n                for (let i = 0; i < out.length; i++) {\n                    this.delayBuffer[channel].push(out[i]);\n                    out[i] = this.delayBuffer[channel].read();\n                }\n            }\n\n            // If disabled we don't apply the limitation to the audio\n            if (this.disabled) {\n                continue;\n            }\n\n            // limiter mode: slope is 1\n            const slope = 1;\n\n            if (inp && out) {\n                for (let i = 0; i < inp.length; i++) {\n                    let gainDB = slope * (parameters.threshold[0] - this.ampToDB(this.getMaxEnvelope(envelopeData, outputBuffer.length, i))); // max gain\n\n                    // is gain below zero?\n                    gainDB = Math.min(0, gainDB);\n                    const gain = this.dBToAmp(gainDB);\n                    out[i] *= (gain * postGainAmp);\n                }\n            }\n        }\n\n        return true;\n    }\n\n    reset() {\n        for (let i = 0; i < this.delayBuffer.length; i++) {\n            if (this.delayBuffer[i] != null) {\n                this.delayBuffer[i].reset();\n            }\n        }\n\n        this.envelopeSample = 0;\n    }\n\n    stop() {\n        for (let i = 0; i < this.delayBuffer.length; i++) {\n            if (this.delayBuffer[i] != null) {\n                this.delayBuffer[i].clear();\n            }\n        }\n\n        this.delayBuffer = [];\n        this.envelopeSample = 0;\n        this.stopped = true;\n    }\n}\n\nregisterProcessor(Constants.WORKLET_NAMES.LIMITER, LimiterProcessor);\n","import AbstractAudioFilterWorklet from \"./interfaces/AbstractAudioFilterWorklet\";\nimport Constants from \"../model/Constants\";\nimport LimiterSettings from \"../model/filtersSettings/LimiterSettings\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport \"./worklets/Limiter.worklet\";\nimport utilFunctions from \"../utils/Functions\";\n\nexport default class LimiterFilter extends AbstractAudioFilterWorklet<void> {\n    private preGain = 0; // dB\n    private postGain = 0; // dB\n    private attackTime = 0; // s\n    private releaseTime = 6; // s\n    private threshold = 0; // dB\n    private lookAheadTime = 0.3; // s\n\n    constructor() {\n        super();\n        this.keepCurrentNodeIfPossible = true;\n        this.setDefaultEnabled(true);\n    }\n    \n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    receiveEvent(message: MessageEvent<void>): void {\n        // Do nothing\n    }\n\n    get workletPath(): string {\n        return Constants.WORKLET_PATHS.LIMITER;\n    }\n    \n    get workletName(): string {\n        return Constants.WORKLET_NAMES.LIMITER;\n    }\n\n    get order(): number {\n        return 11;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.LIMITER;\n    }\n\n    getAddingTime() {\n        return this.lookAheadTime;\n    }\n\n    getSettings(): LimiterSettings {\n        return {\n            preGain: this.preGain,\n            postGain: this.postGain,\n            attackTime: this.attackTime,\n            releaseTime: this.releaseTime,\n            threshold: this.threshold,\n            lookAheadTime: this.lookAheadTime\n        };\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if(!utilFunctions.isSettingValueValid(value)) {\n            return;\n        }\n        \n        switch (settingId) {\n        case \"preGain\":\n            this.preGain = parseFloat(value as string);\n            break;\n        case \"postGain\":\n            this.postGain = parseFloat(value as string);\n            break;\n        case \"attackTime\":\n            this.attackTime = parseFloat(value as string);\n            break;\n        case \"releaseTime\":\n            this.releaseTime = parseFloat(value as string);\n            break;\n        case \"threshold\":\n            this.threshold = parseFloat(value as string);\n            break;\n        case \"lookAheadTime\":\n            this.lookAheadTime = parseFloat(value as string);\n            break;\n        }\n\n        this.applyCurrentSettingsToWorklet();\n    }\n}\n","import AbstractAudioFilter from \"./interfaces/AbstractAudioFilter\";\nimport Constants from \"../model/Constants\";\nimport LowPassSettings from \"../model/filtersSettings/LowPassSettings\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport utilFunctions from \"../utils/Functions\";\n\nexport default class LowPassFilter extends AbstractAudioFilter {\n    private lowFrequency = 3500;\n    \n    getNode(context: BaseAudioContext) {\n        const lowPassFilter = context.createBiquadFilter();\n        lowPassFilter.type = \"lowpass\";\n        lowPassFilter.frequency.value = this.lowFrequency;\n\n        return {\n            input: lowPassFilter,\n            output: lowPassFilter\n        };\n    }\n    \n    get order(): number {\n        return 5;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.LOW_PASS;\n    }\n\n    getSettings(): LowPassSettings {\n        return {\n            lowFrequency: this.lowFrequency\n        };\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if(!utilFunctions.isSettingValueValid(value)) {\n            return;\n        }\n        \n        switch (settingId) {\n        case \"lowFrequency\":\n            this.lowFrequency = parseInt(value as string);\n            break;\n        }\n    }\n}\n","import AbstractAudioFilter from \"./interfaces/AbstractAudioFilter\";\nimport Constants from \"../model/Constants\";\nimport { ReverbEnvironment } from \"../model/ReverbEnvironment\";\nimport ReverbSettings from \"../model/filtersSettings/ReverbSettings\";\nimport GenericSettingValue from \"../model/filtersSettings/GenericSettingValue\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport utilFunctions from \"@/utils/Functions\";\n\nexport default class ReverbFilter extends AbstractAudioFilter {\n\n    private reverbEnvironment: ReverbEnvironment = Constants.DEFAULT_REVERB_ENVIRONMENT;\n    private reverbCustomEnvironmentAddTime = 5;\n    private customEnvironment: AudioBuffer | null = null;\n\n    getNode(context: BaseAudioContext) {\n        const convolver = context.createConvolver();\n\n        if (!this.reverbEnvironment || (this.reverbEnvironment.url == \"custom\" && !this.customEnvironment)) {\n            // Fallback to default environment otherwise\n            this.reverbEnvironment = Constants.DEFAULT_REVERB_ENVIRONMENT;\n        }\n\n        const buffer = this.getReverbBuffer(context);\n\n        if (buffer) {\n            convolver.buffer = buffer;\n        }\n\n        return {\n            input: convolver,\n            output: convolver\n        };\n    }\n\n    private getReverbBuffer(context: BaseAudioContext): AudioBuffer | undefined {\n        if (this.reverbEnvironment.url == \"custom\" && this.customEnvironment) {\n            if (this.customEnvironment.sampleRate === context.sampleRate) {\n                return this.customEnvironment;\n            } else {\n                this.reverbEnvironment = Constants.DEFAULT_REVERB_ENVIRONMENT;\n            }\n        } else if (this.bufferFetcherService) {\n            return this.bufferFetcherService.getAudioBuffer(this.reverbEnvironment.url);\n        }\n\n        return;\n    }\n\n    get order(): number {\n        return 9;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.REVERB;\n    }\n\n    getAddingTime() {\n        const settings = this.getSettings();\n\n        if (settings && settings.reverbEnvironment) {\n            if (settings.reverbEnvironment.value != \"custom\") {\n                if (settings.reverbEnvironment.additionalData) {\n                    return settings.reverbEnvironment.additionalData.addDuration as number;\n                }\n            } else {\n                return this.reverbCustomEnvironmentAddTime;\n            }\n        }\n\n        return 0;\n    }\n\n    getSettings(): ReverbSettings {\n        if (!this.reverbEnvironment) {\n            return {\n                reverbCustomEnvironmentAddTime: this.reverbCustomEnvironmentAddTime\n            };\n        }\n\n        return {\n            reverbEnvironment: {\n                name: this.reverbEnvironment.name,\n                value: this.reverbEnvironment.url,\n                additionalData: {\n                    size: this.reverbEnvironment.size,\n                    link: this.reverbEnvironment.link,\n                    addDuration: this.reverbEnvironment.addDuration\n                }\n            },\n            downloadedBuffers: this.bufferFetcherService?.getDownloadedBuffersList(),\n            hasCustomEnvironment: this.customEnvironment ? true : false,\n            reverbCustomEnvironmentAddTime: this.reverbCustomEnvironmentAddTime\n        };\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if (settingId == \"reverbEnvironment\") {\n            const reverbEnvironment = value as GenericSettingValue;\n\n            if (reverbEnvironment) {\n                const url = reverbEnvironment.value;\n\n                try {\n                    if (url != \"custom\") {\n                        await this.bufferFetcherService?.fetchBuffer(url);\n                    }\n\n                    if (reverbEnvironment.additionalData) {\n                        this.reverbEnvironment = {\n                            name: reverbEnvironment.name,\n                            url,\n                            size: reverbEnvironment.additionalData.size as number,\n                            addDuration: reverbEnvironment.additionalData.addDuration as number,\n                            link: reverbEnvironment.additionalData.link as string\n                        };\n                    } else {\n                        this.reverbEnvironment = {\n                            name: reverbEnvironment.name,\n                            url,\n                            size: 0,\n                            addDuration: 0,\n                            link: \"\"\n                        };\n                    }\n                } catch (e) {\n                    console.error(e);\n                }\n            }\n        } else if (settingId == \"reverbCustomEnvironmentAddTime\") {\n            if (utilFunctions.isSettingValueValid(value)) {\n                this.reverbCustomEnvironmentAddTime = parseInt(value as string);\n            }\n        } else if (settingId == \"reverbCustomEnvironmentFile\") {\n            if (this.bufferDecoderService && value) {\n                this.customEnvironment = await this.bufferDecoderService.decodeBufferFromFile(value as File);\n\n                if (!this.customEnvironment) {\n                    // Fallback to default environment\n                    this.reverbEnvironment = Constants.DEFAULT_REVERB_ENVIRONMENT;\n                }\n            }\n        }\n    }\n    \n    async bufferFetcherReseted() {\n        const reverbSettings = this.getSettings();\n    \n        if (reverbSettings) {\n            const reverbUrl = (reverbSettings as ReverbSettings).reverbEnvironment?.value;\n    \n            if (reverbUrl && reverbUrl !== \"custom\" && this.bufferFetcherService) {\n                await this.bufferFetcherService.fetchBuffer(reverbUrl);\n                return true;\n            }\n        }\n\n        return false;\n    }\n}\n","/*\n * SoundTouch JS v0.2.1 audio processing library\n * Copyright (c) Olli Parviainen\n * Copyright (c) Ryan Berdeen\n * Copyright (c) Jakub Fiala\n * Copyright (c) Steve 'Cutter' Blades\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n */\n\nclass FifoSampleBuffer {\n  constructor() {\n    this._vector = new Float32Array();\n    this._position = 0;\n    this._frameCount = 0;\n  }\n  get vector() {\n    return this._vector;\n  }\n  get position() {\n    return this._position;\n  }\n  get startIndex() {\n    return this._position * 2;\n  }\n  get frameCount() {\n    return this._frameCount;\n  }\n  get endIndex() {\n    return (this._position + this._frameCount) * 2;\n  }\n  clear() {\n    this.receive(this._frameCount);\n    this.rewind();\n  }\n  put(numFrames) {\n    this._frameCount += numFrames;\n  }\n  putSamples(samples, position, numFrames = 0) {\n    position = position || 0;\n    const sourceOffset = position * 2;\n    if (!(numFrames >= 0)) {\n      numFrames = (samples.length - sourceOffset) / 2;\n    }\n    const numSamples = numFrames * 2;\n    this.ensureCapacity(numFrames + this._frameCount);\n    const destOffset = this.endIndex;\n    this.vector.set(samples.subarray(sourceOffset, sourceOffset + numSamples), destOffset);\n    this._frameCount += numFrames;\n  }\n  putBuffer(buffer, position, numFrames = 0) {\n    position = position || 0;\n    if (!(numFrames >= 0)) {\n      numFrames = buffer.frameCount - position;\n    }\n    this.putSamples(buffer.vector, buffer.position + position, numFrames);\n  }\n  receive(numFrames) {\n    if (!(numFrames >= 0) || numFrames > this._frameCount) {\n      numFrames = this.frameCount;\n    }\n    this._frameCount -= numFrames;\n    this._position += numFrames;\n  }\n  receiveSamples(output, numFrames = 0) {\n    const numSamples = numFrames * 2;\n    const sourceOffset = this.startIndex;\n    output.set(this._vector.subarray(sourceOffset, sourceOffset + numSamples));\n    this.receive(numFrames);\n  }\n  extract(output, position = 0, numFrames = 0) {\n    const sourceOffset = this.startIndex + position * 2;\n    const numSamples = numFrames * 2;\n    output.set(this._vector.subarray(sourceOffset, sourceOffset + numSamples));\n  }\n  ensureCapacity(numFrames = 0) {\n    const minLength = parseInt(numFrames * 2);\n    if (this._vector.length < minLength) {\n      const newVector = new Float32Array(minLength);\n      newVector.set(this._vector.subarray(this.startIndex, this.endIndex));\n      this._vector = newVector;\n      this._position = 0;\n    } else {\n      this.rewind();\n    }\n  }\n  ensureAdditionalCapacity(numFrames = 0) {\n    this.ensureCapacity(this._frameCount + numFrames);\n  }\n  rewind() {\n    if (this._position > 0) {\n      this._vector.set(this._vector.subarray(this.startIndex, this.endIndex));\n      this._position = 0;\n    }\n  }\n}\n\nclass AbstractFifoSamplePipe {\n  constructor(createBuffers) {\n    if (createBuffers) {\n      this._inputBuffer = new FifoSampleBuffer();\n      this._outputBuffer = new FifoSampleBuffer();\n    } else {\n      this._inputBuffer = this._outputBuffer = null;\n    }\n  }\n  get inputBuffer() {\n    return this._inputBuffer;\n  }\n  set inputBuffer(inputBuffer) {\n    this._inputBuffer = inputBuffer;\n  }\n  get outputBuffer() {\n    return this._outputBuffer;\n  }\n  set outputBuffer(outputBuffer) {\n    this._outputBuffer = outputBuffer;\n  }\n  clear() {\n    this._inputBuffer.clear();\n    this._outputBuffer.clear();\n  }\n}\n\nclass RateTransposer extends AbstractFifoSamplePipe {\n  constructor(createBuffers) {\n    super(createBuffers);\n    this.reset();\n    this._rate = 1;\n  }\n  set rate(rate) {\n    this._rate = rate;\n  }\n  reset() {\n    this.slopeCount = 0;\n    this.prevSampleL = 0;\n    this.prevSampleR = 0;\n  }\n  clone() {\n    const result = new RateTransposer();\n    result.rate = this._rate;\n    return result;\n  }\n  process() {\n    const numFrames = this._inputBuffer.frameCount;\n    this._outputBuffer.ensureAdditionalCapacity(numFrames / this._rate + 1);\n    const numFramesOutput = this.transpose(numFrames);\n    this._inputBuffer.receive();\n    this._outputBuffer.put(numFramesOutput);\n  }\n  transpose(numFrames = 0) {\n    if (numFrames === 0) {\n      return 0;\n    }\n    const src = this._inputBuffer.vector;\n    const srcOffset = this._inputBuffer.startIndex;\n    const dest = this._outputBuffer.vector;\n    const destOffset = this._outputBuffer.endIndex;\n    let used = 0;\n    let i = 0;\n    while (this.slopeCount < 1.0) {\n      dest[destOffset + 2 * i] = (1.0 - this.slopeCount) * this.prevSampleL + this.slopeCount * src[srcOffset];\n      dest[destOffset + 2 * i + 1] = (1.0 - this.slopeCount) * this.prevSampleR + this.slopeCount * src[srcOffset + 1];\n      i = i + 1;\n      this.slopeCount += this._rate;\n    }\n    this.slopeCount -= 1.0;\n    if (numFrames !== 1) {\n      out: while (true) {\n        while (this.slopeCount > 1.0) {\n          this.slopeCount -= 1.0;\n          used = used + 1;\n          if (used >= numFrames - 1) {\n            break out;\n          }\n        }\n        const srcIndex = srcOffset + 2 * used;\n        dest[destOffset + 2 * i] = (1.0 - this.slopeCount) * src[srcIndex] + this.slopeCount * src[srcIndex + 2];\n        dest[destOffset + 2 * i + 1] = (1.0 - this.slopeCount) * src[srcIndex + 1] + this.slopeCount * src[srcIndex + 3];\n        i = i + 1;\n        this.slopeCount += this._rate;\n      }\n    }\n    this.prevSampleL = src[srcOffset + 2 * numFrames - 2];\n    this.prevSampleR = src[srcOffset + 2 * numFrames - 1];\n    return i;\n  }\n}\n\nclass FilterSupport {\n  constructor(pipe) {\n    this._pipe = pipe;\n  }\n  get pipe() {\n    return this._pipe;\n  }\n  get inputBuffer() {\n    return this._pipe.inputBuffer;\n  }\n  get outputBuffer() {\n    return this._pipe.outputBuffer;\n  }\n  fillInputBuffer(\n  ) {\n    throw new Error('fillInputBuffer() not overridden');\n  }\n  fillOutputBuffer(numFrames = 0) {\n    while (this.outputBuffer.frameCount < numFrames) {\n      const numInputFrames = 8192 * 2 - this.inputBuffer.frameCount;\n      this.fillInputBuffer(numInputFrames);\n      if (this.inputBuffer.frameCount < 8192 * 2) {\n        break;\n      }\n      this._pipe.process();\n    }\n  }\n  clear() {\n    this._pipe.clear();\n  }\n}\n\nconst noop = function () {\n  return;\n};\n\nclass SimpleFilter extends FilterSupport {\n  constructor(sourceSound, pipe, callback = noop) {\n    super(pipe);\n    this.callback = callback;\n    this.sourceSound = sourceSound;\n    this.historyBufferSize = 22050;\n    this._sourcePosition = 0;\n    this.outputBufferPosition = 0;\n    this._position = 0;\n  }\n  get position() {\n    return this._position;\n  }\n  set position(position) {\n    if (position > this._position) {\n      throw new RangeError('New position may not be greater than current position');\n    }\n    const newOutputBufferPosition = this.outputBufferPosition - (this._position - position);\n    if (newOutputBufferPosition < 0) {\n      throw new RangeError('New position falls outside of history buffer');\n    }\n    this.outputBufferPosition = newOutputBufferPosition;\n    this._position = position;\n  }\n  get sourcePosition() {\n    return this._sourcePosition;\n  }\n  set sourcePosition(sourcePosition) {\n    this.clear();\n    this._sourcePosition = sourcePosition;\n  }\n  onEnd() {\n    this.callback();\n  }\n  fillInputBuffer(numFrames = 0) {\n    const samples = new Float32Array(numFrames * 2);\n    const numFramesExtracted = this.sourceSound.extract(samples, numFrames, this._sourcePosition);\n    this._sourcePosition += numFramesExtracted;\n    this.inputBuffer.putSamples(samples, 0, numFramesExtracted);\n  }\n  extract(target, numFrames = 0) {\n    this.fillOutputBuffer(this.outputBufferPosition + numFrames);\n    const numFramesExtracted = Math.min(numFrames, this.outputBuffer.frameCount - this.outputBufferPosition);\n    this.outputBuffer.extract(target, this.outputBufferPosition, numFramesExtracted);\n    const currentFrames = this.outputBufferPosition + numFramesExtracted;\n    this.outputBufferPosition = Math.min(this.historyBufferSize, currentFrames);\n    this.outputBuffer.receive(Math.max(currentFrames - this.historyBufferSize, 0));\n    this._position += numFramesExtracted;\n    return numFramesExtracted;\n  }\n  handleSampleData(event) {\n    this.extract(event.data, 4096);\n  }\n  clear() {\n    super.clear();\n    this.outputBufferPosition = 0;\n  }\n}\n\nconst USE_AUTO_SEQUENCE_LEN = 0;\nconst DEFAULT_SEQUENCE_MS = USE_AUTO_SEQUENCE_LEN;\nconst USE_AUTO_SEEKWINDOW_LEN = 0;\nconst DEFAULT_SEEKWINDOW_MS = USE_AUTO_SEEKWINDOW_LEN;\nconst DEFAULT_OVERLAP_MS = 8;\nconst _SCAN_OFFSETS = [[124, 186, 248, 310, 372, 434, 496, 558, 620, 682, 744, 806, 868, 930, 992, 1054, 1116, 1178, 1240, 1302, 1364, 1426, 1488, 0], [-100, -75, -50, -25, 25, 50, 75, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [-20, -15, -10, -5, 5, 10, 15, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [-4, -3, -2, -1, 1, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]];\nconst AUTOSEQ_TEMPO_LOW = 0.25;\nconst AUTOSEQ_TEMPO_TOP = 4.0;\nconst AUTOSEQ_AT_MIN = 125.0;\nconst AUTOSEQ_AT_MAX = 50.0;\nconst AUTOSEQ_K = (AUTOSEQ_AT_MAX - AUTOSEQ_AT_MIN) / (AUTOSEQ_TEMPO_TOP - AUTOSEQ_TEMPO_LOW);\nconst AUTOSEQ_C = AUTOSEQ_AT_MIN - AUTOSEQ_K * AUTOSEQ_TEMPO_LOW;\nconst AUTOSEEK_AT_MIN = 25.0;\nconst AUTOSEEK_AT_MAX = 15.0;\nconst AUTOSEEK_K = (AUTOSEEK_AT_MAX - AUTOSEEK_AT_MIN) / (AUTOSEQ_TEMPO_TOP - AUTOSEQ_TEMPO_LOW);\nconst AUTOSEEK_C = AUTOSEEK_AT_MIN - AUTOSEEK_K * AUTOSEQ_TEMPO_LOW;\nclass Stretch extends AbstractFifoSamplePipe {\n  constructor(createBuffers) {\n    super(createBuffers);\n    this._quickSeek = true;\n    this.midBufferDirty = false;\n    this.midBuffer = null;\n    this.overlapLength = 0;\n    this.autoSeqSetting = true;\n    this.autoSeekSetting = true;\n    this._tempo = 1;\n    this.setParameters(44100, DEFAULT_SEQUENCE_MS, DEFAULT_SEEKWINDOW_MS, DEFAULT_OVERLAP_MS);\n  }\n  clear() {\n    super.clear();\n    this.clearMidBuffer();\n  }\n  clearMidBuffer() {\n    if (this.midBufferDirty) {\n      this.midBufferDirty = false;\n      this.midBuffer = null;\n    }\n  }\n  setParameters(sampleRate, sequenceMs, seekWindowMs, overlapMs) {\n    if (sampleRate > 0) {\n      this.sampleRate = sampleRate;\n    }\n    if (overlapMs > 0) {\n      this.overlapMs = overlapMs;\n    }\n    if (sequenceMs > 0) {\n      this.sequenceMs = sequenceMs;\n      this.autoSeqSetting = false;\n    } else {\n      this.autoSeqSetting = true;\n    }\n    if (seekWindowMs > 0) {\n      this.seekWindowMs = seekWindowMs;\n      this.autoSeekSetting = false;\n    } else {\n      this.autoSeekSetting = true;\n    }\n    this.calculateSequenceParameters();\n    this.calculateOverlapLength(this.overlapMs);\n    this.tempo = this._tempo;\n  }\n  set tempo(newTempo) {\n    let intskip;\n    this._tempo = newTempo;\n    this.calculateSequenceParameters();\n    this.nominalSkip = this._tempo * (this.seekWindowLength - this.overlapLength);\n    this.skipFract = 0;\n    intskip = Math.floor(this.nominalSkip + 0.5);\n    this.sampleReq = Math.max(intskip + this.overlapLength, this.seekWindowLength) + this.seekLength;\n  }\n  get tempo() {\n    return this._tempo;\n  }\n  get inputChunkSize() {\n    return this.sampleReq;\n  }\n  get outputChunkSize() {\n    return this.overlapLength + Math.max(0, this.seekWindowLength - 2 * this.overlapLength);\n  }\n  calculateOverlapLength(overlapInMsec = 0) {\n    let newOvl;\n    newOvl = this.sampleRate * overlapInMsec / 1000;\n    newOvl = newOvl < 16 ? 16 : newOvl;\n    newOvl -= newOvl % 8;\n    this.overlapLength = newOvl;\n    this.refMidBuffer = new Float32Array(this.overlapLength * 2);\n    this.midBuffer = new Float32Array(this.overlapLength * 2);\n  }\n  checkLimits(x, mi, ma) {\n    return x < mi ? mi : x > ma ? ma : x;\n  }\n  calculateSequenceParameters() {\n    let seq;\n    let seek;\n    if (this.autoSeqSetting) {\n      seq = AUTOSEQ_C + AUTOSEQ_K * this._tempo;\n      seq = this.checkLimits(seq, AUTOSEQ_AT_MAX, AUTOSEQ_AT_MIN);\n      this.sequenceMs = Math.floor(seq + 0.5);\n    }\n    if (this.autoSeekSetting) {\n      seek = AUTOSEEK_C + AUTOSEEK_K * this._tempo;\n      seek = this.checkLimits(seek, AUTOSEEK_AT_MAX, AUTOSEEK_AT_MIN);\n      this.seekWindowMs = Math.floor(seek + 0.5);\n    }\n    this.seekWindowLength = Math.floor(this.sampleRate * this.sequenceMs / 1000);\n    this.seekLength = Math.floor(this.sampleRate * this.seekWindowMs / 1000);\n  }\n  set quickSeek(enable) {\n    this._quickSeek = enable;\n  }\n  clone() {\n    const result = new Stretch();\n    result.tempo = this._tempo;\n    result.setParameters(this.sampleRate, this.sequenceMs, this.seekWindowMs, this.overlapMs);\n    return result;\n  }\n  seekBestOverlapPosition() {\n    return this._quickSeek ? this.seekBestOverlapPositionStereoQuick() : this.seekBestOverlapPositionStereo();\n  }\n  seekBestOverlapPositionStereo() {\n    let bestOffset;\n    let bestCorrelation;\n    let correlation;\n    let i = 0;\n    this.preCalculateCorrelationReferenceStereo();\n    bestOffset = 0;\n    bestCorrelation = Number.MIN_VALUE;\n    for (; i < this.seekLength; i = i + 1) {\n      correlation = this.calculateCrossCorrelationStereo(2 * i, this.refMidBuffer);\n      if (correlation > bestCorrelation) {\n        bestCorrelation = correlation;\n        bestOffset = i;\n      }\n    }\n    return bestOffset;\n  }\n  seekBestOverlapPositionStereoQuick() {\n    let bestOffset;\n    let bestCorrelation;\n    let correlation;\n    let scanCount = 0;\n    let correlationOffset;\n    let tempOffset;\n    this.preCalculateCorrelationReferenceStereo();\n    bestCorrelation = Number.MIN_VALUE;\n    bestOffset = 0;\n    correlationOffset = 0;\n    tempOffset = 0;\n    for (; scanCount < 4; scanCount = scanCount + 1) {\n      let j = 0;\n      while (_SCAN_OFFSETS[scanCount][j]) {\n        tempOffset = correlationOffset + _SCAN_OFFSETS[scanCount][j];\n        if (tempOffset >= this.seekLength) {\n          break;\n        }\n        correlation = this.calculateCrossCorrelationStereo(2 * tempOffset, this.refMidBuffer);\n        if (correlation > bestCorrelation) {\n          bestCorrelation = correlation;\n          bestOffset = tempOffset;\n        }\n        j = j + 1;\n      }\n      correlationOffset = bestOffset;\n    }\n    return bestOffset;\n  }\n  preCalculateCorrelationReferenceStereo() {\n    let i = 0;\n    let context;\n    let temp;\n    for (; i < this.overlapLength; i = i + 1) {\n      temp = i * (this.overlapLength - i);\n      context = i * 2;\n      this.refMidBuffer[context] = this.midBuffer[context] * temp;\n      this.refMidBuffer[context + 1] = this.midBuffer[context + 1] * temp;\n    }\n  }\n  calculateCrossCorrelationStereo(mixingPosition, compare) {\n    const mixing = this._inputBuffer.vector;\n    mixingPosition += this._inputBuffer.startIndex;\n    let correlation = 0;\n    let i = 2;\n    const calcLength = 2 * this.overlapLength;\n    let mixingOffset;\n    for (; i < calcLength; i = i + 2) {\n      mixingOffset = i + mixingPosition;\n      correlation += mixing[mixingOffset] * compare[i] + mixing[mixingOffset + 1] * compare[i + 1];\n    }\n    return correlation;\n  }\n  overlap(overlapPosition) {\n    this.overlapStereo(2 * overlapPosition);\n  }\n  overlapStereo(inputPosition) {\n    const input = this._inputBuffer.vector;\n    inputPosition += this._inputBuffer.startIndex;\n    const output = this._outputBuffer.vector;\n    const outputPosition = this._outputBuffer.endIndex;\n    let i = 0;\n    let context;\n    let tempFrame;\n    const frameScale = 1 / this.overlapLength;\n    let fi;\n    let inputOffset;\n    let outputOffset;\n    for (; i < this.overlapLength; i = i + 1) {\n      tempFrame = (this.overlapLength - i) * frameScale;\n      fi = i * frameScale;\n      context = 2 * i;\n      inputOffset = context + inputPosition;\n      outputOffset = context + outputPosition;\n      output[outputOffset + 0] = input[inputOffset + 0] * fi + this.midBuffer[context + 0] * tempFrame;\n      output[outputOffset + 1] = input[inputOffset + 1] * fi + this.midBuffer[context + 1] * tempFrame;\n    }\n  }\n  process() {\n    let offset;\n    let temp;\n    let overlapSkip;\n    if (this.midBuffer === null) {\n      if (this._inputBuffer.frameCount < this.overlapLength) {\n        return;\n      }\n      this.midBuffer = new Float32Array(this.overlapLength * 2);\n      this._inputBuffer.receiveSamples(this.midBuffer, this.overlapLength);\n    }\n    while (this._inputBuffer.frameCount >= this.sampleReq) {\n      offset = this.seekBestOverlapPosition();\n      this._outputBuffer.ensureAdditionalCapacity(this.overlapLength);\n      this.overlap(Math.floor(offset));\n      this._outputBuffer.put(this.overlapLength);\n      temp = this.seekWindowLength - 2 * this.overlapLength;\n      if (temp > 0) {\n        this._outputBuffer.putBuffer(this._inputBuffer, offset + this.overlapLength, temp);\n      }\n      const start = this._inputBuffer.startIndex + 2 * (offset + this.seekWindowLength - this.overlapLength);\n      this.midBuffer.set(this._inputBuffer.vector.subarray(start, start + 2 * this.overlapLength));\n      this.skipFract += this.nominalSkip;\n      overlapSkip = Math.floor(this.skipFract);\n      this.skipFract -= overlapSkip;\n      this._inputBuffer.receive(overlapSkip);\n    }\n  }\n}\n\nconst testFloatEqual = function (a, b) {\n  return (a > b ? a - b : b - a) > 1e-10;\n};\n\nclass SoundTouch {\n  constructor() {\n    this.transposer = new RateTransposer(false);\n    this.stretch = new Stretch(false);\n    this._inputBuffer = new FifoSampleBuffer();\n    this._intermediateBuffer = new FifoSampleBuffer();\n    this._outputBuffer = new FifoSampleBuffer();\n    this._rate = 0;\n    this._tempo = 0;\n    this.virtualPitch = 1.0;\n    this.virtualRate = 1.0;\n    this.virtualTempo = 1.0;\n    this.calculateEffectiveRateAndTempo();\n  }\n  clear() {\n    this.transposer.clear();\n    this.stretch.clear();\n  }\n  clone() {\n    const result = new SoundTouch();\n    result.rate = this.rate;\n    result.tempo = this.tempo;\n    return result;\n  }\n  get rate() {\n    return this._rate;\n  }\n  set rate(rate) {\n    this.virtualRate = rate;\n    this.calculateEffectiveRateAndTempo();\n  }\n  set rateChange(rateChange) {\n    this._rate = 1.0 + 0.01 * rateChange;\n  }\n  get tempo() {\n    return this._tempo;\n  }\n  set tempo(tempo) {\n    this.virtualTempo = tempo;\n    this.calculateEffectiveRateAndTempo();\n  }\n  set tempoChange(tempoChange) {\n    this.tempo = 1.0 + 0.01 * tempoChange;\n  }\n  set pitch(pitch) {\n    this.virtualPitch = pitch;\n    this.calculateEffectiveRateAndTempo();\n  }\n  set pitchOctaves(pitchOctaves) {\n    this.pitch = Math.exp(0.69314718056 * pitchOctaves);\n    this.calculateEffectiveRateAndTempo();\n  }\n  set pitchSemitones(pitchSemitones) {\n    this.pitchOctaves = pitchSemitones / 12.0;\n  }\n  get inputBuffer() {\n    return this._inputBuffer;\n  }\n  get outputBuffer() {\n    return this._outputBuffer;\n  }\n  calculateEffectiveRateAndTempo() {\n    const previousTempo = this._tempo;\n    const previousRate = this._rate;\n    this._tempo = this.virtualTempo / this.virtualPitch;\n    this._rate = this.virtualRate * this.virtualPitch;\n    if (testFloatEqual(this._tempo, previousTempo)) {\n      this.stretch.tempo = this._tempo;\n    }\n    if (testFloatEqual(this._rate, previousRate)) {\n      this.transposer.rate = this._rate;\n    }\n    if (this._rate > 1.0) {\n      if (this._outputBuffer != this.transposer.outputBuffer) {\n        this.stretch.inputBuffer = this._inputBuffer;\n        this.stretch.outputBuffer = this._intermediateBuffer;\n        this.transposer.inputBuffer = this._intermediateBuffer;\n        this.transposer.outputBuffer = this._outputBuffer;\n      }\n    } else {\n      if (this._outputBuffer != this.stretch.outputBuffer) {\n        this.transposer.inputBuffer = this._inputBuffer;\n        this.transposer.outputBuffer = this._intermediateBuffer;\n        this.stretch.inputBuffer = this._intermediateBuffer;\n        this.stretch.outputBuffer = this._outputBuffer;\n      }\n    }\n  }\n  process() {\n    if (this._rate > 1.0) {\n      this.stretch.process();\n      this.transposer.process();\n    } else {\n      this.transposer.process();\n      this.stretch.process();\n    }\n  }\n}\n\nclass WebAudioBufferSource {\n  constructor(buffer) {\n    this.buffer = buffer;\n    this._position = 0;\n  }\n  get dualChannel() {\n    return this.buffer.numberOfChannels > 1;\n  }\n  get position() {\n    return this._position;\n  }\n  set position(value) {\n    this._position = value;\n  }\n  extract(target, numFrames = 0, position = 0) {\n    this.position = position;\n    let left = this.buffer.getChannelData(0);\n    let right = this.dualChannel ? this.buffer.getChannelData(1) : this.buffer.getChannelData(0);\n    let i = 0;\n    for (; i < numFrames; i++) {\n      target[i * 2] = left[i + position];\n      target[i * 2 + 1] = right[i + position];\n    }\n    return Math.min(numFrames, left.length - position);\n  }\n}\n\nconst getWebAudioNode = function (context, filter, sourcePositionCallback = noop, bufferSize = 4096) {\n  const node = context.createScriptProcessor(bufferSize, 2, 2);\n  const samples = new Float32Array(bufferSize * 2);\n  node.onaudioprocess = event => {\n    let left = event.outputBuffer.getChannelData(0);\n    let right = event.outputBuffer.getChannelData(1);\n    let framesExtracted = filter.extract(samples, bufferSize);\n    sourcePositionCallback(filter.sourcePosition);\n    if (framesExtracted === 0) {\n      filter.onEnd();\n    }\n    let i = 0;\n    for (; i < framesExtracted; i++) {\n      left[i] = samples[i * 2];\n      right[i] = samples[i * 2 + 1];\n    }\n  };\n  return node;\n};\n\nconst pad = function (n, width, z) {\n  z = z || '0';\n  n = n + '';\n  return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n};\nconst minsSecs = function (secs) {\n  const mins = Math.floor(secs / 60);\n  const seconds = secs - mins * 60;\n  return `${mins}:${pad(parseInt(seconds), 2)}`;\n};\n\nconst onUpdate = function (sourcePosition) {\n  const currentTimePlayed = this.timePlayed;\n  const sampleRate = this.sampleRate;\n  this.sourcePosition = sourcePosition;\n  this.timePlayed = sourcePosition / sampleRate;\n  if (currentTimePlayed !== this.timePlayed) {\n    const timePlayed = new CustomEvent('play', {\n      detail: {\n        timePlayed: this.timePlayed,\n        formattedTimePlayed: this.formattedTimePlayed,\n        percentagePlayed: this.percentagePlayed\n      }\n    });\n    this._node.dispatchEvent(timePlayed);\n  }\n};\nclass PitchShifter {\n  constructor(context, buffer, bufferSize, onEnd = noop) {\n    this._soundtouch = new SoundTouch();\n    const source = new WebAudioBufferSource(buffer);\n    this.timePlayed = 0;\n    this.sourcePosition = 0;\n    this._filter = new SimpleFilter(source, this._soundtouch, onEnd);\n    this._node = getWebAudioNode(context, this._filter, sourcePostion => onUpdate.call(this, sourcePostion), bufferSize);\n    this.tempo = 1;\n    this.rate = 1;\n    this.duration = buffer.duration;\n    this.sampleRate = context.sampleRate;\n    this.listeners = [];\n  }\n  get formattedDuration() {\n    return minsSecs(this.duration);\n  }\n  get formattedTimePlayed() {\n    return minsSecs(this.timePlayed);\n  }\n  get percentagePlayed() {\n    return 100 * this._filter.sourcePosition / (this.duration * this.sampleRate);\n  }\n  set percentagePlayed(perc) {\n    this._filter.sourcePosition = parseInt(perc * this.duration * this.sampleRate);\n    this.sourcePosition = this._filter.sourcePosition;\n    this.timePlayed = this.sourcePosition / this.sampleRate;\n  }\n  get node() {\n    return this._node;\n  }\n  set pitch(pitch) {\n    this._soundtouch.pitch = pitch;\n  }\n  set pitchSemitones(semitone) {\n    this._soundtouch.pitchSemitones = semitone;\n  }\n  set rate(rate) {\n    this._soundtouch.rate = rate;\n  }\n  set tempo(tempo) {\n    this._soundtouch.tempo = tempo;\n  }\n  connect(toNode) {\n    this._node.connect(toNode);\n  }\n  disconnect() {\n    this._node.disconnect();\n  }\n  on(eventName, cb) {\n    this.listeners.push({\n      name: eventName,\n      cb: cb\n    });\n    this._node.addEventListener(eventName, event => cb(event.detail));\n  }\n  off(eventName = null) {\n    let listeners = this.listeners;\n    if (eventName) {\n      listeners = listeners.filter(e => e.name === eventName);\n    }\n    listeners.forEach(e => {\n      this._node.removeEventListener(e.name, event => e.cb(event.detail));\n    });\n  }\n}\n\nexport { AbstractFifoSamplePipe, PitchShifter, RateTransposer, SimpleFilter, SoundTouch, Stretch, WebAudioBufferSource, getWebAudioNode };\n//# sourceMappingURL=soundtouch.js.map\n","import SoundtouchWorkletMessage from \"../../model/SoundtouchWorkletMessage\";\nimport { SoundtouchWorkletOptionsWrapper } from \"../../model/SoundtouchWorkletOptionsWrapper\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nlet soundtouchWrapperFilterWorkletNodeClass: any;\n\nif(typeof(window) !== \"undefined\" && typeof(window.AudioWorkletNode) !== \"undefined\") {\n    soundtouchWrapperFilterWorkletNodeClass = class SoundtouchWrapperFilterWorkletNode extends AudioWorkletNode {\n\n        name: string = \"\";\n        private running = false;\n        private _tempo = 1;\n        private _pitch = 1;\n\n        constructor(context: BaseAudioContext, workletName: string, options: SoundtouchWorkletOptionsWrapper) {\n            super(context, workletName, options);\n            this.name = this.constructor.name;\n            this.running = true;\n            this.updateInterval = options.processorOptions.updateInterval;\n        }\n\n        async setup(tempo: number, pitch: number): Promise<void> {\n            return new Promise(resolve => {\n                if(this.port) {\n                    this.port.onmessage = (ev: MessageEvent<SoundtouchWorkletMessage>) => {\n                        if(ev && ev.data && ev.data.status === \"OK\" && ev.data.args[0] === \"setup\") {\n                            this.port.onmessage = this.messageProcessor.bind(this);\n                            resolve();\n                        }\n                    };\n    \n                    this.port.postMessage({ command: \"setup\", args: [tempo, pitch] });\n\n                    this._tempo = tempo;\n                    this._pitch = pitch;\n                }\n            });\n        }\n\n        set updateInterval(value: number) {\n            this.port.postMessage({ command: \"updateInterval\", args: [value] });\n        }\n\n        get node() {\n            return this;\n        }\n\n        set tempo(value: number) {\n            this.port.postMessage({ command: \"setTempo\", args: [value] });\n        }\n\n        set pitch(value: number) {\n            this.port.postMessage({ command: \"setPitch\", args: [value] });\n        }\n\n        get tempo(): number {\n            this.port.postMessage({ command: \"getTempo\", args: [] });\n            return this._tempo;\n        }\n\n        get pitch(): number {\n            this.port.postMessage({ command: \"getPitch\", args: [] });\n            return this._pitch;\n        }\n\n        async stop() {\n            if (!this.running) return;\n\n            this.port.postMessage({ command: \"stop\", args: [] });\n            this.disconnect();\n\n            this.running = false;\n        }\n\n        messageProcessor(e: MessageEvent<SoundtouchWorkletMessage>) {\n            if (e.data.command) {\n                const { command } = e.data;\n                \n                switch (command) {\n                case \"End\":\n                    this.stop();\n                    break;\n                default:\n                    break;\n                }\n\n                if (e.data.status) {\n                    const value = e.data.args[1];\n\n                    switch (e.data.args[0]) {\n                    case \"getTempo\":\n                        this._tempo = value as number;\n                        break;\n                    case \"getPitch\":\n                        this._pitch = value as number;\n                        break;\n                    default:\n                        break;\n                    }\n                    return;\n                }\n            }\n        }\n    };\n}\n\nexport default soundtouchWrapperFilterWorkletNodeClass;\n","// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n//@ts-ignore\nimport { PitchShifter } from \"soundtouchjs\";\nimport Constants from \"../model/Constants\";\nimport AbstractAudioFilterWorklet from \"./interfaces/AbstractAudioFilterWorklet\";\nimport AudioFilterEntrypointInterface from \"./interfaces/AudioFilterEntrypointInterface\";\nimport { AudioFilterNodes } from \"../model/AudioNodes\";\nimport utils from \"../utils/Functions\";\nimport SoundtouchWrapperFilterWorkletNode from \"./worklets/SoundtouchWrapperFilterWorkletNode\";\nimport SimpleAudioWorkletProcessor from \"../workletPolyfill/SimpleAudioWorkletProcessor\";\nimport SoundtouchSettings from \"../model/filtersSettings/SoundtouchSettings\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport utilFunctions from \"../utils/Functions\";\n\nexport default class SoundtouchWrapperFilter extends AbstractAudioFilterWorklet<void> implements AudioFilterEntrypointInterface {\n\n    private speedAudio = 1;\n    private frequencyAudio = 1;\n    private currentSpeedAudio = 1;\n    private currentPitchShifterWorklet: typeof SoundtouchWrapperFilterWorkletNode;\n    private currentPitchShifter: PitchShifter;\n    private isOfflineMode = false;\n\n    constructor() {\n        super();\n        this.setDefaultEnabled(true);\n    }\n\n    async initializeWorklet(): Promise<void> {\n        // Do nothing\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    receiveEvent(message: MessageEvent<void>): void {\n        // Do nothing\n    }\n\n    get workletPath(): string {\n        return Constants.WORKLET_PATHS.SOUNDTOUCH;\n    }\n\n    constructAudioWorkletProcessor(): SimpleAudioWorkletProcessor {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    get workletName(): string {\n        return Constants.WORKLET_NAMES.SOUNDTOUCH;\n    }\n\n    async getEntrypointNode(context: BaseAudioContext, buffer: AudioBuffer, offline: boolean): Promise<AudioFilterNodes> {\n        this.isOfflineMode = offline;\n\n        this.cleanUpOldNodes();\n\n        // In offline (compatibility) mode\n        if (offline) {\n            // If the settings are untouched, we don't use Soundtouch\n            if (!this.isEnabled() || (this.speedAudio == 1 && this.frequencyAudio == 1)) {\n                // Just return an audio buffer source node\n                const bufferSource = context.createBufferSource();\n                bufferSource.buffer = buffer;\n                bufferSource.start();\n\n                return {\n                    input: bufferSource,\n                    output: bufferSource\n                };\n            } else {\n                // If audio worklet is enabled for soundtouch, and if the speed of audio is untouched\n                // Soundtouch Audio Worklet don't support speed editing yet\n                if (this.isAudioWorkletEnabled() && utils.isAudioWorkletCompatible(context) && this.speedAudio == 1) {\n                    return this.renderWithWorklet(buffer, context);\n                } else {\n                    return this.renderWithScriptProcessorNode(buffer, context);\n                }\n            }\n        }\n\n        // Not in offline mode: get classic soundtouch script processor node\n        this.currentPitchShifter = this.getSoundtouchScriptProcessorNode(buffer, context);\n        this.updateState();\n\n        return {\n            input: this.currentPitchShifter,\n            output: this.currentPitchShifter\n        };\n    }\n\n    /** Cleanup old nodes (worklets, pitch shifter) */\n    private cleanUpOldNodes() {\n        // Stop current worklet\n        if (this.currentPitchShifterWorklet) {\n            this.currentPitchShifterWorklet.stop();\n            this.currentPitchShifterWorklet.disconnect();\n        }\n\n        if (this.currentPitchShifter) {\n            this.currentPitchShifter.disconnect();\n            this.currentPitchShifter._filter = null;\n        }\n    }\n\n    private getSoundtouchScriptProcessorNode(buffer: AudioBuffer, context: BaseAudioContext): AudioNode {\n        return new PitchShifter(context, buffer, Constants.SOUNDTOUCH_PITCH_SHIFTER_BUFFER_SIZE);\n    }\n\n    /**\n     * Use script processor node (deprecated) to render the audio buffer with Soundtouch, according to the current settings.\n     * Not working on Firefox\n     * @param buffer Audio buffer\n     * @param context Audio context\n     * @returns A promise resolving to audio nodes with the rendered audio as a buffer source\n     */\n    private async renderWithScriptProcessorNode(buffer: AudioBuffer, context: BaseAudioContext): Promise<AudioFilterNodes> {\n        const durationAudio = utils.calcAudioDuration(buffer, this.speedAudio);\n        const offlineContext = new OfflineAudioContext(2, context.sampleRate * durationAudio, context.sampleRate);\n\n        this.currentPitchShifter = this.getSoundtouchScriptProcessorNode(buffer, offlineContext);\n        this.updateState();\n\n        this.currentPitchShifter.connect(offlineContext.destination);\n\n        const renderedBuffer = await offlineContext.startRendering();\n\n        const bufferSourceRendered = context.createBufferSource();\n        bufferSourceRendered.buffer = renderedBuffer;\n        bufferSourceRendered.start();\n\n        this.cleanUpOldNodes();\n\n        return {\n            input: bufferSourceRendered,\n            output: bufferSourceRendered\n        };\n    }\n\n    /**\n     * EXPERIMENTAL - Use audio worklet to render the audio buffer with Soundtouch, according to the current settings.\n     * Working in Firefox and Chrome\n     * @param buffer Audio buffer\n     * @param context Audio context\n     * @returns A promise resolving to audio nodes with the rendered audio as a buffer source\n     */\n    private async renderWithWorklet(buffer: AudioBuffer, context: BaseAudioContext): Promise<AudioFilterNodes> {\n        const durationAudio = utils.calcAudioDuration(buffer, this.speedAudio);\n\n        try {\n            // Setup worklet JS module\n            await context.audioWorklet.addModule((this.configService ? this.configService.getWorkletBasePath() : \"\") + Constants.WORKLET_PATHS.SOUNDTOUCH);\n\n            // Setup an audio buffer source from the audio buffer\n            const bufferSource = context.createBufferSource();\n            bufferSource.buffer = buffer;\n            bufferSource.start();\n\n            // Create the worklet node\n            this.currentPitchShifterWorklet = new SoundtouchWrapperFilterWorkletNode(context, \"soundtouch-worklet\", {\n                processorOptions: {\n                    bypass: false,\n                    recording: false,\n                    nInputFrames: this.approximateNInputFrames(durationAudio, context),\n                    updateInterval: 10.0,\n                    sampleRate: buffer.sampleRate\n                },\n            });\n\n            // Connect the node for correct rendering\n            bufferSource.connect(this.currentPitchShifterWorklet.node);\n\n            // Setup pitch/speed of Soundtouch\n            if (this.isEnabled()) {\n                await this.currentPitchShifterWorklet.setup(this.speedAudio, this.frequencyAudio);\n            } else {\n                await this.currentPitchShifterWorklet.setup(1, 1);\n            }\n\n            return {\n                input: this.currentPitchShifterWorklet,\n                output: this.currentPitchShifterWorklet\n            };\n        } catch (e) {\n            // Fallback to script processor node\n            console.error(e);\n            return this.renderWithScriptProcessorNode(buffer, context);\n        }\n    }\n\n    private approximateNInputFrames(durationAudio: number, context: BaseAudioContext) {\n        // {frequencyAudio, multiplicator}: {{0.1, 10}, {0.2, 5}, {0.3, 3.33}, {0.4, 2.5}, {0.5, 2}, {0.6, 1.67}, {0.7, 1.43}, {0.8, 1.25}, {0.9, 1.11}, {1, 1}}\n        return durationAudio * context.sampleRate * (Math.round(14 * Math.exp(-4 * this.frequencyAudio)) + 1);\n    }\n\n    get order(): number {\n        return 2;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.SOUNDTOUCH;\n    }\n\n    getSettings(): SoundtouchSettings {\n        return {\n            speedAudio: this.speedAudio,\n            frequencyAudio: this.frequencyAudio\n        };\n    }\n\n    protected isAudioWorkletEnabled() {\n        if (this.configService) {\n            return this.configService.isSoundtouchAudioWorkletEnabled();\n        }\n\n        return Constants.ENABLE_SOUNDTOUCH_AUDIO_WORKLET;\n    }\n\n    private getCurrentPitchShifter() {\n        if (this.isOfflineMode) {\n            // If the settings are untouched, we don't use Soundtouch\n            if (this.speedAudio == 1 && this.frequencyAudio == 1) {\n                return null;\n            } else {\n                if (this.isAudioWorkletEnabled() && this.currentPitchShifterWorklet && this.speedAudio == 1) {\n                    return this.currentPitchShifterWorklet;\n                } else {\n                    return this.currentPitchShifter;\n                }\n            }\n        }\n\n        return this.currentPitchShifter;\n    }\n\n    updateState(): void {\n        const pitchShifter = this.getCurrentPitchShifter();\n\n        if (!this.isEnabled()) {\n            if (pitchShifter) {\n                pitchShifter.pitch = 1;\n                pitchShifter.tempo = 1;\n            }\n\n            this.currentSpeedAudio = 1;\n        } else {\n            if (pitchShifter) {\n                pitchShifter.pitch = this.frequencyAudio;\n                pitchShifter.tempo = this.speedAudio;\n            }\n\n            this.currentSpeedAudio = this.speedAudio;\n        }\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if (!utilFunctions.isSettingValueValid(value)) {\n            return;\n        }\n\n        const valueFloat = parseFloat(value as string);\n\n        switch (settingId) {\n        case \"speedAudio\":\n            this.speedAudio = valueFloat;\n            break;\n        case \"frequencyAudio\":\n            this.frequencyAudio = valueFloat;\n            break;\n        default:\n            break;\n        }\n\n        this.updateState();\n    }\n\n    setEnabled(state: boolean): void {\n        super.setEnabled(state);\n        this.updateState();\n    }\n\n    getSpeed(): number {\n        return this.currentSpeedAudio;\n    }\n}\n","import AbstractAudioFilter from \"./interfaces/AbstractAudioFilter\";\nimport Constants from \"../model/Constants\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\n\nexport default class TelephonizerFilter extends AbstractAudioFilter {\n\n    getNode(context: BaseAudioContext) {\n        const lpf1 = context.createBiquadFilter();\n        lpf1.type = \"lowpass\";\n        lpf1.frequency.value = 2000.0;\n        const lpf2 = context.createBiquadFilter();\n        lpf2.type = \"lowpass\";\n        lpf2.frequency.value = 2000.0;\n        const hpf1 = context.createBiquadFilter();\n        hpf1.type = \"highpass\";\n        hpf1.frequency.value = 500.0;\n        const hpf2 = context.createBiquadFilter();\n        hpf2.type = \"highpass\";\n        hpf2.frequency.value = 500.0;\n        lpf1.connect(lpf2);\n        lpf2.connect(hpf1);\n        hpf1.connect(hpf2);\n    \n        return {\n            input: lpf1,\n            output: hpf2\n        };\n    }\n    \n    get order(): number {\n        return 7;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.TELEPHONIZER;\n    }\n\n    getSettings() {\n        return {};\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async setSetting(settingId: string, value: FilterSettingValue) { }\n}\n","/*\n * Copyright (c) 2012 The Chromium Authors. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *    * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *    * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *    * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n/*\n * Copyright (C) 2023 Eliastik (eliastiksofts.com)\n *\n * This file is part of \"Simple Voice Changer\".\n *\n * \"Simple Voice Changer\" is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * \"Simple Voice Changer\" is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with \"Simple Voice Changer\".  If not, see <http://www.gnu.org/licenses/>.\n */\ninterface VocoderBand {\n    frequency: number;\n}\n\nexport default class Vocoder {\n\n    private FILTER_QUALITY = 6;  // The Q value for the carrier and modulator filters\n    private FOURIER_SIZE = 4096;\n    private WAVETABLEBOOST = 40.0;\n    private SAWTOOTHBOOST = 0.40;\n    private oscillatorType = 4;   // CUSTOM\n    private oscillatorDetuneValue = 0;\n\n    private audioContext: BaseAudioContext | null = null;\n    private modulatorBuffer: AudioBuffer | undefined;\n    private carrierBuffer: AudioBuffer | null = null;\n    private modulatorNode: AudioBufferSourceNode | null = null;\n    private vocoding = false;\n\n    // These are \"placeholder\" gain nodes - because the modulator and carrier will get swapped in\n    // as they are loaded, it's easier to connect these nodes to all the bands, and the \"real\"\n    // modulator & carrier AudioBufferSourceNodes connect to these.\n    private modulatorInput: GainNode | null = null;\n    private carrierInput: GainNode | null = null;\n\n    private modulatorGain: GainNode | null = null;\n    private modulatorGainValue = 1.0;\n\n    // noise node added to the carrier signal\n    private noiseBuffer: AudioBuffer | null = null;\n    private noiseNode: AudioBufferSourceNode | null = null;\n    private noiseGain: GainNode | null = null;\n    private noiseGainValue = 0.2;\n\n    // Carrier sample gain\n    private carrierSampleNode: AudioBufferSourceNode | null = null;\n    private carrierSampleGain: GainNode | null = null;\n    private carrierSampleGainValue = 0.0;\n\n    // Carrier Synth oscillator stuff\n    private oscillatorNode: OscillatorNode | null = null;\n    private oscillatorGain: GainNode | null = null;\n    private oscillatorGainValue = 1.0;\n    private wavetable: PeriodicWave | null = null;\n    private wavetableSignalGain: GainNode | null = null;\n\n    // These are the arrays of nodes - the \"columns\" across the frequency band \"rows\"\n    private modFilterBands: BiquadFilterNode[] | null = null;    // tuned bandpass filters\n    private modFilterPostGains: GainNode[] | null = null;  // post-filter gains.\n    private heterodynes: GainNode[] | null = null;   // gain nodes used to multiply bandpass X sine\n    private powers: number[] | null = null;      // gain nodes used to multiply prev out by itself\n    private lpFilters: BiquadFilterNode[] | null = null;   // tuned LP filters to remove doubled copy of product\n    private lpFilterPostGains: GainNode[] | null = null;   // gain nodes for tuning input to waveshapers\n    private carrierBands: BiquadFilterNode[] | null = null;  // tuned bandpass filters, same as modFilterBands but in carrier chain\n    private carrierFilterPostGains: GainNode[] | null = null;  // post-bandpass gain adjustment\n    private carrierBandGains: GainNode[] | null = null;  // these are the \"control gains\" driven by the lpFilters\n\n    private vocoderBands: VocoderBand[] | null = null;\n    private numVocoderBands: number = 0;\n\n    private hpFilterGain: GainNode | null = null;\n    private outputGain: GainNode | null = null;\n\n    // Initialization function for the page.\n    constructor(ctx: BaseAudioContext, carrierB: AudioBuffer, modulatorB?: AudioBuffer) {\n        this.audioContext = ctx;\n        this.carrierBuffer = carrierB;\n        this.modulatorBuffer = modulatorB;\n    }\n\n    init() {\n        this.generateVocoderBands(55, 7040, 28);\n        // Set up the vocoder chains\n        this.setupVocoderGraph();\n        this.vocode();\n    }\n\n    getNodes() {\n        return {\n            modulatorNode: this.modulatorNode,\n            modulatorGain: this.modulatorGain,\n            synthLevel: this.oscillatorGain,\n            noiseNode: this.noiseGain,\n            oscillatorNode: this.oscillatorNode,\n            hpFilterGain: this.hpFilterGain,\n            outputGain: this.outputGain\n        };\n    }\n\n    private shutOffCarrier() {\n        if (this.oscillatorNode && this.noiseNode && this.carrierSampleNode) {\n            this.oscillatorNode.stop(0);\n            this.oscillatorNode = null;\n            this.noiseNode.stop(0);\n            this.noiseNode = null;\n            this.carrierSampleNode.stop(0);\n            this.carrierSampleNode = null;\n        }\n    }\n\n    selectSawtooth() {\n        if (this.wavetableSignalGain)\n            this.wavetableSignalGain.gain.value = this.SAWTOOTHBOOST;\n        if (this.oscillatorNode)\n            this.oscillatorNode.type = \"sawtooth\";\n    }\n\n    selectWavetable() {\n        if (this.wavetableSignalGain)\n            this.wavetableSignalGain.gain.value = this.WAVETABLEBOOST;\n        if (this.oscillatorNode && this.wavetable)\n            this.oscillatorNode.setPeriodicWave(this.wavetable);\n        if (this.wavetableSignalGain)\n            this.wavetableSignalGain.gain.value = this.WAVETABLEBOOST;\n    }\n\n    updateModGain(value: number) {\n        this.modulatorGainValue = value;\n        if (this.modulatorGain)\n            this.modulatorGain.gain.value = value;\n    }\n\n    // sample-based carrier\n    updateSampleLevel(value: number) {\n        this.carrierSampleGainValue = value;\n        if (this.carrierSampleGain)\n            this.carrierSampleGain.gain.value = value;\n    }\n\n    // noise in carrier\n    updateSynthLevel(value: number) {\n        this.oscillatorGainValue = value;\n        if (this.oscillatorGain)\n            this.oscillatorGain.gain.value = value;\n    }\n\n    // noise in carrier\n    updateNoiseLevel(value: number) {\n        this.noiseGainValue = value;\n        if (this.noiseGain)\n            this.noiseGain.gain.value = value;\n    }\n\n    updateDetuneValue(value: number) {\n        this.oscillatorDetuneValue = value;\n        if (this.oscillatorNode)\n            this.oscillatorNode.detune.value = value;\n    }\n\n    // this will algorithmically re-calculate vocoder bands, distributing evenly\n    // from startFreq to endFreq, splitting evenly (logarhythmically) into a given numBands.\n    // The function places this info into the global vocoderBands and numVocoderBands letiables.\n    private generateVocoderBands(startFreq: number, endFreq: number, numBands: number) {\n        // Remember: 1200 cents in octave, 100 cents per semitone\n\n        const totalRangeInCents = 1200 * Math.log(endFreq / startFreq) / Math.LN2;\n        const centsPerBand = totalRangeInCents / numBands;\n        const scale = Math.pow(2, centsPerBand / 1200);  // This is the scaling for successive bands\n\n        this.vocoderBands = [];\n        let currentFreq = startFreq;\n\n        for (let i = 0; i < numBands; i++) {\n            this.vocoderBands[i] = { frequency: currentFreq };\n            //console.log( \"Band \" + i + \" centered at \" + currentFreq + \"Hz\" );\n            currentFreq = currentFreq * scale;\n        }\n\n        this.numVocoderBands = numBands;\n    }\n\n    private loadNoiseBuffer() {  // create a 5-second buffer of noise\n        if (!this.audioContext) return;\n\n        const lengthInSamples = 5 * this.audioContext.sampleRate;\n        this.noiseBuffer = this.audioContext.createBuffer(1, lengthInSamples, this.audioContext.sampleRate);\n        const bufferData = this.noiseBuffer.getChannelData(0);\n\n        for (let i = 0; i < lengthInSamples; ++i) {\n            bufferData[i] = (2 * Math.random() - 1);  // -1 to +1\n        }\n    }\n\n    private initBandpassFilters() {\n        if (!this.audioContext) return;\n\n        // When this function is called, the carrierNode and modulatorAnalyser\n        // may not already be created.  Create placeholder nodes for them.\n        this.modulatorInput = this.audioContext.createGain();\n        this.carrierInput = this.audioContext.createGain();\n\n        if (this.modFilterBands == null)\n            this.modFilterBands = [];\n\n        if (this.modFilterPostGains == null)\n            this.modFilterPostGains = [];\n\n        if (this.heterodynes == null)\n            this.heterodynes = [];\n\n        if (this.powers == null)\n            this.powers = [];\n\n        if (this.lpFilters == null)\n            this.lpFilters = [];\n\n        if (this.lpFilterPostGains == null)\n            this.lpFilterPostGains = [];\n\n        if (this.carrierBands == null)\n            this.carrierBands = [];\n\n        if (this.carrierFilterPostGains == null)\n            this.carrierFilterPostGains = [];\n\n        if (this.carrierBandGains == null)\n            this.carrierBandGains = [];\n\n        const waveShaperCurve = new Float32Array(65536);\n        // Populate with a \"curve\" that does an abs()\n        const n = 65536;\n        const n2 = n / 2;\n        let x;\n\n        for (let i = 0; i < n2; ++i) {\n            x = i / n2;\n\n            waveShaperCurve[n2 + i] = x;\n            waveShaperCurve[n2 - i - 1] = x;\n        }\n\n        // Set up a high-pass filter to add back in the fricatives, etc.\n        // (this isn't used by default in the \"production\" version, as I hid the slider)\n        const hpFilter = this.audioContext.createBiquadFilter();\n        hpFilter.type = \"highpass\";\n        hpFilter.frequency.value = 8000; // or use vocoderBands[numVocoderBands-1].frequency;\n        hpFilter.Q.value = 1; //  no peaking\n        this.modulatorInput.connect(hpFilter);\n\n        this.hpFilterGain = this.audioContext.createGain();\n        this.hpFilterGain.gain.value = 0.0;\n\n        hpFilter.connect(this.hpFilterGain);\n\n        if(this.modulatorBuffer) {\n            this.hpFilterGain.connect(this.audioContext.destination);\n        }\n\n        //clear the arrays\n        this.modFilterBands.length = 0;\n        this.modFilterPostGains.length = 0;\n        this.heterodynes.length = 0;\n        this.powers.length = 0;\n        this.lpFilters.length = 0;\n        this.lpFilterPostGains.length = 0;\n        this.carrierBands.length = 0;\n        this.carrierFilterPostGains.length = 0;\n        this.carrierBandGains.length = 0;\n\n        this.outputGain = this.audioContext.createGain();\n\n        if(this.modulatorBuffer) {\n            this.outputGain.connect(this.audioContext.destination);\n        }\n\n        const rectifierCurve = new Float32Array(65536);\n        for (let i = -32768; i < 32768; i++)\n            rectifierCurve[i + 32768] = ((i > 0) ? i : -i) / 32768;\n\n        for (let i = 0; i < this.numVocoderBands; i++) {\n            // CREATE THE MODULATOR CHAIN\n            // create the bandpass filter in the modulator chain\n            const modulatorFilter = this.audioContext.createBiquadFilter();\n            modulatorFilter.type = \"bandpass\";  // Bandpass filter\n            if (this.vocoderBands)\n                modulatorFilter.frequency.value = this.vocoderBands[i].frequency;\n            modulatorFilter.Q.value = this.FILTER_QUALITY; //  initial quality\n            this.modulatorInput.connect(modulatorFilter);\n            this.modFilterBands.push(modulatorFilter);\n\n            // Now, create a second bandpass filter tuned to the same frequency -\n            // this turns our second-order filter into a 4th-order filter,\n            // which has a steeper rolloff/octave\n            const secondModulatorFilter = this.audioContext.createBiquadFilter();\n            secondModulatorFilter.type = \"bandpass\";  // Bandpass filter\n            if (this.vocoderBands)\n                secondModulatorFilter.frequency.value = this.vocoderBands[i].frequency;\n            secondModulatorFilter.Q.value = this.FILTER_QUALITY; //  initial quality\n            //modulatorFilter.chainedFilter = secondModulatorFilter;\n            modulatorFilter.connect(secondModulatorFilter);\n\n            // create a post-filtering gain to bump the levels up.\n            const modulatorFilterPostGain = this.audioContext.createGain();\n            modulatorFilterPostGain.gain.value = 6;\n            secondModulatorFilter.connect(modulatorFilterPostGain);\n            this.modFilterPostGains.push(modulatorFilterPostGain);\n\n            // Create the sine oscillator for the heterodyne\n            const heterodyneOscillator = this.audioContext.createOscillator();\n            if (this.vocoderBands)\n                heterodyneOscillator.frequency.value = this.vocoderBands[i].frequency;\n\n            heterodyneOscillator.start(0);\n\n            // Create the node to multiply the sine by the modulator\n            const heterodyne = this.audioContext.createGain();\n            modulatorFilterPostGain.connect(heterodyne);\n            heterodyne.gain.value = 0.0;  // audio-rate inputs are summed with initial intrinsic value\n            heterodyneOscillator.connect(heterodyne.gain);\n\n            const heterodynePostGain = this.audioContext.createGain();\n            heterodynePostGain.gain.value = 2.0;    // GUESS:  boost\n            heterodyne.connect(heterodynePostGain);\n            this.heterodynes.push(heterodynePostGain);\n\n\n            // Create the rectifier node\n            const rectifier = this.audioContext.createWaveShaper();\n            rectifier.curve = rectifierCurve;\n            heterodynePostGain.connect(rectifier);\n\n            // Create the lowpass filter to mask off the difference (near zero)\n            const lpFilter = this.audioContext.createBiquadFilter();\n            lpFilter.type = \"lowpass\";  // Lowpass filter\n            lpFilter.frequency.value = 5.0; // Guesstimate!  Mask off 20Hz and above.\n            lpFilter.Q.value = 1; // don't need a peak\n            this.lpFilters.push(lpFilter);\n            rectifier.connect(lpFilter);\n\n            const lpFilterPostGain = this.audioContext.createGain();\n            lpFilterPostGain.gain.value = 1.0;\n            lpFilter.connect(lpFilterPostGain);\n            this.lpFilterPostGains.push(lpFilterPostGain);\n\n            const waveshaper = this.audioContext.createWaveShaper();\n            waveshaper.curve = waveShaperCurve;\n            lpFilterPostGain.connect(waveshaper);\n\n\n            // Create the bandpass filter in the carrier chain\n            const carrierFilter = this.audioContext.createBiquadFilter();\n            carrierFilter.type = \"bandpass\";\n            if (this.vocoderBands)\n                carrierFilter.frequency.value = this.vocoderBands[i].frequency;\n            carrierFilter.Q.value = this.FILTER_QUALITY;\n            this.carrierBands.push(carrierFilter);\n            this.carrierInput.connect(carrierFilter);\n\n            // We want our carrier filters to be 4th-order filter too.\n            const secondCarrierFilter = this.audioContext.createBiquadFilter();\n            secondCarrierFilter.type = \"bandpass\";  // Bandpass filter\n            if (this.vocoderBands)\n                secondCarrierFilter.frequency.value = this.vocoderBands[i].frequency;\n            secondCarrierFilter.Q.value = this.FILTER_QUALITY; //  initial quality\n            //carrierFilter.chainedFilter = secondCarrierFilter;\n            carrierFilter.connect(secondCarrierFilter);\n\n            const carrierFilterPostGain = this.audioContext.createGain();\n            carrierFilterPostGain.gain.value = 10.0;\n            secondCarrierFilter.connect(carrierFilterPostGain);\n            this.carrierFilterPostGains.push(carrierFilterPostGain);\n\n            // Create the carrier band gain node\n            const bandGain = this.audioContext.createGain();\n            this.carrierBandGains.push(bandGain);\n            carrierFilterPostGain.connect(bandGain);\n            bandGain.gain.value = 0.0;  // audio-rate inputs are summed with initial intrinsic value\n            waveshaper.connect(bandGain.gain);  // connect the lp controller\n\n            bandGain.connect(this.outputGain);\n        }\n\n\n        // Now set up our wavetable stuff.\n        const real = new Float32Array(this.FOURIER_SIZE);\n        const imag = new Float32Array(this.FOURIER_SIZE);\n        real[0] = 0.0;\n        imag[0] = 0.0;\n        for (let i = 1; i < this.FOURIER_SIZE; i++) {\n            real[i] = 1.0;\n            imag[i] = 1.0;\n        }\n\n        this.wavetable = this.audioContext.createPeriodicWave(real, imag);\n        this.loadNoiseBuffer();\n    }\n\n    private setupVocoderGraph() {\n        this.initBandpassFilters();\n    }\n\n    private createCarriersAndPlay(output: GainNode | null) {\n        if(!this.audioContext || !output) return;\n\n        this.carrierSampleNode = this.audioContext.createBufferSource();\n        this.carrierSampleNode.buffer = this.carrierBuffer;\n        this.carrierSampleNode.loop = true;\n\n        this.carrierSampleGain = this.audioContext.createGain();\n        this.carrierSampleGain.gain.value = this.carrierSampleGainValue;\n        this.carrierSampleNode.connect(this.carrierSampleGain);\n        this.carrierSampleGain.connect(output);\n\n        // The wavetable signal needs a boost.\n        this.wavetableSignalGain = this.audioContext.createGain();\n\n        this.oscillatorNode = this.audioContext.createOscillator();\n        if (this.oscillatorType == 4 && this.wavetable) { // wavetable\n            this.oscillatorNode.setPeriodicWave(this.wavetable);\n            this.wavetableSignalGain.gain.value = this.WAVETABLEBOOST;\n        } else {\n            //oscillatorNode.type = oscillatorType;\n            this.wavetableSignalGain.gain.value = this.SAWTOOTHBOOST;\n        }\n        this.oscillatorNode.frequency.value = 110;\n        this.oscillatorNode.detune.value = this.oscillatorDetuneValue;\n        this.oscillatorNode.connect(this.wavetableSignalGain);\n\n        this.oscillatorGain = this.audioContext.createGain();\n        this.oscillatorGain.gain.value = this.oscillatorGainValue;\n\n        this.wavetableSignalGain.connect(this.oscillatorGain);\n        this.oscillatorGain.connect(output);\n\n        this.noiseNode = this.audioContext.createBufferSource();\n        this.noiseNode.buffer = this.noiseBuffer;\n        this.noiseNode.loop = true;\n        this.noiseGain = this.audioContext.createGain();\n        this.noiseGain.gain.value = this.noiseGainValue;\n        this.noiseNode.connect(this.noiseGain);\n\n        this.noiseGain.connect(output);\n        this.oscillatorNode.start(0);\n        this.noiseNode.start(0);\n        this.carrierSampleNode.start(0);\n\n    }\n\n    private vocode() {\n        if(!this.audioContext) return;\n\n        if (this.vocoding) {\n            if (this.modulatorNode) {\n                this.modulatorNode.stop(0);\n            }\n            this.shutOffCarrier();\n            this.vocoding = false;\n            return;\n        }\n\n        this.createCarriersAndPlay(this.carrierInput);\n\n        this.vocoding = true;\n\n        this.modulatorGain = this.audioContext.createGain();\n        this.modulatorGain.gain.value = this.modulatorGainValue;\n\n        if(this.modulatorBuffer) {\n            this.modulatorNode = this.audioContext.createBufferSource();\n            this.modulatorNode.buffer = this.modulatorBuffer;\n            this.modulatorNode.connect(this.modulatorGain);\n            this.modulatorNode.start(0);\n        }\n\n        if (this.modulatorInput)\n            this.modulatorGain.connect(this.modulatorInput);\n    }\n}\n","import AbstractAudioFilter from \"./interfaces/AbstractAudioFilter\";\nimport { AudioFilterNodes } from \"../model/AudioNodes\";\nimport Constants from \"../model/Constants\";\nimport Vocoder from \"../utils/Vocoder\";\nimport VocoderSettings from \"../model/filtersSettings/VocoderSettings\";\nimport utilFunctions from \"../utils/Functions\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\n\nexport default class VocoderFilter extends AbstractAudioFilter {\n\n    private currentVocoder: Vocoder | null = null;\n    private modulatorGainValue = 1.0;\n    private carrierSampleGainValue = 0;\n    private oscillatorGainValue = 1.0;\n    private noiseGainValue = 0.2;\n    private oscillatorDetuneValue = 0;\n\n    getNode(context: BaseAudioContext): AudioFilterNodes {\n        const modulatorBuffer = this.bufferFetcherService?.getAudioBuffer(Constants.VOCODER_MODULATOR);\n\n        this.currentVocoder = new Vocoder(context, modulatorBuffer!);\n        this.currentVocoder.init();\n        this.applyCurrentSettingsToVocoder();\n\n        const { modulatorGain, outputGain } = this.currentVocoder.getNodes();\n\n        return {\n            input: modulatorGain!,\n            output: outputGain!\n        };\n    }\n\n    getSettings(): VocoderSettings {\n        return {\n            modulatorGainValue: this.modulatorGainValue,\n            carrierSampleGainValue: this.carrierSampleGainValue,\n            oscillatorGainValue: this.oscillatorGainValue,\n            noiseGainValue: this.noiseGainValue,\n            oscillatorDetuneValue: this.oscillatorDetuneValue\n        };\n    }\n\n    async setSetting(settingId: string, value: FilterSettingValue) {\n        if(!utilFunctions.isSettingValueValid(value)) {\n            return;\n        }\n        \n        switch (settingId) {\n        case \"modulatorGainValue\":\n            this.modulatorGainValue = parseFloat(value as string);\n            break;\n        case \"carrierSampleGainValue\":\n            this.carrierSampleGainValue = parseFloat(value as string);\n            break;\n        case \"oscillatorGainValue\":\n            this.oscillatorGainValue = parseFloat(value as string);\n            break;\n        case \"noiseGainValue\":\n            this.noiseGainValue = parseFloat(value as string);\n            break;\n        case \"oscillatorDetuneValue\":\n            this.oscillatorDetuneValue = parseFloat(value as string);\n            break;\n        }\n\n        this.applyCurrentSettingsToVocoder();\n    }\n\n    private applyCurrentSettingsToVocoder() {\n        if(this.currentVocoder) {\n            this.currentVocoder.updateModGain(this.modulatorGainValue);\n            this.currentVocoder.updateSampleLevel(this.carrierSampleGainValue);\n            this.currentVocoder.updateSynthLevel(this.oscillatorGainValue);\n            this.currentVocoder.updateNoiseLevel(this.noiseGainValue);\n            this.currentVocoder.updateDetuneValue(this.oscillatorDetuneValue);\n        }\n    }\n    \n    get order(): number {\n        return 1;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.VOCODER;\n    }\n}\n","import Constants from \"../../model/Constants\";\n\nclass PassthroughWorkletProcessor extends AudioWorkletProcessor {\n\n    stopped = false;\n    samplesCount = 0;\n\n    constructor() {\n        super();\n        this.port.onmessage = (event) => {\n            if (event.data == \"stop\") {\n                this.stop();\n            }\n        };\n    }\n\n    static get parameterDescriptors() {\n        return [];\n    }\n\n    get defaultParameterDescriptors() {\n        return PassthroughWorkletProcessor.parameterDescriptors;\n    }\n\n    process(inputs: Float32Array[][], outputs: Float32Array[][]): boolean {\n        if (this.stopped) return false;\n\n        const input = inputs[0];\n        const output = outputs[0];\n\n        if (input && input[0]) {\n            this.samplesCount += input[0].length;\n        }\n\n        if (output) {\n            for(let channel = 0; channel < output.length; channel++) {\n                const inp = input[channel];\n                const out = output[channel];\n\n                if (inp) {\n                    for (let sample = 0; sample < inp.length; sample++) {\n                        out[sample] = inp[sample];\n                    }\n                }\n            }\n\n            this.port.postMessage({ command: \"update\", samplesCount: this.samplesCount });\n        }\n\n        return true;\n    }\n\n    stop() {\n        this.stopped = true;\n    }\n}\n\nregisterProcessor(Constants.WORKLET_NAMES.PASSTHROUGH, PassthroughWorkletProcessor);\n","import AbstractAudioFilterWorklet from \"./interfaces/AbstractAudioFilterWorklet\";\nimport Constants from \"../model/Constants\";\nimport \"./worklets/Passthrough.worklet\";\nimport { FilterSettingValue } from \"../model/filtersSettings/FilterSettings\";\nimport PassThroughWorkletEvent from \"@/model/PassThroughWorkletEvent\";\nimport { EventType } from \"@/model/EventTypeEnum\";\n\nexport default class PassThroughFilter extends AbstractAudioFilterWorklet<PassThroughWorkletEvent> {\n\n    private currentTime = 0;\n    private lastSampleCount = 0;\n    private samplePerSecond = 0;\n    private currentTimeSamplesPerSecond = 0;\n\n    receiveEvent(message: MessageEvent<PassThroughWorkletEvent>): void {\n        const currentTime = performance.now();\n        const samplesProcessed = message.data.samplesCount;\n\n        if (message.data.command === \"update\") {\n            this.calculatePercentageProcessed(currentTime, samplesProcessed);\n        }\n\n        this.calculateRemainingTimeProcessing(currentTime, samplesProcessed);\n    }\n\n    /**\n     * Calculate percentage processed\n     * @param currentTime Current time (ms)\n     * @param samplesProcessed Samples count processed\n     */\n    private calculatePercentageProcessed(currentTime: number, samplesProcessed: number) {\n        if (this.currentTime === 0) {\n            this.currentTime = currentTime;\n        }\n\n        const timeDifference = currentTime - this.currentTime;\n        const percentageProcessed = (samplesProcessed / this._totalSamples);\n\n        if (this.eventEmitter && timeDifference >= Constants.TREATMENT_TIME_COUNTING_THROTTLE_INTERVAL) {\n            this.eventEmitter.emit(EventType.UPDATE_AUDIO_TREATMENT_PERCENT, percentageProcessed * 100);\n            this.currentTime = currentTime;\n        }\n    }\n\n    /**\n     * Calculate remaining time to process the audio\n     * @param currentTime Current time (ms)\n     * @param samplesProcessed Samples count processed\n     */\n    private calculateRemainingTimeProcessing(currentTime: number, samplesProcessed: number) {\n        if (this.currentTimeSamplesPerSecond === 0) {\n            this.currentTimeSamplesPerSecond = currentTime;\n        }\n\n        const timeDifferenceSamplePerSecond = currentTime - this.currentTimeSamplesPerSecond;\n        const remainingSamples = this._totalSamples - samplesProcessed;\n\n        if (this.eventEmitter && remainingSamples <= 0) {\n            this.eventEmitter.emit(EventType.UPDATE_REMAINING_TIME_ESTIMATED, 0);\n            return;\n        }\n\n        if (this.eventEmitter && timeDifferenceSamplePerSecond >= 1000) {\n            this.calculateSmoothedSamplePerSecond(timeDifferenceSamplePerSecond, samplesProcessed);\n\n            const remainingTimeSeconds = remainingSamples / this.samplePerSecond;\n\n            this.currentTimeSamplesPerSecond = currentTime;\n            this.lastSampleCount = samplesProcessed;\n\n            if (isNaN(remainingTimeSeconds) || !isFinite(remainingTimeSeconds)) {\n                this.eventEmitter.emit(EventType.UPDATE_REMAINING_TIME_ESTIMATED, -1);\n            } else {\n                this.eventEmitter.emit(EventType.UPDATE_REMAINING_TIME_ESTIMATED, remainingTimeSeconds);\n            }\n        }\n    }\n\n    /**\n     * Calculate smoothed samples per second\n     * @param timeDifferenceSamplePerSecond Time difference \n     * @param samplesProcessed Samples count processed\n     * @returns Smoothed samples per second\n     */\n    private calculateSmoothedSamplePerSecond(timeDifferenceSamplePerSecond: number, samplesProcessed: number): void {\n        if (timeDifferenceSamplePerSecond > 0) {\n            const currentSampleRate = (samplesProcessed - this.lastSampleCount) / (timeDifferenceSamplePerSecond / 1000);\n            this.samplePerSecond = (Constants.TREATMENT_TIME_COUNTING_SMOOTHING_FACTOR * currentSampleRate) + ((1 - Constants.TREATMENT_TIME_COUNTING_SMOOTHING_FACTOR) * this.samplePerSecond);\n        }\n    }\n\n    get workletName(): string {\n        return Constants.WORKLET_NAMES.PASSTHROUGH;\n    }\n\n    get workletPath(): string {\n        return Constants.WORKLET_PATHS.PASSTHROUGH;\n    }\n\n    get order(): number {\n        return 10;\n    }\n\n    get id(): string {\n        return Constants.FILTERS_NAMES.PASSTHROUGH;\n    }\n\n    set totalSamples(value: number) {\n        super.totalSamples = value;\n        this.currentTime = 0;\n        this.currentTimeSamplesPerSecond = 0;\n        this.samplePerSecond = 0;\n        this.lastSampleCount = 0;\n    }\n\n    getSettings() {\n        return {};\n    }\n\n    isEnabled(): boolean {\n        return true;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async setSetting(settingId: string, value: FilterSettingValue) { }\n}\n","import { TYPES } from \"@/inversify.types\";\nimport AudioEditorInterface from \"@/audioEditor/interfaces/AudioEditorInterface\";\nimport { getAudioEditorContainer } from \"@/inversify.config\";\nimport { ConfigService } from \"@/services/interfaces/ConfigService\";\nimport EventEmitterInterface from \"./interfaces/EventEmitterInterface\";\nimport BufferPlayerInterface from \"@/bufferPlayer/interfaces/BufferPlayerInterface\";\nimport GenericConfigService from \"@/services/GenericConfigService\";\nimport VoiceRecorderInterface from \"@/voiceRecorder/interfaces/VoiceRecorderInterface\";\nimport SoundStudioFactoryNewInstanceOptions from \"@/model/SoundStudioFactoryNewInstanceOptions\";\nimport SoundStudioFactoryInstance from \"@/model/SoundStudioFactoryInstance\";\n\n/**\n * Factory class to create instances of sound studio components.\n * \n * This factory supports both singleton-based methods (deprecated) and a new\n * instance-based creation model. The singleton methods will be removed in a\n * future release.\n */\nexport default class SoundStudioFactory {\n\n    private static ready = false;\n\n    // Singletons (remove when removing deprecated methods)\n    private static audioEditor: AudioEditorInterface | null = null;\n    private static audioPlayer: BufferPlayerInterface | null = null;\n    private static configService: ConfigService | null = null;\n    private static eventEmitter: EventEmitterInterface | null = null;\n    private static voiceRecorder: VoiceRecorderInterface | null = null;\n\n    /**\n     * Create a new instance of sound studio components.\n     * \n     * @param options Optional configuration for the new instance. See SoundStudioFactoryNewInstanceOptions\n     * @returns A new instance of the sound studio components. See SoundStudioFactoryInstance\n     */\n    static createNewInstance(options?: SoundStudioFactoryNewInstanceOptions): SoundStudioFactoryInstance {\n        const audioEditorContainer = getAudioEditorContainer();\n\n        if (options && options.configService) {\n            audioEditorContainer.bind<ConfigService>(TYPES.ConfigService).toDynamicValue(() => options.configService!);\n        } else {\n            audioEditorContainer.bind<ConfigService>(TYPES.ConfigService).to(GenericConfigService);\n            console.warn(\"No ConfigService provided. Using default generic implementation.\");\n        }\n\n        audioEditorContainer.bind<string[]>(TYPES.AudioBuffersToFetch).toConstantValue((options && options.buffersToFetch) || []);\n\n        return {\n            audioEditor: audioEditorContainer.get<AudioEditorInterface>(TYPES.AudioEditor),\n            audioPlayer: audioEditorContainer.get<BufferPlayerInterface>(TYPES.BufferPlayer),\n            configService: audioEditorContainer.get<ConfigService>(TYPES.ConfigService),\n            eventEmitter: audioEditorContainer.get<EventEmitterInterface>(TYPES.EventEmitter),\n            voiceRecorder: audioEditorContainer.get<VoiceRecorderInterface>(TYPES.VoiceRecorder)\n        };\n    }\n\n    /**\n     * Create a singleton AudioEditor instance.\n     * \n     * @param configService Optional configuration service.\n     * @param buffersToFetch Optional list of audio buffers to pre-fetch.\n     * @returns The singleton AudioEditor instance.\n     * @deprecated This method is deprecated. Use createNewInstance instead.\n     */\n    static createAudioEditor(configService?: ConfigService, buffersToFetch?: string[]): AudioEditorInterface {\n        console.warn(\"[DEPRECATED] SoundStudioFactory.createAudioEditor is deprecated and \"\n            + \"will be removed in a future release of simple-sound-studio-lib. \" +\n            \"Please use SoundStudioFactory.createNewInstance instead, which doesn't work as a singleton.\");\n\n        if (!SoundStudioFactory.ready) {\n            const instance = SoundStudioFactory.createNewInstance({ configService, buffersToFetch });\n\n            SoundStudioFactory.audioEditor = instance.audioEditor;\n            SoundStudioFactory.audioPlayer = instance.audioPlayer;\n            SoundStudioFactory.configService = instance.configService;\n            SoundStudioFactory.eventEmitter = instance.eventEmitter;\n            SoundStudioFactory.voiceRecorder = instance.voiceRecorder;\n\n            SoundStudioFactory.ready = true;\n        }\n\n        return SoundStudioFactory.audioEditor!;\n    }\n\n    /**\n     * Create a singleton VoiceRecorder instance.\n     * \n     * @returns The singleton VoiceRecorder instance.\n     * @deprecated This method is deprecated. Use createNewInstance instead.\n     */\n    static createVoiceRecorder(): VoiceRecorderInterface {\n        console.warn(\"[DEPRECATED] SoundStudioFactory.createVoiceRecorder is deprecated and \"\n            + \"will be removed in a future release of simple-sound-studio-lib. \" +\n            \"Please use SoundStudioFactory.createNewInstance instead, which doesn't work as a singleton.\");\n\n        return SoundStudioFactory.voiceRecorder!;\n    }\n\n    /**\n     * Get the singleton AudioEditor instance.\n     * \n     * @returns The singleton AudioEditor instance, or null if not initialized.\n     * @deprecated This method is deprecated. Use createNewInstance instead.\n     */\n    static getAudioEditorInstance(): AudioEditorInterface | null {\n        console.warn(\"[DEPRECATED] SoundStudioFactory.getAudioEditorInstance is deprecated and \"\n            + \"will be removed in a future release of simple-sound-studio-lib. \" +\n            \"Please use SoundStudioFactory.createNewInstance instead, which doesn't work as a singleton.\");\n\n        return SoundStudioFactory.audioEditor!;\n    }\n\n    /**\n     * Get the singleton BufferPlayer instance.\n     * \n     * @returns The singleton BufferPlayer instance, or null if not initialized.\n     * @deprecated This method is deprecated. Use createNewInstance instead.\n     */\n    static getAudioPlayerInstance(): BufferPlayerInterface | null {\n        console.warn(\"[DEPRECATED] SoundStudioFactory.getAudioPlayerInstance is deprecated and \"\n            + \"will be removed in a future release of simple-sound-studio-lib. \" +\n            \"Please use SoundStudioFactory.createNewInstance instead, which doesn't work as a singleton.\");\n\n        return SoundStudioFactory.audioPlayer!;\n    }\n\n    /**\n     * Get the singleton VoiceRecorder instance.\n     * \n     * @returns The singleton VoiceRecorder instance, or null if not initialized.\n     * @deprecated This method is deprecated. Use createNewInstance instead.\n     */\n    static getAudioRecorderInstance(): VoiceRecorderInterface | null {\n        console.warn(\"[DEPRECATED] SoundStudioFactory.getAudioRecorderInstance is deprecated and \"\n            + \"will be removed in a future release of simple-sound-studio-lib. \" +\n            \"Please use SoundStudioFactory.createNewInstance instead, which doesn't work as a singleton.\");\n\n        return SoundStudioFactory.voiceRecorder!;\n    }\n\n    /**\n     * Get the singleton EventEmitter instance.\n     * \n     * @returns The singleton EventEmitter instance, or null if not initialized.\n     * @deprecated This method is deprecated. Use createNewInstance instead.\n     */\n    static getEventEmitterInstance(): EventEmitterInterface | null {\n        console.warn(\"[DEPRECATED] SoundStudioFactory.getEventEmitterInstance is deprecated and \"\n            + \"will be removed in a future release of simple-sound-studio-lib. \" +\n            \"Please use SoundStudioFactory.createNewInstance instead, which doesn't work as a singleton.\");\n\n        return SoundStudioFactory.eventEmitter!;\n    }\n\n    /**\n     * Get the singleton ConfigService instance.\n     * \n     * @returns The singleton ConfigService instance, or undefined if not initialized.\n     * @deprecated This method is deprecated. Use createNewInstance instead.\n     */\n    static getConfigServiceInstance(): ConfigService | undefined {\n        console.warn(\"[DEPRECATED] SoundStudioFactory.getConfigServiceInstance is deprecated and \"\n            + \"will be removed in a future release of simple-sound-studio-lib. \" +\n            \"Please use SoundStudioFactory.createNewInstance instead, which doesn't work as a singleton.\");\n\n        return SoundStudioFactory.configService!;\n    }\n}\n","import \"reflect-metadata\";\nimport { Container } from \"inversify\";\nimport { TYPES } from \"./inversify.types\";\nimport AudioContextManagerInterface from \"./audioEditor/interfaces/AudioContextManagerInterface\";\nimport AudioContextManager from \"./audioEditor/AudioContextManager\";\nimport AudioEditorInterface from \"./audioEditor/interfaces/AudioEditorInterface\";\nimport AudioProcessorInterface from \"./audioEditor/interfaces/AudioProcessorInterface\";\nimport BufferManagerInterface from \"./audioEditor/interfaces/BufferManagerInterface\";\nimport FilterManagerInterface from \"./audioEditor/interfaces/FilterManagerInterface\";\nimport RendererManagerInterface from \"./audioEditor/interfaces/RendererManagerInterface\";\nimport SaveBufferManagerInterface from \"./audioEditor/interfaces/SaveBufferManagerInteface\";\nimport AudioEditor from \"./audioEditor/AudioEditor\";\nimport AudioProcessor from \"./audioEditor/AudioProcessor\";\nimport BufferManager from \"./audioEditor/BufferManager\";\nimport FilterManager from \"./audioEditor/FilterManager\";\nimport RendererManager from \"./audioEditor/RendererManager\";\nimport SaveBufferManager from \"./audioEditor/SaveBufferManager\";\nimport EventEmitterInterface from \"./utils/interfaces/EventEmitterInterface\";\nimport EventEmitter from \"./utils/EventEmitter\";\nimport BufferPlayerInterface from \"./bufferPlayer/interfaces/BufferPlayerInterface\";\nimport BufferPlayer from \"./bufferPlayer/BufferPlayer\";\nimport BufferFetcherServiceInterface from \"./services/interfaces/BufferFetcherServiceInterface\";\nimport BufferDecoderServiceInterface from \"./services/interfaces/BufferDecoderServiceInterface\";\nimport BufferFetcherService from \"./services/BufferFetcherService\";\nimport BufferDecoderService from \"./services/BufferDecoderService\";\nimport AbstractAudioRenderer from \"./filters/interfaces/AbstractAudioRenderer\";\nimport ReturnAudioRenderer from \"./filters/ReturnAudioRenderer\";\nimport BassBoosterFilter from \"./filters/BassBoosterFilter\";\nimport BitCrusherFilter from \"./filters/BitCrusherFilter\";\nimport EchoFilter from \"./filters/EchoFilter\";\nimport HighPassFilter from \"./filters/HighPassFilter\";\nimport LimiterFilter from \"./filters/LimiterFilter\";\nimport LowPassFilter from \"./filters/LowPassFilter\";\nimport ReverbFilter from \"./filters/ReverbFilter\";\nimport SoundtouchWrapperFilter from \"./filters/SountouchWrapperFilter\";\nimport TelephonizerFilter from \"./filters/TelephonizerFilter\";\nimport VocoderFilter from \"./filters/VocoderFilter\";\nimport PassThroughFilter from \"./filters/PassThroughFilter\";\nimport AbstractAudioFilter from \"./filters/interfaces/AbstractAudioFilter\";\nimport AudioFilterEntrypointInterface from \"./filters/interfaces/AudioFilterEntrypointInterface\";\nimport VoiceRecorderInterface from \"./voiceRecorder/interfaces/VoiceRecorderInterface\";\nimport VoiceRecorder from \"./voiceRecorder/VoiceRecorder\";\n\nfunction getAudioEditorContainer() {\n    const audioEditorContainer = new Container({ defaultScope: \"Singleton\" });\n    \n    // Entrypoint filter\n    audioEditorContainer.bind<AudioFilterEntrypointInterface>(TYPES.EntryPointFilter).to(SoundtouchWrapperFilter);\n    \n    // Renderers\n    audioEditorContainer.bind<AbstractAudioRenderer>(TYPES.Renderers).to(ReturnAudioRenderer);\n    \n    // Filters\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).toDynamicValue(() => audioEditorContainer.get<AbstractAudioFilter>(TYPES.EntryPointFilter));\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(BassBoosterFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(BitCrusherFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(EchoFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(HighPassFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(LimiterFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(LowPassFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(ReverbFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(TelephonizerFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(VocoderFilter);\n    audioEditorContainer.bind<AbstractAudioFilter>(TYPES.Filters).to(PassThroughFilter);\n    \n    // Services\n    audioEditorContainer.bind<EventEmitterInterface>(TYPES.EventEmitter).to(EventEmitter);\n    audioEditorContainer.bind<AudioContextManagerInterface>(TYPES.AudioContextManager).to(AudioContextManager);\n    audioEditorContainer.bind<AudioEditorInterface>(TYPES.AudioEditor).to(AudioEditor);\n    audioEditorContainer.bind<AudioProcessorInterface>(TYPES.AudioProcessor).to(AudioProcessor);\n    audioEditorContainer.bind<BufferManagerInterface>(TYPES.BufferManager).to(BufferManager);\n    audioEditorContainer.bind<FilterManagerInterface>(TYPES.FilterManager).to(FilterManager);\n    audioEditorContainer.bind<RendererManagerInterface>(TYPES.RendererManager).to(RendererManager);\n    audioEditorContainer.bind<SaveBufferManagerInterface>(TYPES.SaveBufferManager).to(SaveBufferManager);\n    audioEditorContainer.bind<BufferPlayerInterface>(TYPES.BufferPlayer).to(BufferPlayer);\n    audioEditorContainer.bind<BufferFetcherServiceInterface>(TYPES.BufferFetcherService).to(BufferFetcherService);\n    audioEditorContainer.bind<BufferDecoderServiceInterface>(TYPES.BufferDecoderService).to(BufferDecoderService);\n    audioEditorContainer.bind<VoiceRecorderInterface>(TYPES.VoiceRecorder).to(VoiceRecorder);\n\n    return audioEditorContainer;\n}\n\nexport { getAudioEditorContainer };\n"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","SuppressedError","t","toString","name","Error","root","globalThis","global","self","this","Function","_","functionThis","eval","indirectEvalThis","exporter","makeExporter","previous","configurable","writable","hasOwn","prototype","hasOwnProperty","supportsSymbol","Symbol","toPrimitiveSymbol","toPrimitive","iteratorSymbol","iterator","supportsCreate","create","supportsProto","__proto__","Array","downLevel","HashMap","MakeDictionary","has","map","call","get","undefined","functionPrototype","getPrototypeOf","_Map","Map","entries","CreateMapPolyfill","_Set","Set","CreateSetPolyfill","_WeakMap","WeakMap","CreateWeakMapPolyfill","registrySymbol","for","metadataRegistry","GetOrCreateMetadataRegistry","metadataProvider","CreateMetadataProvider","propertyKey","attributes","IsUndefined","IsArray","TypeError","IsConstructor","DecorateConstructor","IsObject","IsNull","DecorateProperty","ToPropertyKey","IsPropertyKey","OrdinaryDefineOwnMetadata","defineMetadata","hasMetadata","OrdinaryHasMetadata","hasOwnMetadata","OrdinaryHasOwnMetadata","getMetadata","OrdinaryGetMetadata","getOwnMetadata","OrdinaryGetOwnMetadata","getMetadataKeys","OrdinaryMetadataKeys","getOwnMetadataKeys","OrdinaryOwnMetadataKeys","deleteMetadata","provider","GetMetadataProvider","OrdinaryDeleteMetadata","decorated","descriptor","MetadataKey","O","parent","OrdinaryGetPrototypeOf","ToBoolean","MetadataValue","ownKeys","parentKeys","set","keys","_i","ownKeys_1","add","push","_a","parentKeys_1","Type","x","IsSymbol","ToPrimitive","input","PreferredType","hint","exoticToPrim","GetMethod","OrdinaryToPrimitive","valueOf","toString_1","IsCallable","argument","ToString","isArray","SameValueZero","y","V","func","GetIterator","obj","method","IteratorValue","iterResult","IteratorStep","IteratorClose","f","proto","prototypeProto","constructor","CreateMetadataRegistry","fallback","first","second","rest","CreateFallbackProvider","targetProviderMap","registry","registerProvider","getProvider","setProvider","isExtensible","getProviderNoCache","isProviderFor","providerMap","hasProvider","existingProvider","enumerable","targetMetadata","GetOrCreateMetadataMap","Create","createdTargetMetadata","metadataMap","delete","k","nextValue","size","reflect","metadataOwner","metadataPropertySet","registeredProvider","cacheSentinel","arraySentinel","MapIterator","values","selector","_index","_keys","_values","_selector","index","throw","error","return","_cacheKey","_cacheIndex","_find","clear","getKey","getValue","getEntry","insert","_map","UUID_SIZE","rootKey","CreateUniqueKey","_key","table","GetOrCreateWeakMapTable","CreateUUID","FillRandomBytes","buffer","Math","random","GenRandomBytes","Uint8Array","array","crypto","getRandomValues","msCrypto","data","offset","byte","toLowerCase","__","factory","n","n$1","is","unwrap","a","s","u","o","clone","getAllKeys","removeByRelation","indexOf","splice","l","p","moduleId","serviceId","g","isOptional","build","removeAllByModuleId","removeAllByServiceId","id","m","getNonParentBindings","getById","getByModuleId","getNonParentBoundServices","removeById","serviceIdentifier","h","M","constructorArguments","lifecycle","postConstructMethodName","preDestroyMethodName","properties","scope","I","w","b","w$1","kind","super","isErrorOfKind","j","T","C","S","missingInjectionDecorator","join","unknown","A","$","injectionDecoratorConflict","planning","resolution","multipleInjection","singleInjection","unmanaged","R","optional","tags","isFromTypescriptParamType","B","F","property","targetClass","parameter","message","cause","D","N","E","BigInt","Boolean","Number","String","K","forEach","includes","U","J","oe","Te","re","elem","getAncestor","ae","last","concat","se","customServiceIdentifier","getBindings","filter","isSatisfiedBy","autobindOptions","cache","isRight","implementationType","onActivation","onDeactivation","type","setBinding","ce","redirections","ue","binding","targetServiceIdentifier","le","pe","de","fe","ge","bindings","he","rootConstraints","tag","we","isMultiple","tree","RangeError","test","servicesBranch","me","ve","classMetadata","getClassMetadata","constructorParams","propertyParams","je","node","ye","Me","Ie","params","be","pop","singleMandatory","singleOptional","multipleMandatory","multipleOptional","Ce","v","clearCache","subscribe","Se","Ae","async","xe","context","Be","getActivations","$e","Re","ke","Pe","De","requestScopeCache","Ve","Fe","Oe","Ne","Ee","Ue","Ke","qe","Xe","all","ze","We","Ge","some","He","Je","Le","Ye","Ze","_e","getDeactivations","et","tt","nt","it","ot","at","static","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","getIdentifier","inRequestScope","inSingletonScope","inTransientScope","to","always","toSelf","toConstantValue","toDynamicValue","toResolvedValue","toFactory","toProvider","toService","when","whenAnyAncestor","whenAnyAncestorIs","whenAnyAncestorNamed","whenAnyAncestorTagged","whenDefault","whenNamed","whenNoParent","whenNoParentIs","whenNoParentNamed","whenNoParentTagged","whenParent","whenParentIs","whenParentNamed","whenParentTagged","whenTagged","whenNoAncestor","whenNoAncestorIs","whenNoAncestorNamed","whenNoAncestorTagged","G","q","invalidOperation","L","X","bind","autobind","defaultScope","getAll","getAllAsync","getAsync","isBound","isCurrentBound","load","loadSync","restore","activationService","bindingService","deactivationService","rebind","unbind","rebindSync","unbindSync","snapshot","unbindAll","unload","unloadSync","getBindingsFromModule","planResult","TYPES","AudioContextManager","AudioEditor","AudioProcessor","BufferManager","FilterManager","RendererManager","SaveBufferManager","ConfigService","EventEmitter","BufferPlayer","BufferDecoderService","BufferFetcherService","AudioBuffersToFetch","Renderers","Filters","EntryPointFilter","VoiceRecorder","AbstractAudioElement","bufferFetcherService","bufferDecoderService","configService","eventEmitter","injectDependencies","inject","injectable","EventType","utilFunctions","calcAudioDuration","audio","speed","duration","loadAudioBuffer","file","arrayBuffer","readAsArrayBufferPromisified","audioBuffer","decodeAudioData","decodeBuffer","reader","FileReader","onload","ev","ArrayBuffer","readAsArrayBuffer","numberOfChannels","resume","sampleRate","newBuffer","createBuffer","sourceChannelData","getChannelData","channel0Data","channel1Data","convertAudioBufferToFloat32Array","channel","convertAudioParamToFloat32Array","param","Float32Array","sumAudioBufferChannel","reduce","sumAudioBuffer","sum","isAudioWorkletCompatible","audioContext","isSettingValueValid","isNaN","trim","calculateAudioDuration","filterManager","speedAudio","getAddingTime","resetAudioRenderingProgress","emit","UPDATE_AUDIO_TREATMENT_PERCENT","UPDATE_REMAINING_TIME_ESTIMATED","forceDownload","blob","filename","link","window","document","createElement","url","URL","createObjectURL","body","appendChild","href","download","click","revokeObjectURL","removeChild","clearAudioBuffer","channelData","rendererManager","contextManager","saveBufferManager","audioProcessor","bufferManager","player","principalBuffer","fileList","fileListCurrIndex","loadingAudio","renderingAudio","bufferPlayer","setup","onBeforePlaying","compatibilityMode","currentContext","setupOutput","on","PLAYING_FINISHED","loop","start","PLAYING_FINISHED_LOOP_ALL","loopAll","loadNextAudio","addFilters","filters","addRenderers","renderers","currentSampleRate","defaultDeviceSampleRate","tempContext","AudioContext","close","loadBufferFromFile","clearBuffers","prepareContext","decodeBufferFromFile","initialRenderingDone","sumInputBuffer","utils","totalFileList","toggleLoop","loadFileList","loadBufferFromFileListIndex","item","LOADED_AUDIO_FILE_FROM_LIST","loadPreviousAudio","forceInitialRendering","currentIndex","currentIndexFileList","maxIndex","newIndex","renderAudio","getCurrentFileList","mapFiles","loadBuffer","getOutputBuffer","renderedBuffer","STARTED_RENDERING_AUDIO","AUDIO_RENDERING_FINISHED","AUDIO_RENDERING_EXCEPTION_THROWN","isAudioWorkletAvailable","getFiltersState","assign","getRenderersState","getFiltersSettings","reconnectNodesIfNeeded","entrypointFilter","connectNodes","getSpeed","enableFilter","filterId","enableRenderer","disableFilter","disableRenderer","toggleFilter","toggleRenderer","changeFilterSettings","settings","resetFilterSettings","resetAllFiltersState","resetAllRenderersState","exit","stop","reset","cancelAudioRendering","clearRenderedBuffer","event","callback","off","saveBuffer","options","downloadingInitialData","state","source","gainNode","intervals","onBeforePlayingCallback","_volume","currentTime","displayTime","playing","currentNode","_contextManager","init","direct","disconnect","createBufferSource","createGain","setGainNodeValue","connect","destination","updateInfos","setCompatibilityMode","clearIntervals","PLAYING_STOPPED","interval","clearInterval","PLAYING_STARTED","startTime","performance","now","setInterval","timeNow","nextTime","_b","_c","playDirect","pause","PLAYING_UPDATE","setTimePercent","percent","round","setTime","time","volume","gain","pow","toggleLoopAll","currentTimeDisplay","trunc","slice","maxTimeDisplay","remainingTimeDisplay","TimerSaveTime","seconds","incr","initialSeconds","countCallback","count","onCount","FilterNames","REVERB","ECHO","BASS_BOOST","BITCRUSHER","HIGH_PASS","LIMITER","LOW_PASS","PASSTHROUGH","RETURN_AUDIO","SOUNDTOUCH","TELEPHONIZER","VOCODER","Constants","AUDIO_EDITOR","VOICE_RECORDER","BUFFER_PLAYER","AUDIO_CONTEXT_MANAGER","AUDIO_PROCESSOR","BUFFER_MANAGER","FILTER_MANAGER","RENDERER_MANAGER","SAVE_BUFFER_MANAGER","EXPORT_WAV_COMMAND","EXPORT_MP3_COMMAND","AUDIO_WAV","AUDIO_MP3","RECORD_COMMAND","INIT_COMMAND","FILTERS_NAMES","WORKLET_PATHS","RECORDER_WORKLET","WORKLET_NAMES","PREFERENCES_KEYS","COMPATIBILITY_MODE_ENABLED","COMPATIBILITY_MODE_CHECKED","ENABLE_AUDIO_WORKLET","ENABLE_SOUNDTOUCH_AUDIO_WORKLET","BUFFER_SIZE","SAMPLE_RATE","DISABLE_INITIAL_RENDERING","BITRATE_MP3","ENABLE_RECORDER_AUDIO_WORKLET","SOUNDTOUCH_PITCH_SHIFTER_BUFFER_SIZE","DEFAULT_REVERB_ENVIRONMENT","addDuration","VOCODER_MODULATOR","DEFAULT_BUFFER_SIZE","VALID_BUFFER_SIZE","VALID_MP3_BITRATES","DEFAULT_SAMPLE_RATE","VALID_SAMPLE_RATES","TREATMENT_TIME_COUNTING_THROTTLE_INTERVAL","TREATMENT_TIME_COUNTING_SMOOTHING_FACTOR","DEFAULT_SAVE_FORMAT","DEFAULT_MP3_BITRATE","getRecorderWorker","workerBasePath","Worker","Recorder","cfg","worker","config","bufferLen","numChannels","mimeType","workletBasePath","bitrate","callbacks","getBuffer","exportWAV","exportMP3","recording","AudioWorkletNode","port","postMessage","createRecorderNode","command","onmessage","cb","createRecorderWorklet","console","createRecorderScriptProcessorNode","audioWorklet","addModule","numChannelParameter","parameters","setValueAtTime","onaudioprocess","inputBuffer","record","kill","terminate","Recorder$1","recorder","stream","alreadyInit","timer","enableAudioFeedback","deviceList","constraints","noiseSuppression","echoCancellation","autoGainControl","ideal","sampleRateConfigNotSupported","isRecordingAvailable","navigator","mediaDevices","getSupportedConstraints","createNewContext","createNewContextIfNeeded","RECORDER_INIT","getUserMedia","RECORDER_COUNT_UPDATE","successCallback","errorCallback","notFoundErrorCallback","unknownErrorCallback","ondevicechange","updateInputList","RECORDER_SUCCESS","RECORDER_ERROR","RECORDER_NOT_FOUND_ERROR","RECORDER_UNKNOWN_ERROR","audioFeedback","enable","RECORDER_UPDATE_CONSTRAINTS","getConstraints","tracks","getTracks","getSettings","updateConstraints","resetConstraints","newConstraint","precAudioFeedback","precRecording","applyConstraints","newConstraints","newConstraintName","stopStream","createMediaStreamSource","setNoiseSuppression","setAutoGain","setEchoCancellation","devices","enumerateDevices","device","changeInput","deviceId","groupId","getBufferSize","getSampleRate","getWorkletBasePath","getWorkerBasePath","RECORDER_RECORDING","RECORDER_STOPPED","RECORDER_PAUSED","RECORDER_RESETED","AbstractAudioNode","enabled","defaultEnabled","isEnabled","isDefaultEnabled","setDefaultEnabled","disable","setEnabled","toggle","AbstractAudioFilter","defaultSettings","_totalSamples","initializeDefaultSettings","getDefaultSettings","resetSettings","setSetting","isWorklet","bufferFetcherReseted","totalSamples","AudioParamPolyfill","defaultValue","_value","_minValue","_maxValue","_defaultValue","automationRate","newValue","max","min","minValue","maxValue","warn","linearRampToValueAtTime","endTime","exponentialRampToValueAtTime","cancelAndHoldAtTime","cancelTime","cancelScheduledValues","setTargetAtTime","timeConstant","setValueCurveAtTime","WorkletScriptProcessorNodeAdapter","bufferSize","_parameters","_port","workletProcessor","_scriptProcessorNode","createScriptProcessor","setupPort","setupProcessor","setupWorkletScope","messageChannel","MessageChannel","port1","port2","inputArray","Functions","ouputArray","outputBuffer","records","recordsMap","fromEntries","process","descriptors","defaultParameterDescriptors","RegisterProcessorPolyfill","registerProcessor","processorName","processorClass","processorsMap","getProcessor","processor","SimpleAudioWorkletProcessor","inputs","outputs","parameterDescriptors","AudioWorkletProcessor","AbstractAudioFilterWorklet","currentWorkletNode","fallbackToScriptProcessor","keepCurrentNodeIfPossible","initializeWorklet","workletPath","catch","isAudioWorkletEnabled","initializeNode","workletName","receiveEvent","applyCurrentSettingsToWorklet","currentSettings","settingKey","settingFromWorklet","getNode","output","AbstractAudioRenderer","listeners","GenericConfigService","mapConfig","soundBasePath","getConfig","setConfig","isCompatibilityModeEnabled","isCompatibilityModeChecked","setting","isSoundtouchAudioWorkletEnabled","parseInt","getBitrateMP3","enableCompatibilityMode","disableCompatibilityMode","getSoundBasePath","setWorkletBasePath","setWorkerBasePath","setSoundBasePath","isInitialRenderingDisabled","previousSampleRate","SAMPLE_RATE_CHANGED","_currentContext","destroyOldContext","latencyHint","oldAudioContext","_renderedBuffer","audioRenderingLastCanceled","resetBufferFetcher","loadInitialBuffer","durationAudio","offlineContext","OfflineAudioContext","outputContext","executeAudioRenderers","currentOfflineContext","setupTotalSamples","setupPlayerSpeed","initializeWorklets","currentNodes","startRendering","clearWorklets","loadRenderedAudio","OFFLINE_AUDIO_RENDERING_FINISHED","CANCELLED_AND_LOADED_INITIAL_AUDIO","setCompatibilityModeChecked","COMPATIBILITY_MODE_AUTO_ENABLED","RENDERING_AUDIO_PROBLEM_DETECTED","disconnectOldNodes","CANCELLING_AUDIO_PROCESSING","checked","audioBuffersToFetch","fetchBuffers","refetch","LOADING_BUFFERS","fetchAllBuffers","LOADED_BUFFERS","LOADING_BUFFERS_ERROR","resetFilterBuffers","entryPointFilter","_entryPointFilter","_currentNodes","find","element","keepCurrentInputOutput","isCompatibilityMode","entrypointNode","entrypointNodes","getEntrypointNode","intermediateNodes","previousNode","sort","order","updateState","keepCurrentOutput","intermediate","multiInject","renderer","rendererId","currentBuffer","_savingBuffer","playingStoppedCallback","savingResult","saveBufferCompatibilityMode","saveBufferDirect","downloadAudioBlob","format","rec","finishedCallback","downloadBlobCallback","Date","toISOString","savingBuffer","buffers","bufferErrors","fetchBuffer","bufferURI","force","realBufferURI","getKeyFromLocation","FETCHING_BUFFERS","response","fetch","ok","FETCHING_BUFFERS_ERROR","FINISHED_FETCHING_BUFFERS","_d","bufferURIs","uri","getAudioBuffer","getOrFetchAudioBuffer","getDownloadedBuffersList","from","location","substring","lastIndexOf","DECODING_AUDIO_FILE","DECODED_AUDIO_FILE","ERROR_DECODING_AUDIO_FILE","ReturnAudioRenderer","totalFrames","bufferReturned","nowBuffering","BassBoosterFilter","frequencyBooster","frequencyReduce","dbBooster","dbReduce","bassBoostFilter","createBiquadFilter","frequency","bassBoostFilterHighFreq","settingId","BitCrusherProcessor","stopped","phaser","bits","currentNormFreq","normFreq","fill","blockSize","inp","out","floor","BitCrusherFilter","parseFloat","EchoFilter","delay","delayNode","createDelay","delayTime","HighPassFilter","highFrequency","highPassFilter","DelayBuffer","_array","readPointer","writePointer","read","LimiterProcessor","delayBuffer","envelopeSample","disabled","getEnvelope","attackTime","releaseTime","attackGain","exp","releaseGain","envelope","envIn","abs","getMaxEnvelope","channels","ampToDB","log10","dBToAmp","db","envelopeData","postGainAmp","postGain","preGainAmp","preGain","lookAheadTime","slope","gainDB","threshold","LimiterFilter","LowPassFilter","lowFrequency","lowPassFilter","ReverbFilter","reverbEnvironment","reverbCustomEnvironmentAddTime","customEnvironment","convolver","createConvolver","getReverbBuffer","additionalData","downloadedBuffers","hasCustomEnvironment","reverbSettings","reverbUrl","FifoSampleBuffer","_vector","_position","_frameCount","vector","position","startIndex","frameCount","endIndex","receive","rewind","put","numFrames","putSamples","samples","sourceOffset","numSamples","ensureCapacity","destOffset","subarray","putBuffer","receiveSamples","extract","minLength","newVector","ensureAdditionalCapacity","AbstractFifoSamplePipe","createBuffers","_inputBuffer","_outputBuffer","RateTransposer","_rate","rate","slopeCount","prevSampleL","prevSampleR","numFramesOutput","transpose","src","srcOffset","dest","used","srcIndex","FilterSupport","pipe","_pipe","fillInputBuffer","fillOutputBuffer","numInputFrames","noop","SimpleFilter","sourceSound","historyBufferSize","_sourcePosition","outputBufferPosition","newOutputBufferPosition","sourcePosition","onEnd","numFramesExtracted","currentFrames","handleSampleData","_SCAN_OFFSETS","AUTOSEEK_K","Stretch","_quickSeek","midBufferDirty","midBuffer","overlapLength","autoSeqSetting","autoSeekSetting","_tempo","setParameters","clearMidBuffer","sequenceMs","seekWindowMs","overlapMs","calculateSequenceParameters","calculateOverlapLength","tempo","newTempo","intskip","nominalSkip","seekWindowLength","skipFract","sampleReq","seekLength","inputChunkSize","outputChunkSize","overlapInMsec","newOvl","refMidBuffer","checkLimits","mi","ma","seq","seek","AUTOSEQ_AT_MIN","AUTOSEEK_AT_MIN","quickSeek","seekBestOverlapPosition","seekBestOverlapPositionStereoQuick","seekBestOverlapPositionStereo","bestOffset","bestCorrelation","correlation","preCalculateCorrelationReferenceStereo","MIN_VALUE","calculateCrossCorrelationStereo","correlationOffset","tempOffset","scanCount","temp","mixingPosition","compare","mixing","calcLength","mixingOffset","overlap","overlapPosition","overlapStereo","inputPosition","outputPosition","tempFrame","frameScale","fi","inputOffset","outputOffset","overlapSkip","testFloatEqual","SoundTouch","transposer","stretch","_intermediateBuffer","virtualPitch","virtualRate","virtualTempo","calculateEffectiveRateAndTempo","rateChange","tempoChange","pitch","pitchOctaves","pitchSemitones","previousTempo","previousRate","WebAudioBufferSource","dualChannel","left","right","minsSecs","secs","mins","width","z","pad","onUpdate","currentTimePlayed","timePlayed","CustomEvent","detail","formattedTimePlayed","percentagePlayed","_node","dispatchEvent","PitchShifter","_soundtouch","_filter","sourcePositionCallback","framesExtracted","getWebAudioNode","sourcePostion","formattedDuration","perc","semitone","toNode","eventName","addEventListener","removeEventListener","soundtouchWrapperFilterWorkletNodeClass","running","_pitch","updateInterval","processorOptions","status","args","messageProcessor","SoundtouchWrapperFilterWorkletNode","SoundtouchWrapperFilter","frequencyAudio","currentSpeedAudio","isOfflineMode","constructAudioWorkletProcessor","offline","cleanUpOldNodes","bufferSource","renderWithWorklet","renderWithScriptProcessorNode","currentPitchShifter","getSoundtouchScriptProcessorNode","currentPitchShifterWorklet","bufferSourceRendered","bypass","nInputFrames","approximateNInputFrames","getCurrentPitchShifter","pitchShifter","valueFloat","TelephonizerFilter","lpf1","lpf2","hpf1","hpf2","Vocoder","ctx","carrierB","modulatorB","FILTER_QUALITY","FOURIER_SIZE","WAVETABLEBOOST","SAWTOOTHBOOST","oscillatorType","oscillatorDetuneValue","carrierBuffer","modulatorNode","vocoding","modulatorInput","carrierInput","modulatorGain","modulatorGainValue","noiseBuffer","noiseNode","noiseGain","noiseGainValue","carrierSampleNode","carrierSampleGain","carrierSampleGainValue","oscillatorNode","oscillatorGain","oscillatorGainValue","wavetable","wavetableSignalGain","modFilterBands","modFilterPostGains","heterodynes","powers","lpFilters","lpFilterPostGains","carrierBands","carrierFilterPostGains","carrierBandGains","vocoderBands","numVocoderBands","hpFilterGain","outputGain","modulatorBuffer","generateVocoderBands","setupVocoderGraph","vocode","getNodes","synthLevel","shutOffCarrier","selectSawtooth","selectWavetable","setPeriodicWave","updateModGain","updateSampleLevel","updateSynthLevel","updateNoiseLevel","updateDetuneValue","detune","startFreq","endFreq","numBands","centsPerBand","log","LN2","scale","currentFreq","loadNoiseBuffer","lengthInSamples","bufferData","initBandpassFilters","waveShaperCurve","n2","hpFilter","Q","rectifierCurve","modulatorFilter","secondModulatorFilter","modulatorFilterPostGain","heterodyneOscillator","createOscillator","heterodyne","heterodynePostGain","rectifier","createWaveShaper","curve","lpFilter","lpFilterPostGain","waveshaper","carrierFilter","secondCarrierFilter","carrierFilterPostGain","bandGain","real","imag","createPeriodicWave","createCarriersAndPlay","VocoderFilter","currentVocoder","applyCurrentSettingsToVocoder","PassthroughWorkletProcessor","samplesCount","sample","PassThroughFilter","lastSampleCount","samplePerSecond","currentTimeSamplesPerSecond","samplesProcessed","calculatePercentageProcessed","calculateRemainingTimeProcessing","timeDifference","percentageProcessed","timeDifferenceSamplePerSecond","remainingSamples","calculateSmoothedSamplePerSecond","remainingTimeSeconds","isFinite","SoundStudioFactory","createNewInstance","audioEditorContainer","Container","getAudioEditorContainer","buffersToFetch","audioEditor","audioPlayer","voiceRecorder","createAudioEditor","ready","instance","createVoiceRecorder","getAudioEditorInstance","getAudioPlayerInstance","getAudioRecorderInstance","getEventEmitterInstance","getConfigServiceInstance"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,48]}